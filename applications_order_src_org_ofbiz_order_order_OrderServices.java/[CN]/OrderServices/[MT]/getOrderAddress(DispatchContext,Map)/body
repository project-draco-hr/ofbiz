{
  Map result=new HashMap();
  Delegator delegator=dctx.getDelegator();
  String orderId=(String)context.get("orderId");
  String purpose[]={"BILLING_LOCATION","SHIPPING_LOCATION"};
  String outKey[]={"billingAddress","shippingAddress"};
  GenericValue orderHeader=null;
  try {
    orderHeader=delegator.findByPrimaryKey("OrderHeader",UtilMisc.toMap("orderId",orderId));
    if (orderHeader != null)     result.put("orderHeader",orderHeader);
  }
 catch (  GenericEntityException e) {
    result.put(ModelService.RESPONSE_MESSAGE,ModelService.RESPOND_ERROR);
    result.put(ModelService.ERROR_MESSAGE,"ERROR: Could not get OrderHeader (" + e.getMessage() + ").");
    return result;
  }
  if (orderHeader == null) {
    result.put(ModelService.RESPONSE_MESSAGE,ModelService.RESPOND_ERROR);
    result.put(ModelService.ERROR_MESSAGE,"ERROR: Could get the OrderHeader.");
    return result;
  }
  for (int i=0; i < purpose.length; i++) {
    try {
      GenericValue orderContactMech=EntityUtil.getFirst(orderHeader.getRelatedByAnd("OrderContactMech",UtilMisc.toMap("contactMechPurposeTypeId",purpose[i])));
      GenericValue contactMech=orderContactMech.getRelatedOne("ContactMech");
      if (contactMech != null) {
        result.put(outKey[i],contactMech.getRelatedOne("PostalAddress"));
      }
    }
 catch (    GenericEntityException e) {
      result.put(ModelService.RESPONSE_MESSAGE,ModelService.RESPOND_ERROR);
      result.put(ModelService.ERROR_MESSAGE,"ERROR: Problems getting contact mech (" + e.getMessage() + ").");
      return result;
    }
  }
  result.put("orderId",orderId);
  return result;
}
