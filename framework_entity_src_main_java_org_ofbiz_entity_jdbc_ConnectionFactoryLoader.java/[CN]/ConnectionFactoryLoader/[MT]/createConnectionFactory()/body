{
  ConnectionFactory instance=null;
  try {
    if (EntityConfig.getInstance().getConnectionFactory() == null) {
      return null;
    }
    String className=EntityConfig.getInstance().getConnectionFactory().getClassName();
    if (className == null) {
      throw new IllegalStateException("Could not find connection factory class name definition");
    }
    ClassLoader loader=Thread.currentThread().getContextClassLoader();
    Class<?> tfClass=loader.loadClass(className);
    instance=(ConnectionFactory)tfClass.newInstance();
  }
 catch (  ClassNotFoundException cnfe) {
    Debug.logError(cnfe,"Could not find connection factory class",module);
  }
catch (  Exception e) {
    Debug.logError(e,"Unable to instantiate the connection factory",module);
  }
  return instance;
}
