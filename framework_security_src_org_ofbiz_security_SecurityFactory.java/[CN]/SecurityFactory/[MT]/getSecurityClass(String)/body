{
  String className=null;
  if (Debug.verboseOn())   Debug.logVerbose("[SecurityFactory.getSecurityClass] Security implementation context name: " + securityName,module);
  if (rootElement == null) {
    try {
      SecurityConfigUtil.getXmlDocument();
      Element _rootElement=SecurityConfigUtil.getXmlRootElement();
      rootElement=_rootElement;
    }
 catch (    GenericConfigException e) {
      Debug.logError(e,"Error getting Security Config XML root element",module);
      return null;
    }
  }
  if (securityInfo == null) {
    SecurityConfigUtil.SecurityInfo _securityInfo=SecurityConfigUtil.getSecurityInfo(securityName);
    if (_securityInfo == null) {
      throw new SecurityConfigurationException("ERROR: no security definition was found with the name " + securityName + " in security.xml");
    }
    securityInfo=_securityInfo;
  }
  if (UtilValidate.isEmpty(securityInfo.className)) {
    className=DEFAULT_SECURITY;
  }
 else {
    className=securityInfo.className;
  }
  if (Debug.verboseOn())   Debug.logVerbose("[SecurityFactory.getSecurity] Security implementation " + className + " for security name "+ securityName+ " successfully loaded!!!",module);
  return className;
}
