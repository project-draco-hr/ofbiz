{
  Security security=null;
  if (securityName == null) {
    String _securityName=UtilProperties.getPropertyValue("security.properties","security.context");
    securityName=_securityName;
  }
  if (Debug.verboseOn())   Debug.logVerbose("[SecurityFactory.getInstance] Security implementation context name from security.properties: " + securityName,module);
synchronized (SecurityFactory.class) {
    try {
      ClassLoader loader=Thread.currentThread().getContextClassLoader();
      Class c=loader.loadClass(getSecurityClass(securityName));
      security=(Security)c.newInstance();
      security.setDelegator(delegator);
    }
 catch (    ClassNotFoundException cnf) {
      throw new SecurityConfigurationException("Cannot load security implementation class",cnf);
    }
catch (    InstantiationException ie) {
      throw new SecurityConfigurationException("Cannot get instance of the security implementation",ie);
    }
catch (    IllegalAccessException iae) {
      throw new SecurityConfigurationException(iae.getMessage(),iae);
    }
  }
  if (Debug.verboseOn())   Debug.logVerbose("[SecurityFactory.getInstance] Security implementation successfully loaded!!!",module);
  return security;
}
