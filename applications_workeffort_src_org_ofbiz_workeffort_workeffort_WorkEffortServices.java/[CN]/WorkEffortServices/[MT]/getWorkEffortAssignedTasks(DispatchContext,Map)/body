{
  GenericDelegator delegator=ctx.getDelegator();
  GenericValue userLogin=(GenericValue)context.get("userLogin");
  List validWorkEfforts=null;
  if (userLogin != null && userLogin.get("partyId") != null) {
    try {
      validWorkEfforts=EntityUtil.filterByDate(delegator.findByAnd("WorkEffortAndPartyAssign",UtilMisc.toList(new EntityExpr("partyId",EntityOperator.EQUALS,userLogin.get("partyId")),new EntityExpr("workEffortTypeId",EntityOperator.EQUALS,"TASK"),new EntityExpr("currentStatusId",EntityOperator.NOT_EQUAL,"CAL_DECLINED"),new EntityExpr("currentStatusId",EntityOperator.NOT_EQUAL,"CAL_DELEGATED"),new EntityExpr("currentStatusId",EntityOperator.NOT_EQUAL,"CAL_COMPLETED"),new EntityExpr("currentStatusId",EntityOperator.NOT_EQUAL,"CAL_CANCELLED")),UtilMisc.toList("priority")));
      validWorkEfforts.addAll(EntityUtil.filterByDate(delegator.findByAnd("WorkEffortAndPartyAssign",UtilMisc.toList(new EntityExpr("partyId",EntityOperator.EQUALS,userLogin.get("partyId")),new EntityExpr("workEffortTypeId",EntityOperator.EQUALS,"PROD_ORDER_TASK"),new EntityExpr("currentStatusId",EntityOperator.NOT_EQUAL,"PRUN_CANCELLED "),new EntityExpr("currentStatusId",EntityOperator.NOT_EQUAL,"PRUN_COMPLETED"),new EntityExpr("currentStatusId",EntityOperator.NOT_EQUAL,"PRUN_CLOSED")),UtilMisc.toList("createdDate DESC"))));
    }
 catch (    GenericEntityException e) {
      Debug.logWarning(e,module);
      return ServiceUtil.returnError("Error finding desired WorkEffort records: " + e.toString());
    }
  }
  Map result=new HashMap();
  if (validWorkEfforts == null)   validWorkEfforts=new LinkedList();
  result.put("tasks",validWorkEfforts);
  return result;
}
