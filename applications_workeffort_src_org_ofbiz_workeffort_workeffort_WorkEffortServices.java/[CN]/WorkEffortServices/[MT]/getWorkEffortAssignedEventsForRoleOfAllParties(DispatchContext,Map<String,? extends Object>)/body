{
  Delegator delegator=ctx.getDelegator();
  String roleTypeId=(String)context.get("roleTypeId");
  Locale locale=(Locale)context.get("locale");
  List<GenericValue> validWorkEfforts=null;
  try {
    List<EntityExpr> conditionList=FastList.newInstance();
    conditionList.add(EntityCondition.makeCondition("roleTypeId",EntityOperator.EQUALS,roleTypeId));
    conditionList.add(EntityCondition.makeCondition("workEffortTypeId",EntityOperator.EQUALS,"EVENT"));
    conditionList.add(EntityCondition.makeCondition("currentStatusId",EntityOperator.NOT_EQUAL,"CAL_DECLINED"));
    conditionList.add(EntityCondition.makeCondition("currentStatusId",EntityOperator.NOT_EQUAL,"CAL_DELEGATED"));
    conditionList.add(EntityCondition.makeCondition("currentStatusId",EntityOperator.NOT_EQUAL,"CAL_COMPLETED"));
    conditionList.add(EntityCondition.makeCondition("currentStatusId",EntityOperator.NOT_EQUAL,"CAL_CANCELLED"));
    EntityConditionList<EntityExpr> ecl=EntityCondition.makeCondition(conditionList,EntityOperator.AND);
    validWorkEfforts=EntityUtil.filterByDate(delegator.findList("WorkEffortAndPartyAssign",ecl,null,UtilMisc.toList("estimatedStartDate","priority"),null,false));
  }
 catch (  GenericEntityException e) {
    Debug.logWarning(e,module);
    return ServiceUtil.returnError(UtilProperties.getMessage(resourceError,"WorkEffortNotFound",UtilMisc.toMap("errorString",e.toString()),locale));
  }
  Map<String,Object> result=FastMap.newInstance();
  if (validWorkEfforts == null) {
    validWorkEfforts=FastList.newInstance();
  }
  result.put("events",validWorkEfforts);
  return result;
}
