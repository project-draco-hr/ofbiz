{
  String contactMechId=null;
  try {
    Map context=FastMap.newInstance();
    context.put("partyId",partyId);
    context.put("address1",(String)address.get("shippingAddressStreet1"));
    context.put("postalCode",(String)address.get("shippingAddressPostalCode"));
    context.put("userLogin",userLogin);
    context.put("contactMechPurposeTypeId",contactMechPurposeTypeId);
    String country=((String)address.get("shippingAddressCountry")).toUpperCase();
    String state=((String)address.get("shippingAddressStateOrProvince")).toUpperCase();
    String city=(String)address.get("shippingAddressCityName");
    correctCityStateCountry(dispatcher,context,city,state,country);
    Map summaryResult=dispatcher.runSync("createPartyPostalAddress",context);
    contactMechId=(String)summaryResult.get("contactMechId");
  }
 catch (  GenericServiceException e) {
    Debug.logError(e,"Failed to createAddress",module);
  }
  return contactMechId;
}
