{
  List paymentPreferences=null;
  try {
    Map paymentFields=UtilMisc.toMap("orderId",orderId,"statusId","PAYMENT_RECEIVED","paymentMethodTypeId","EXT_EBAY");
    paymentPreferences=delegator.findByAnd("OrderPaymentPreference",paymentFields);
    if (paymentPreferences != null && paymentPreferences.size() > 0) {
      Iterator i=paymentPreferences.iterator();
      while (i.hasNext()) {
        GenericValue pref=(GenericValue)i.next();
        boolean okay=createPayment(dispatcher,userLogin,pref,orderId,externalId,orderDate,partyIdFrom);
        if (!okay)         return false;
      }
    }
  }
 catch (  GenericEntityException e) {
    Debug.logError(e,"Cannot get payment preferences for order #" + orderId,module);
    return false;
  }
  return true;
}
