{
  Set<Date> finalSet=new TreeSet<Date>();
  Set<Date> rawSet=this.included.getRange(range,cal);
  Calendar checkCal=(Calendar)cal.clone();
  for (  Date date : rawSet) {
    checkCal.setTime(date);
    if (this.excluded.includesDate(checkCal)) {
      Calendar substCal=this.excluded.first(checkCal);
      if (substCal != null) {
        finalSet.add(substCal.getTime());
      }
    }
 else {
      finalSet.add(checkCal.getTime());
    }
  }
  return finalSet;
}
