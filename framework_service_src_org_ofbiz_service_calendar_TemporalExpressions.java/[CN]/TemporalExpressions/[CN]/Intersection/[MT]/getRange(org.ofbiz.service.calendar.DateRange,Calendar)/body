{
  Set<Date> finalSet=new TreeSet<Date>();
  Set<Date> rawSet=new TreeSet<Date>();
  Date last=range.start();
  Calendar next=first(cal);
  while (next != null && range.includesDate(next.getTime())) {
    last=next.getTime();
    rawSet.add(last);
    next=next(next);
    if (next != null && last.equals(next.getTime())) {
      break;
    }
  }
  Calendar checkCal=(Calendar)cal.clone();
  for (  Date date : rawSet) {
    checkCal.setTime(date);
    if (includesDate(checkCal)) {
      finalSet.add(date);
    }
  }
  return finalSet;
}
