{
  GenericValue subFlow=null;
  try {
    subFlow=getActivity().getDefinitionObject().getRelatedOne("WorkflowActivitySubFlow",false);
  }
 catch (  GenericEntityException e) {
    throw new WfException(e.getMessage(),e);
  }
  if (subFlow == null)   return;
  String type="WSE_SYNCHR";
  if (subFlow.get("executionEnumId") != null)   type=subFlow.getString("executionEnumId");
  ModelService service=new ModelService();
  service.name=service.toString();
  service.engineName="workflow";
  service.location=subFlow.getString("packageId");
  service.invoke=subFlow.getString("subFlowProcessId");
  service.validate=false;
  String actualParameters=subFlow.getString("actualParameters");
  GenericResultWaiter waiter=runService(service,actualParameters,null);
  if (type.equals("WSE_SYNCHR")) {
    Map<String,Object> subResult=waiter.waitForResult();
    this.setResult(subResult);
  }
  setComplete(true);
}
