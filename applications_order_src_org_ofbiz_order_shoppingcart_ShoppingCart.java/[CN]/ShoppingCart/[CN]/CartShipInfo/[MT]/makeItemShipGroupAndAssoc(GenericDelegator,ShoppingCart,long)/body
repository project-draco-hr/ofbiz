{
  String shipGroupSeqId=UtilFormatOut.formatPaddedNumber(groupIndex,5);
  List values=new LinkedList();
  if (this.internalContactMechId != null) {
    GenericValue orderCm=delegator.makeValue("OrderContactMech",null);
    orderCm.set("contactMechPurposeTypeId","SHIPPING_LOCATION");
    orderCm.set("contactMechId",this.internalContactMechId);
    values.add(orderCm);
  }
  GenericValue shipGroup=delegator.makeValue("OrderItemShipGroup",null);
  shipGroup.set("shipmentMethodTypeId",shipmentMethodTypeId);
  shipGroup.set("carrierRoleTypeId",carrierRoleTypeId);
  shipGroup.set("carrierPartyId",carrierPartyId);
  shipGroup.set("supplierPartyId",supplierPartyId);
  shipGroup.set("shippingInstructions",shippingInstructions);
  shipGroup.set("giftMessage",giftMessage);
  shipGroup.set("contactMechId",this.internalContactMechId);
  shipGroup.set("maySplit",maySplit);
  shipGroup.set("isGift",isGift);
  shipGroup.set("shipGroupSeqId",shipGroupSeqId);
  if ((shipBeforeDate == null) && (cart.getDefaultShipBeforeDate() != null)) {
    shipGroup.set("shipByDate",cart.getDefaultShipBeforeDate());
  }
 else {
    shipGroup.set("shipByDate",shipBeforeDate);
  }
  if ((shipAfterDate == null) && (cart.getDefaultShipAfterDate() != null)) {
    shipGroup.set("shipAfterDate",cart.getDefaultShipAfterDate());
  }
 else {
    shipGroup.set("shipAfterDate",shipAfterDate);
  }
  values.add(shipGroup);
  if (shipEstimate != 0) {
    GenericValue shipAdj=delegator.makeValue("OrderAdjustment",null);
    shipAdj.set("orderAdjustmentTypeId","SHIPPING_CHARGES");
    shipAdj.set("amount",new Double(shipEstimate));
    shipAdj.set("shipGroupSeqId",shipGroupSeqId);
    values.add(shipAdj);
  }
  Iterator ti=shipTaxAdj.iterator();
  while (ti.hasNext()) {
    GenericValue taxAdj=(GenericValue)ti.next();
    taxAdj.set("shipGroupSeqId",shipGroupSeqId);
    values.add(taxAdj);
  }
  Iterator i=shipItemInfo.keySet().iterator();
  while (i.hasNext()) {
    ShoppingCartItem item=(ShoppingCartItem)i.next();
    CartShipItemInfo itemInfo=(CartShipItemInfo)shipItemInfo.get(item);
    GenericValue assoc=delegator.makeValue("OrderItemShipGroupAssoc",null);
    assoc.set("orderItemSeqId",item.getOrderItemSeqId());
    assoc.set("shipGroupSeqId",shipGroupSeqId);
    assoc.set("quantity",new Double(itemInfo.quantity));
    values.add(assoc);
    Iterator iti=itemInfo.itemTaxAdj.iterator();
    while (iti.hasNext()) {
      GenericValue taxAdj=(GenericValue)iti.next();
      taxAdj.set("orderItemSeqId",item.getOrderItemSeqId());
      taxAdj.set("shipGroupSeqId",shipGroupSeqId);
      values.add(taxAdj);
    }
  }
  return values;
}
