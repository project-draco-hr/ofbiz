{
  BigDecimal itemsTotal=BigDecimal.ZERO;
  Iterator<ShoppingCartItem> i=iterator();
  while (i.hasNext()) {
    ShoppingCartItem cartItem=i.next();
    GenericValue product=cartItem.getProduct();
    if (product != null && "N".equals(product.getString("includeInPromotions"))) {
      continue;
    }
    itemsTotal=itemsTotal.add(cartItem.getItemSubTotal());
  }
  return itemsTotal;
}
