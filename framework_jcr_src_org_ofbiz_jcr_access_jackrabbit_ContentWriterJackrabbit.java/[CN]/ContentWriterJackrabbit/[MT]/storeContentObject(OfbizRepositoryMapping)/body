{
  if (orm == null) {
    return;
  }
  try {
    if (this.ocm.getSession().itemExists(orm.getPath())) {
      throw new ItemExistsException("There already exists an object stored at " + orm.getPath() + ". Please use update if you want to change it.");
    }
  }
 catch (  ItemExistsException e) {
    throw (e);
  }
catch (  RepositoryException e) {
    Debug.logError(e,module);
    return;
  }
  String path=orm.getPath();
  String[] nodeStructure=path.split("/");
  Node parentNode=null;
  try {
    parentNode=this.ocm.getSession().getRootNode();
  }
 catch (  RepositoryException e) {
    Debug.logError(e,"The new node could not be created: " + orm.getPath(),module);
    return;
  }
  for (int i=0; i < (nodeStructure.length - 1); i++) {
    String node=nodeStructure[i];
    if (UtilValidate.isEmail(node)) {
      continue;
    }
    try {
      if (parentNode.hasNode(node)) {
        parentNode=parentNode.getNode(node);
      }
 else {
        OfbizRepositoryMapping newNode=orm.getClass().newInstance();
        String parentNodePath=parentNode.getPath();
        if (!parentNodePath.endsWith("/")) {
          parentNodePath=parentNodePath + "/";
        }
        newNode.setPath(parentNodePath + node);
        versioningManager.checkOutContentObject(parentNode.getPath());
        ocm.insert(newNode);
        versioningManager.addContentToCheckInList(newNode.getPath());
        parentNode=parentNode.getNode(node);
      }
    }
 catch (    PathNotFoundException e) {
      Debug.logError(e,"The new node could not be created: " + orm.getPath(),module);
      return;
    }
catch (    RepositoryException e) {
      Debug.logError(e,"The new node could not be created: " + orm.getPath(),module);
      return;
    }
catch (    InstantiationException e) {
      Debug.logError(e,"The new node could not be created: " + orm.getPath(),module);
      return;
    }
catch (    IllegalAccessException e) {
      Debug.logError(e,"The new node could not be created: " + orm.getPath(),module);
      return;
    }
  }
  ocm.insert(orm);
  versioningManager.addContentToCheckInList(orm.getPath());
  this.saveState();
}
