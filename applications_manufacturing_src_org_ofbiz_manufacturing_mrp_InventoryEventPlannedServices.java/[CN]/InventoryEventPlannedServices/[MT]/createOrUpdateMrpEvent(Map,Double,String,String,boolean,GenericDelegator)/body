{
  GenericValue mrpEvent=null;
  mrpEvent=delegator.findByPrimaryKey("MrpEvent",mrpEventKeyMap);
  if (mrpEvent == null) {
    mrpEvent=delegator.makeValue("MrpEvent",mrpEventKeyMap);
    mrpEvent.put("quantity",newQuantity);
    mrpEvent.put("eventName",eventName);
    mrpEvent.put("facilityId",facilityId);
    mrpEvent.put("isLate",(isLate ? "Y" : "N"));
    mrpEvent.create();
  }
 else {
    double qties=newQuantity.doubleValue() + ((Double)mrpEvent.get("quantity")).doubleValue();
    mrpEvent.put("quantity",new Double(qties));
    if (!UtilValidate.isEmpty(eventName)) {
      String existingEventName=mrpEvent.getString("eventName");
      mrpEvent.put("eventName",(UtilValidate.isEmpty(existingEventName) ? eventName : existingEventName + ", " + eventName));
    }
    if (isLate) {
      mrpEvent.put("isLate","Y");
    }
    mrpEvent.store();
  }
}
