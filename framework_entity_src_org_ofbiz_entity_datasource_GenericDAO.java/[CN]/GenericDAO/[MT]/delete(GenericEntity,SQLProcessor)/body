{
  ModelEntity modelEntity=entity.getModelEntity();
  if (modelEntity == null) {
    throw new GenericModelException("Could not find ModelEntity record for entityName: " + entity.getEntityName());
  }
  if (modelEntity instanceof ModelViewEntity) {
    throw new org.ofbiz.entity.GenericNotImplementedException("Operation delete not supported yet for view entities");
  }
  String sql="DELETE FROM " + modelEntity.getTableName(datasourceInfo) + " WHERE "+ SqlJdbcUtil.makeWhereStringFromFields(modelEntity.getPksCopy(),entity,"AND");
  int retVal;
  try {
    sqlP.prepareStatement(sql);
    SqlJdbcUtil.setPkValues(sqlP,modelEntity,entity,modelFieldTypeReader);
    retVal=sqlP.executeUpdate();
    entity.removedFromDatasource();
  }
  finally {
    sqlP.close();
  }
  return retVal;
}
