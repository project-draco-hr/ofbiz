{
  String screenLocation="component://example/widget/example/ExampleReportScreens.xml";
  String reportScreenName="ExampleReport";
  Writer reportWriter=new StringWriter();
  ScreenRenderer reportScreenRenderer=new ScreenRenderer(reportWriter,null,htmlScreenRenderer);
  reportScreenRenderer.populateContextForService(dctx,context);
  try {
    reportScreenRenderer.render(screenLocation,reportScreenName);
  }
 catch (  GeneralException e) {
    String errMsg="General error rendering screen [" + screenLocation + "]: "+ e.toString();
    Debug.logError(e,errMsg,module);
    return ServiceUtil.returnError(errMsg);
  }
catch (  IOException e) {
    String errMsg="IO error rendering screen [" + screenLocation + "]: "+ e.toString();
    Debug.logError(e,errMsg,module);
    return ServiceUtil.returnError(errMsg);
  }
catch (  SAXException e) {
    String errMsg="SAX (XML parse) error rendering screen [" + screenLocation + "]: "+ e.toString();
    Debug.logError(e,errMsg,module);
    return ServiceUtil.returnError(errMsg);
  }
catch (  ParserConfigurationException e) {
    String errMsg="Parser configuration error rendering screen [" + screenLocation + "]: "+ e.toString();
    Debug.logError(e,errMsg,module);
    return ServiceUtil.returnError(errMsg);
  }
  String reportXmlDocument=reportWriter.toString();
  Logger logger=new Log4JLogger(Debug.getLogger(module));
  MessageHandler.setScreenLogger(logger);
  Driver driver=new Driver();
  driver.setRenderer(Driver.RENDER_PDF);
  driver.setLogger(logger);
  Document xslfo=null;
  try {
    xslfo=UtilXml.readXmlDocument(reportXmlDocument);
  }
 catch (  Throwable t) {
    String errMsg="Problems reading the parsed content to XML Document: " + t.toString();
    Debug.logError(t,errMsg,module);
    return ServiceUtil.returnError(errMsg);
  }
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  driver.setOutputStream(out);
  InputSource is=new DocumentInputSource(xslfo);
  driver.setInputSource(is);
  try {
    driver.run();
    FopImageFactory.resetCache();
  }
 catch (  Throwable t) {
    String errMsg="Unable to generate PDF from XSL-FO: " + t.toString();
    Debug.logError(t,errMsg,module);
    return ServiceUtil.returnError(errMsg);
  }
  DocFlavor docFlavor=DocFlavor.BYTE_ARRAY.PDF;
  Doc myDoc=new SimpleDoc(out.toByteArray(),docFlavor,null);
  PrintRequestAttributeSet aset=new HashPrintRequestAttributeSet();
  aset.add(new Copies(1));
  aset.add(Sides.ONE_SIDED);
  PrintService[] services=PrintServiceLookup.lookupPrintServices(docFlavor,aset);
  if (services.length > 0) {
    DocPrintJob job=services[0].createPrintJob();
    try {
      job.print(myDoc,aset);
    }
 catch (    PrintException pe) {
      String errMsg="Unable to print PDF from XSL-FO: " + pe.toString();
      Debug.logError(pe,errMsg,module);
      return ServiceUtil.returnError(errMsg);
    }
  }
  return ServiceUtil.returnSuccess();
}
