{
  Object nulledKey=fromKey(key);
  V oldValue;
  if (fileTable != null) {
    try {
synchronized (this) {
        oldValue=fileTable.get(nulledKey);
        if (oldValue == null) {
          memoryTable.put(nulledKey,createCacheLine(key,value,expireTimeNanos));
          fileTable.put(nulledKey,value);
          jdbmMgr.commit();
        }
      }
    }
 catch (    IOException e) {
      Debug.logError(e,module);
      oldValue=null;
    }
  }
 else {
    CacheLine<V> newCacheLine=createCacheLine(key,value,expireTimeNanos);
    CacheLine<V> oldCacheLine=memoryTable.putIfAbsent(nulledKey,newCacheLine);
    if (oldCacheLine == null) {
      oldValue=null;
    }
 else {
      oldValue=oldCacheLine.getValue();
      cancel(newCacheLine);
    }
  }
  if (oldValue == null) {
    noteAddition(key,value);
    return null;
  }
 else {
    return oldValue;
  }
}
