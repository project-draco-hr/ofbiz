{
  Set<Object> keys;
  if (fileTable != null) {
    keys=new HashSet<Object>();
    try {
synchronized (this) {
        addAllFileTableKeys(keys);
      }
    }
 catch (    IOException e) {
      Debug.logError(e,module);
    }
    if (keys.remove(ObjectType.NULL)) {
      keys.add(null);
    }
  }
 else {
    if (memoryTable.containsKey(ObjectType.NULL)) {
      keys=new HashSet<Object>(memoryTable.keySet());
      keys.remove(ObjectType.NULL);
      keys.add(null);
    }
 else {
      keys=memoryTable.keySet();
    }
  }
  return Collections.unmodifiableSet(UtilGenerics.<Set<? extends K>>cast(keys));
}
