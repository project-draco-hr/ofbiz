{
  long accessTime=System.currentTimeMillis();
  while (it.hasNext()) {
    Map.Entry<KE,VE> entry=it.next();
    K key=entry.getKey();
    V value=entry.getValue();
    CacheLine<V> oldCacheLine;
    CacheLine<V> newCacheLine;
    if (expireTime > 0) {
      newCacheLine=useSoftReference ? new SoftRefCacheLine<V>(value,accessTime,expireTime) : new HardRefCacheLine<V>(value,accessTime,expireTime);
    }
 else {
      newCacheLine=useSoftReference ? new SoftRefCacheLine<V>(value,expireTime) : new HardRefCacheLine<V>(value,expireTime);
    }
    oldCacheLine=cacheLineTable.put(key,newCacheLine);
    if (oldCacheLine == null) {
      noteAddition(key,value);
    }
 else {
      noteUpdate(key,value,oldCacheLine.getValue());
    }
  }
}
