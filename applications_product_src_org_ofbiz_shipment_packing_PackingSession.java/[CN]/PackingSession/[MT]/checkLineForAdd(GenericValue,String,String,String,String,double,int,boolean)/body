{
  String invItemId=res.getString("inventoryItemId");
  double resQty=res.getDouble("quantity").doubleValue();
  PackingSessionLine line=this.findLine(orderId,orderItemSeqId,shipGroupSeqId,productId,invItemId,packageSeqId);
  double packedQty=this.getPackedQuantity(orderId,orderItemSeqId,shipGroupSeqId,productId);
  Debug.log("Packed quantity [" + packedQty + "] + ["+ quantity+ "]",module);
  if (line == null) {
    Debug.log("No current line found testing [" + invItemId + "] R: "+ resQty+ " / Q: "+ quantity,module);
    if (resQty < quantity) {
      return 0;
    }
 else {
      return 2;
    }
  }
 else {
    double newQty=update ? quantity : (line.getQuantity() + quantity);
    Debug.log("Existing line found testing [" + invItemId + "] R: "+ resQty+ " / Q: "+ newQty,module);
    if (resQty < newQty) {
      return 0;
    }
 else {
      line.setQuantity(newQty);
      return 1;
    }
  }
}
