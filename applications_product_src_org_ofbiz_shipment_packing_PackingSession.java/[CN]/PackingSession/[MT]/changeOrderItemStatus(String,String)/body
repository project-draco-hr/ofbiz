{
  List<GenericValue> shipmentItems=this.getDelegator().findByAnd("ShipmentItem",UtilMisc.toMap("shipmentId",shipmentId));
  for (  GenericValue shipmentItem : shipmentItems) {
    for (    PackingSessionLine line : this.getLines()) {
      if (orderId.equals(line.getOrderId()) && shipmentItem.getString("productId").equals(line.getProductId())) {
        line.setShipmentItemSeqId(shipmentItem.getString("shipmentItemSeqId"));
      }
    }
  }
  List<GenericValue> orderItems=this.getDelegator().findByAnd("OrderItem",UtilMisc.toMap("orderId",orderId));
  for (  GenericValue orderItem : orderItems) {
    List orderItemShipGrpInvReserves=orderItem.getRelated("OrderItemShipGrpInvRes");
    if (UtilValidate.isEmpty(orderItemShipGrpInvReserves)) {
      Map<String,Object> orderItemStatusMap=FastMap.newInstance();
      orderItemStatusMap.put("orderId",orderId);
      orderItemStatusMap.put("orderItemSeqId",orderItem.getString("orderItemSeqId"));
      orderItemStatusMap.put("userLogin",userLogin);
      orderItemStatusMap.put("statusId","ITEM_COMPLETED");
      Map<String,Object> orderItemStatusResp=this.getDispatcher().runSync("changeOrderItemStatus",orderItemStatusMap);
      if (ServiceUtil.isError(orderItemStatusResp)) {
        throw new GeneralException(ServiceUtil.getErrorMessage(orderItemStatusResp));
      }
    }
  }
}
