{
  String invItemId=res.getString("inventoryItemId");
  BigDecimal resQty=res.getBigDecimal("quantity");
  PackingSessionLine line=this.findLine(orderId,orderItemSeqId,shipGroupSeqId,productId,invItemId,packageSeqId);
  BigDecimal packedQty=this.getPackedQuantity(orderId,orderItemSeqId,shipGroupSeqId,productId);
  Debug.log("Packed quantity [" + packedQty + "] + ["+ quantity+ "]",module);
  if (line == null) {
    Debug.log("No current line found testing [" + invItemId + "] R: "+ resQty+ " / Q: "+ quantity,module);
    if (resQty.compareTo(quantity) < 0) {
      return 0;
    }
 else {
      return 2;
    }
  }
 else {
    BigDecimal newQty=update ? quantity : (line.getQuantity().add(quantity));
    Debug.log("Existing line found testing [" + invItemId + "] R: "+ resQty+ " / Q: "+ newQty,module);
    if (resQty.compareTo(newQty) < 0) {
      return 0;
    }
 else {
      line.setQuantity(newQty);
      return 1;
    }
  }
}
