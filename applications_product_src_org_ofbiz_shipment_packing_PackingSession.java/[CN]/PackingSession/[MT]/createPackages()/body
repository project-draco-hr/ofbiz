{
  for (int i=0; i < packageSeq; i++) {
    PackingSessionLine line=this.getLine(i + 1);
    String shipmentPackageSeqId=UtilFormatOut.formatPaddedNumber(i + 1,5);
    Map<String,Object> pkgCtx=FastMap.newInstance();
    pkgCtx.put("shipmentId",shipmentId);
    pkgCtx.put("shipmentPackageSeqId",shipmentPackageSeqId);
    pkgCtx.put("boxLength",line.getLength());
    pkgCtx.put("boxWidth",line.getWidth());
    pkgCtx.put("boxHeight",line.getHeight());
    pkgCtx.put("dimensionUomId",getDimensionUomId());
    pkgCtx.put("shipmentBoxTypeId",line.getShipmentBoxTypeId());
    pkgCtx.put("weight",getPackageWeight(i + 1));
    pkgCtx.put("weightUomId",getWeightUomId());
    pkgCtx.put("userLogin",userLogin);
    Map<String,Object> newPkgResp=this.getDispatcher().runSync("createShipmentPackage",pkgCtx);
    if (ServiceUtil.isError(newPkgResp)) {
      throw new GeneralException(ServiceUtil.getErrorMessage(newPkgResp));
    }
  }
}
