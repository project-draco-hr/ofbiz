{
  GenericDelegator delegator=dctx.getDelegator();
  Security security=dctx.getSecurity();
  GenericValue userLogin=(GenericValue)context.get("userLogin");
  if (!security.hasPermission("ENTITY_MAINT",userLogin)) {
    return ServiceUtil.returnError("You do not have permission to run this service.");
  }
  String delimiter=(String)context.get("delimiter");
  if (delimiter == null) {
    delimiter="\t";
  }
  long startTime=System.currentTimeMillis();
  File file=(File)context.get("file");
  int records=0;
  try {
    records=readEntityFile(file,delimiter,delegator);
  }
 catch (  GeneralException e) {
    return ServiceUtil.returnError(e.getMessage());
  }
catch (  FileNotFoundException e) {
    return ServiceUtil.returnError("File not found : " + file.getName());
  }
catch (  IOException e) {
    Debug.logError(e,module);
    return ServiceUtil.returnError("Problem reading file : " + file.getName());
  }
  long endTime=System.currentTimeMillis();
  long runTime=endTime - startTime;
  Debug.logInfo("Imported/Updated [" + records + "] from : "+ file.getAbsolutePath()+ " ["+ runTime+ "ms]",module);
  Map result=ServiceUtil.returnSuccess();
  result.put("records",new Integer(records));
  return result;
}
