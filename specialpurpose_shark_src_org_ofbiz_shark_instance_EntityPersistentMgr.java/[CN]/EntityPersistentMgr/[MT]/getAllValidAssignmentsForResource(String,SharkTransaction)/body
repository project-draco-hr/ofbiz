{
  List allAssignments=getAllAssignmentsForResource(user,trans);
  List valid=new ArrayList();
  Iterator i=allAssignments.iterator();
  while (i.hasNext()) {
    Assignment as=(Assignment)i.next();
    Activity at=Activity.getInstance(this,as.getActivityId());
    if (!at.getState().startsWith("closed")) {
      if (at.getResourceUsername() == null || user.equals(at.getResourceUsername())) {
        valid.add(as);
      }
    }
  }
  return valid;
}
