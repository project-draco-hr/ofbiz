{
  Delegator delegator=SharkContainer.getDelegator();
  if (admin) {
    if (Debug.infoOn())     Debug.logInfo(":: deleteProcess ::",module);
    Process process=(Process)this.restoreProcess(processId,trans);
    List activities=this.getAllActivitiesForProcess(processId,trans);
    if (activities != null) {
      Iterator i=activities.iterator();
      while (i.hasNext()) {
        Activity activity=(Activity)i.next();
        try {
          this.deleteDeadlines(processId,activity.getId(),trans);
          activity.remove();
        }
 catch (        GenericEntityException e) {
          throw new PersistenceException(e);
        }
      }
    }
    try {
      delegator.removeByAnd(org.ofbiz.shark.SharkConstants.WfActivity,UtilMisc.toMap(org.ofbiz.shark.SharkConstants.subFlowId,processId));
      process.remove();
    }
 catch (    Exception e) {
      throw new PersistenceException(e);
    }
  }
}
