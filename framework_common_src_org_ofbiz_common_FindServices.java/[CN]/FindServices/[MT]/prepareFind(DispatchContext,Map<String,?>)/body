{
  String entityName=(String)context.get("entityName");
  String orderBy=(String)context.get("orderBy");
  Map<String,?> inputFields=checkMap(context.get("inputFields"),String.class,Object.class);
  String noConditionFind=(String)context.get("noConditionFind");
  if (UtilValidate.isEmpty(noConditionFind)) {
    noConditionFind=(String)inputFields.get("noConditionFind");
  }
  if (UtilValidate.isEmpty(noConditionFind)) {
    noConditionFind=UtilProperties.getPropertyValue("widget","widget.defaultNoConditionFind");
  }
  String filterByDate=(String)context.get("filterByDate");
  if (UtilValidate.isEmpty(filterByDate)) {
    filterByDate=(String)inputFields.get("filterByDate");
  }
  Timestamp filterByDateValue=(Timestamp)context.get("filterByDateValue");
  Map<String,Object> queryStringMap=FastMap.newInstance();
  Map<String,List<Object[]>> origValueMap=FastMap.newInstance();
  Map<String,Map<String,Map<String,Object>>> normalizedFields=prepareField(inputFields,queryStringMap,origValueMap);
  Delegator delegator=dctx.getDelegator();
  GenericValue entityValue=delegator.makeValue(entityName,FastMap.newInstance());
  ModelEntity modelEntity=entityValue.getModelEntity();
  List<EntityCondition> tmpList=createCondition(modelEntity,normalizedFields,queryStringMap,origValueMap,delegator,context);
  if ((tmpList.size() > 0) || ((noConditionFind != null) && (noConditionFind.equals("Y")))) {
    if (!UtilValidate.isEmpty(filterByDate) && "Y".equals(filterByDate)) {
      if (UtilValidate.isEmpty(filterByDateValue)) {
        EntityCondition filterByDateCondition=EntityUtil.getFilterByDateExpr();
        tmpList.add(filterByDateCondition);
      }
 else {
        EntityCondition filterByDateCondition=EntityUtil.getFilterByDateExpr(filterByDateValue);
        tmpList.add(filterByDateCondition);
      }
    }
  }
  EntityConditionList exprList=null;
  if (tmpList.size() > 0) {
    exprList=EntityCondition.makeCondition(tmpList);
  }
  List<String> orderByList=null;
  if (UtilValidate.isNotEmpty(orderBy)) {
    orderByList=StringUtil.split(orderBy,"|");
  }
  Map<String,Object> results=ServiceUtil.returnSuccess();
  Map<String,Object> reducedQueryStringMap=buildReducedQueryString(inputFields,entityName,delegator);
  reducedQueryStringMap.put("noConditionFind",noConditionFind);
  reducedQueryStringMap.put("filterByDate",filterByDate);
  reducedQueryStringMap.put("filterByDateValue",filterByDateValue);
  String queryString=UtilHttp.urlEncodeArgs(reducedQueryStringMap);
  results.put("queryString",queryString);
  results.put("queryStringMap",reducedQueryStringMap);
  results.put("orderByList",orderByList);
  results.put("entityConditionList",exprList);
  return results;
}
