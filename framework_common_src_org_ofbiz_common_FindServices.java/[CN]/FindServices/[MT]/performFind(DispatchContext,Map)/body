{
  String entityName=(String)context.get("entityName");
  String orderBy=(String)context.get("orderBy");
  Map inputFields=(Map)context.get("inputFields");
  String noConditionFind=(String)context.get("noConditionFind");
  if (UtilValidate.isEmpty(noConditionFind)) {
    noConditionFind=(String)inputFields.get("noConditionFind");
  }
  String filterByDate=(String)context.get("filterByDate");
  if (UtilValidate.isEmpty(filterByDate)) {
    filterByDate=(String)inputFields.get("filterByDate");
  }
  LocalDispatcher dispatcher=dctx.getDispatcher();
  Map prepareResult=null;
  try {
    prepareResult=dispatcher.runSync("prepareFind",UtilMisc.toMap("entityName",entityName,"orderBy",orderBy,"inputFields",inputFields,"filterByDate",filterByDate));
  }
 catch (  GenericServiceException gse) {
    return ServiceUtil.returnError("Error preparing conditions: " + gse.getMessage());
  }
  EntityConditionList exprList=(EntityConditionList)prepareResult.get("entityConditionList");
  List orderByList=(List)prepareResult.get("orderByList");
  Map executeResult=null;
  try {
    executeResult=dispatcher.runSync("executeFind",UtilMisc.toMap("entityName",entityName,"orderByList",orderByList,"entityConditionList",exprList,"noConditionFind",noConditionFind));
  }
 catch (  GenericServiceException gse) {
    return ServiceUtil.returnError("Error finding iterator: " + gse.getMessage());
  }
  if (executeResult.get("listIt") == null) {
    Debug.logInfo("No list iterator found for query string + [" + prepareResult.get("queryString") + "]",module);
  }
  Map results=ServiceUtil.returnSuccess();
  results.put("listIt",executeResult.get("listIt"));
  results.put("queryString",prepareResult.get("queryString"));
  results.put("queryStringMap",prepareResult.get("queryStringMap"));
  return results;
}
