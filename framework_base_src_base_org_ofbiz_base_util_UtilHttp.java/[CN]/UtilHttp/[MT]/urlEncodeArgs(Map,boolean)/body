{
  StringBuffer buf=new StringBuffer();
  if (args != null) {
    Iterator i=args.entrySet().iterator();
    while (i.hasNext()) {
      Map.Entry entry=(Map.Entry)i.next();
      String name=(String)entry.getKey();
      Object value=entry.getValue();
      String valueStr=null;
      if (name != null && value != null) {
        if (value instanceof String) {
          valueStr=(String)value;
        }
 else {
          valueStr=value.toString();
        }
        if (valueStr != null && valueStr.length() > 0) {
          if (buf.length() > 0) {
            if (useExpandedEntites) {
              buf.append("&amp;");
            }
 else {
              buf.append("&");
            }
          }
          try {
            buf.append(URLEncoder.encode(name,"UTF-8"));
          }
 catch (          UnsupportedEncodingException e) {
            Debug.logError(e,module);
          }
          buf.append('=');
          try {
            buf.append(URLEncoder.encode(valueStr,"UTF-8"));
          }
 catch (          UnsupportedEncodingException e) {
            Debug.logError(e,module);
          }
        }
      }
    }
  }
  return buf.toString();
}
