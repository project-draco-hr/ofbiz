{
  LocalDispatcher dispatcher=dctx.getDispatcher();
  GenericValue userLogin=(GenericValue)context.get("userLogin");
  Locale locale=(Locale)context.get("locale");
  List invoicesCreated=(List)context.get("invoicesCreated");
  String nextStatusId="INVOICE_READY";
  Iterator it=invoicesCreated.iterator();
  try {
    while (it.hasNext()) {
      String invoiceId=(String)it.next();
      Map setInvoiceStatusResult=dispatcher.runSync("setInvoiceStatus",UtilMisc.toMap("invoiceId",invoiceId,"statusId",nextStatusId,"userLogin",userLogin));
      if (ServiceUtil.isError(setInvoiceStatusResult)) {
        return ServiceUtil.returnError(UtilProperties.getMessage(resource,"AccountingInvoiceCommissionError",locale),null,null,setInvoiceStatusResult);
      }
    }
  }
 catch (  GenericServiceException e) {
    String errMsg=UtilProperties.getMessage(resource,"AccountingInvoiceCommissionEntityDataProblem",UtilMisc.toMap("reason",e.toString()),locale);
    Debug.logError(e,errMsg,module);
    return ServiceUtil.returnError(errMsg);
  }
  return ServiceUtil.returnSuccess();
}
