{
  Map results=FastMap.newInstance();
  GenericValue content=delegator.makeValue("Content",UtilMisc.toMap("contentId",siteId));
  if (Debug.infoOn())   Debug.logInfo("in indexTree, siteId:" + siteId + " content:"+ content,module);
  List siteList=ContentWorker.getAssociatedContent(content,"From",UtilMisc.toList("SUBSITE","PUBLISH_LINK"),null,UtilDateTime.nowTimestamp().toString(),null);
  if (siteList != null) {
    Iterator iter=siteList.iterator();
    while (iter.hasNext()) {
      GenericValue siteContent=(GenericValue)iter.next();
      String siteContentId=siteContent.getString("contentId");
      List subContentList=ContentWorker.getAssociatedContent(siteContent,"From",UtilMisc.toList("SUBSITE","PUBLISH_LINK","SUB_CONTENT"),null,UtilDateTime.nowTimestamp().toString(),null);
      if (subContentList != null) {
        List contentIdList=FastList.newInstance();
        Iterator iter2=subContentList.iterator();
        while (iter2.hasNext()) {
          GenericValue subContent=(GenericValue)iter2.next();
          contentIdList.add(subContent.getString("contentId"));
        }
        indexContentList(contentIdList,delegator,dispatcher,context);
        String subSiteId=siteContent.getString("contentId");
        indexTree(dispatcher,delegator,subSiteId,context,path);
      }
 else {
        List badIndexList=(List)context.get("badIndexList");
        badIndexList.add(siteContentId + " had no sub-entities.");
      }
    }
  }
 else {
    List badIndexList=(List)context.get("badIndexList");
    badIndexList.add(siteId + " had no sub-entities.");
  }
  results.put("badIndexList",context.get("badIndexList"));
  results.put("goodIndexCount",context.get("goodIndexCount"));
  return results;
}
