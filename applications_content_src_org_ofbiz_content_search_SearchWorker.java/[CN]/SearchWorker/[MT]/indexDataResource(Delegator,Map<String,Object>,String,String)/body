{
  Directory directory=FSDirectory.open(new File(getIndexPath(path)));
  long savedWriteLockTimeout=IndexWriterConfig.getDefaultWriteLockTimeout();
  Analyzer analyzer=new StandardAnalyzer(LUCENE_VERSION);
  IndexWriterConfig conf=new IndexWriterConfig(LUCENE_VERSION,analyzer);
  IndexWriter writer=null;
  try {
    IndexWriterConfig.setDefaultWriteLockTimeout(2000);
    writer=new IndexWriter(directory,conf);
  }
  finally {
    IndexWriterConfig.setDefaultWriteLockTimeout(savedWriteLockTimeout);
  }
  indexDataResource(delegator,context,id,writer);
  writer.forceMerge(1);
  writer.close();
}
