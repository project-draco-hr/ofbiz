{
  Map<String,Object> results=FastMap.newInstance();
  GenericValue content=delegator.makeValue("Content",UtilMisc.toMap("contentId",siteId));
  if (Debug.infoOn())   Debug.logInfo("in indexTree, siteId:" + siteId + " content:"+ content,module);
  List<GenericValue> siteList=ContentWorker.getAssociatedContent(content,"From",UtilMisc.toList("SUBSITE","PUBLISH_LINK"),null,UtilDateTime.nowTimestamp().toString(),null);
  if (siteList != null) {
    Iterator<GenericValue> iter=siteList.iterator();
    while (iter.hasNext()) {
      GenericValue siteContent=iter.next();
      String siteContentId=siteContent.getString("contentId");
      List<GenericValue> subContentList=ContentWorker.getAssociatedContent(siteContent,"From",UtilMisc.toList("SUBSITE","PUBLISH_LINK","SUB_CONTENT"),null,UtilDateTime.nowTimestamp().toString(),null);
      if (subContentList != null) {
        List<String> contentIdList=FastList.newInstance();
        Iterator<GenericValue> iter2=subContentList.iterator();
        while (iter2.hasNext()) {
          GenericValue subContent=iter2.next();
          contentIdList.add(subContent.getString("contentId"));
        }
        indexContentList(contentIdList,delegator,dispatcher,context);
        String subSiteId=siteContent.getString("contentId");
        indexTree(dispatcher,delegator,subSiteId,context,path);
      }
 else {
        List<String> badIndexList=UtilGenerics.checkList(context.get("badIndexList"));
        badIndexList.add(siteContentId + " had no sub-entities.");
      }
    }
  }
 else {
    List<String> badIndexList=UtilGenerics.checkList(context.get("badIndexList"));
    badIndexList.add(siteId + " had no sub-entities.");
  }
  results.put("badIndexList",context.get("badIndexList"));
  results.put("goodIndexCount",context.get("goodIndexCount"));
  return results;
}
