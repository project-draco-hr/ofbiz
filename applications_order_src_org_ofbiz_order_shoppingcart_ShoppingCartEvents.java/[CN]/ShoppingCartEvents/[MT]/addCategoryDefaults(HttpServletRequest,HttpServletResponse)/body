{
  String itemGroupNumber=request.getParameter("itemGroupNumber");
  String categoryId=request.getParameter("category_id");
  String catalogId=CatalogWorker.getCurrentCatalogId(request);
  ShoppingCart cart=getCartObject(request);
  GenericDelegator delegator=(GenericDelegator)request.getAttribute("delegator");
  LocalDispatcher dispatcher=(LocalDispatcher)request.getAttribute("dispatcher");
  ShoppingCartHelper cartHelper=new ShoppingCartHelper(delegator,dispatcher,cart);
  String controlDirective;
  Map result;
  Double totalQuantity;
  Locale locale=UtilHttp.getLocale(request);
  result=cartHelper.addCategoryDefaults(catalogId,categoryId,itemGroupNumber);
  controlDirective=processResult(result,request);
  if (controlDirective.equals(ERROR)) {
    return "error";
  }
 else {
    totalQuantity=(Double)result.get("totalQuantity");
    Map messageMap=UtilMisc.toMap("totalQuantity",UtilFormatOut.formatQuantity(totalQuantity));
    request.setAttribute("_EVENT_MESSAGE_",UtilProperties.getMessage(resource,"cart.add_category_defaults",messageMap,locale));
    return "success";
  }
}
