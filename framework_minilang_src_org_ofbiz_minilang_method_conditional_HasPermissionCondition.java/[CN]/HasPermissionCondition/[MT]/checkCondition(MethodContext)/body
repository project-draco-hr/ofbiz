{
  GenericValue userLogin=methodContext.getUserLogin();
  if (userLogin != null) {
    String permission=permissionFse.expandString(methodContext.getEnvMap());
    String action=actionFse.expandString(methodContext.getEnvMap());
    if (!action.isEmpty()) {
      Security security=methodContext.getSecurity();
      if (security.hasEntityPermission(permission,action,userLogin)) {
        return true;
      }
    }
 else {
      Authorization authz=methodContext.getAuthz();
      if (authz.hasPermission(userLogin.getString("userLoginId"),permission,methodContext.getEnvMap())) {
        return true;
      }
    }
  }
  return false;
}
