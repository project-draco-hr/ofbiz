{
  this(reader,entityElement,def);
  if (utilTimer != null)   utilTimer.timerString("  createModelEntity: before general/basic info");
  this.populateBasicInfo(entityElement);
  if (utilTimer != null)   utilTimer.timerString("  createModelEntity: before fields");
  NodeList fieldList=entityElement.getElementsByTagName("field");
  for (int i=0; i < fieldList.getLength(); i++) {
    ModelField field=reader.createModelField((Element)fieldList.item(i));
    if (field != null) {
      field.setModelEntity(this);
      this.fields.add(field);
    }
  }
  if ((this.doLock || !this.noAutoStamp) && !this.isField(STAMP_FIELD)) {
    ModelField newField=reader.createModelField(STAMP_FIELD,"date-time",null,false);
    newField.setIsAutoCreatedInternal(true);
    newField.setModelEntity(this);
    this.fields.add(newField);
  }
  if (!this.noAutoStamp && !this.isField(STAMP_TX_FIELD)) {
    ModelField newField=reader.createModelField(STAMP_TX_FIELD,"date-time",null,false);
    newField.setIsAutoCreatedInternal(true);
    newField.setModelEntity(this);
    this.fields.add(newField);
    String indexName=ModelUtil.shortenDbName(this.tableName + "_TXSTMP",18);
    ModelIndex txIndex=new ModelIndex(this,indexName,false);
    txIndex.addIndexField(ModelEntity.STAMP_TX_FIELD);
    txIndex.setModelEntity(this);
    indexes.add(txIndex);
  }
  if ((this.doLock || !this.noAutoStamp) && !this.isField(CREATE_STAMP_FIELD)) {
    ModelField newField=reader.createModelField(CREATE_STAMP_FIELD,"date-time",null,false);
    newField.setIsAutoCreatedInternal(true);
    newField.setModelEntity(this);
    this.fields.add(newField);
  }
  if (!this.noAutoStamp && !this.isField(CREATE_STAMP_TX_FIELD)) {
    ModelField newField=reader.createModelField(CREATE_STAMP_TX_FIELD,"date-time",null,false);
    newField.setIsAutoCreatedInternal(true);
    newField.setModelEntity(this);
    this.fields.add(newField);
    String indexName=ModelUtil.shortenDbName(this.tableName + "_TXCRTS",18);
    ModelIndex txIndex=new ModelIndex(this,indexName,false);
    txIndex.addIndexField(ModelEntity.CREATE_STAMP_TX_FIELD);
    txIndex.setModelEntity(this);
    indexes.add(txIndex);
  }
  if (utilTimer != null)   utilTimer.timerString("  createModelEntity: before prim-keys");
  NodeList pkList=entityElement.getElementsByTagName("prim-key");
  for (int i=0; i < pkList.getLength(); i++) {
    ModelField field=reader.findModelField(this,((Element)pkList.item(i)).getAttribute("field"));
    if (field != null) {
      this.pks.add(field);
      field.isPk=true;
    }
 else {
      Debug.logError("[ModelReader.createModelEntity] ERROR: Could not find field \"" + ((Element)pkList.item(i)).getAttribute("field") + "\" specified in a prim-key",module);
    }
  }
  this.nopks=FastList.newInstance();
  for (int ind=0; ind < this.fields.size(); ind++) {
    ModelField field=(ModelField)this.fields.get(ind);
    if (!field.isPk)     this.nopks.add(field);
  }
  if (utilTimer != null)   utilTimer.timerString("  createModelEntity: before relations");
  this.populateRelated(reader,entityElement);
  this.populateIndexes(entityElement);
}
