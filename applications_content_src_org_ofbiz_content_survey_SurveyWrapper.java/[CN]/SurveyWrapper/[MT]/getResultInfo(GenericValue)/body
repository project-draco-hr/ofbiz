{
  Map resultMap=FastMap.newInstance();
  String questionType=question.getString("surveyQuestionTypeId");
  resultMap.put("_q_type",questionType);
  if ("OPTION".equals(questionType)) {
    Map thisResult=getOptionResult(question);
    if (thisResult != null) {
      Long questionTotal=(Long)thisResult.remove("_total");
      if (questionTotal == null)       questionTotal=new Long(0);
      resultMap.put("_total",questionTotal);
      Iterator i=thisResult.keySet().iterator();
      while (i.hasNext()) {
        Map optMap=FastMap.newInstance();
        String optId=(String)i.next();
        Long optTotal=(Long)thisResult.get(optId);
        if (optTotal == null)         optTotal=new Long(0);
        Long percent=new Long((long)(((double)optTotal.longValue() / (double)questionTotal.longValue()) * 100));
        optMap.put("_total",optTotal);
        optMap.put("_percent",percent);
        resultMap.put(optId,optMap);
      }
      resultMap.put("_a_type","option");
    }
  }
 else   if ("BOOLEAN".equals(questionType)) {
    long[] thisResult=getBooleanResult(question);
    long yesPercent=thisResult[1] > 0 ? (long)(((double)thisResult[1] / (double)thisResult[0]) * 100) : 0;
    long noPercent=thisResult[2] > 0 ? (long)(((double)thisResult[2] / (double)thisResult[0]) * 100) : 0;
    resultMap.put("_total",new Long(thisResult[0]));
    resultMap.put("_yes_total",new Long(thisResult[1]));
    resultMap.put("_no_total",new Long(thisResult[2]));
    resultMap.put("_yes_percent",new Long(yesPercent));
    resultMap.put("_no_percent",new Long(noPercent));
    resultMap.put("_a_type","boolean");
  }
 else   if ("NUMBER_LONG".equals(questionType)) {
    double[] thisResult=getNumberResult(question,1);
    resultMap.put("_total",new Long((long)thisResult[0]));
    resultMap.put("_tally",new Long((long)thisResult[1]));
    resultMap.put("_average",new Long((long)thisResult[2]));
    resultMap.put("_a_type","long");
  }
 else   if ("NUMBER_CURRENCY".equals(questionType)) {
    double[] thisResult=getNumberResult(question,2);
    resultMap.put("_total",new Long((long)thisResult[0]));
    resultMap.put("_tally",new Double(thisResult[1]));
    resultMap.put("_average",new Double(thisResult[2]));
    resultMap.put("_a_type","double");
  }
 else   if ("NUMBER_FLOAT".equals(questionType)) {
    double[] thisResult=getNumberResult(question,3);
    resultMap.put("_total",new Long((long)thisResult[0]));
    resultMap.put("_tally",new Double(thisResult[1]));
    resultMap.put("_average",new Double(thisResult[2]));
    resultMap.put("_a_type","double");
  }
 else   if ("SEPERATOR_LINE".equals(questionType) || "SEPERATOR_TEXT".equals(questionType)) {
    return null;
  }
 else {
    resultMap.put("_total",new Long(getTextResult(question)));
    resultMap.put("_a_type","text");
  }
  return resultMap;
}
