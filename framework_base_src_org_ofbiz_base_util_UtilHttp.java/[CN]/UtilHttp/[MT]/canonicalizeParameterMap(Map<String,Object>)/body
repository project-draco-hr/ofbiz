{
  for (  Map.Entry<String,Object> paramEntry : paramMap.entrySet()) {
    if (paramEntry.getValue() instanceof String) {
      try {
        String cannedStr=ESAPI.encoder().canonicalize((String)paramEntry.getValue(),esapiCanonicalizeStrict);
        paramEntry.setValue(cannedStr);
      }
 catch (      EncodingException e) {
        Debug.logError(e,"Error in canonicalize parameter with name [" + paramEntry.getKey() + "], value ["+ paramEntry.getValue()+ "]: "+ e.toString(),module);
      }
    }
 else     if (paramEntry.getValue() instanceof Collection) {
      List<String> newList=FastList.newInstance();
      for (      String listEntry : ((Collection<String>)paramEntry.getValue())) {
        try {
          String cannedStr=ESAPI.encoder().canonicalize(listEntry,esapiCanonicalizeStrict);
          newList.add(cannedStr);
        }
 catch (        EncodingException e) {
          newList.add(listEntry);
          Debug.logError(e,"Error in canonicalize parameter with name [" + paramEntry.getKey() + "], value ["+ listEntry+ "]: "+ e.toString(),module);
        }
      }
      paramEntry.setValue(newList);
    }
  }
  return paramMap;
}
