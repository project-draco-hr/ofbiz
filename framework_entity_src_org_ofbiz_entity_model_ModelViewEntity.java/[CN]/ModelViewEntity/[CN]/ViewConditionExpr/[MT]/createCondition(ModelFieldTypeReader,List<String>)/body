{
  EntityOperator<?,?,?> operator=EntityOperator.lookup(this.operator);
  if (operator == null) {
    throw new IllegalArgumentException("Could not find an entity operator for the name: " + this.operator);
  }
  if ((operator.equals(EntityOperator.IN) || operator.equals(EntityOperator.BETWEEN)) && value instanceof String) {
    String delim=null;
    if (((String)value).indexOf("|") >= 0) {
      delim="|";
    }
 else     if (((String)value).indexOf(",") >= 0) {
      delim=",";
    }
    if (UtilValidate.isNotEmpty(delim)) {
      value=StringUtil.split((String)value,delim);
    }
  }
  if (this.viewEntityCondition.modelViewEntity.getField(fieldName) == null) {
    throw new IllegalArgumentException("Error in Entity Find: could not find field [" + fieldName + "] in entity with name ["+ this.viewEntityCondition.modelViewEntity.getEntityName()+ "]");
  }
  if (!((operator.equals(EntityOperator.IN) || operator.equals(EntityOperator.BETWEEN)) && value instanceof Collection)) {
    value=this.viewEntityCondition.modelViewEntity.convertFieldValue(this.viewEntityCondition.modelViewEntity.getField(fieldName),value,modelFieldTypeReader,FastMap.<String,Object>newInstance());
  }
  if (Debug.verboseOn())   Debug.logVerbose("Got value for fieldName [" + fieldName + "]: "+ value,module);
  EntityConditionValue lhs=EntityFieldValue.makeFieldValue(this.fieldName,this.entityAlias,entityAliasStack,this.viewEntityCondition.modelViewEntity);
  Object rhs=null;
  if (value != null) {
    rhs=value;
  }
 else {
    rhs=EntityFieldValue.makeFieldValue(this.relFieldName,this.relEntityAlias,entityAliasStack,this.viewEntityCondition.modelViewEntity);
  }
  if (operator.equals(EntityOperator.NOT_EQUAL) && value != null) {
    if (ignoreCase) {
      return EntityCondition.makeCondition(EntityCondition.makeCondition(EntityFunction.UPPER(lhs),UtilGenerics.<EntityComparisonOperator<?,?>>cast(operator),EntityFunction.UPPER(rhs)),EntityOperator.OR,EntityCondition.makeCondition(lhs,EntityOperator.EQUALS,null));
    }
 else {
      return EntityCondition.makeCondition(EntityCondition.makeCondition(lhs,UtilGenerics.<EntityComparisonOperator<?,?>>cast(operator),rhs),EntityOperator.OR,EntityCondition.makeCondition(lhs,EntityOperator.EQUALS,null));
    }
  }
 else   if (value == null && (operator.equals(EntityOperator.EQUALS) || operator.equals(EntityOperator.NOT_EQUAL))) {
    return EntityCondition.makeCondition(lhs,UtilGenerics.<EntityComparisonOperator<?,?>>cast(operator),null);
  }
 else {
    if (ignoreCase) {
      return EntityCondition.makeCondition(EntityFunction.UPPER(lhs),UtilGenerics.<EntityComparisonOperator<?,?>>cast(operator),EntityFunction.UPPER(rhs));
    }
 else {
      return EntityCondition.makeCondition(lhs,UtilGenerics.<EntityComparisonOperator<?,?>>cast(operator),rhs);
    }
  }
}
