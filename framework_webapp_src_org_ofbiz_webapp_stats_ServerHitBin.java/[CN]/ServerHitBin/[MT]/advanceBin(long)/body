{
  while (limitLength && toTime > this.endTime) {
    LinkedList binList=null;
switch (type) {
case REQUEST:
      binList=(LinkedList)requestHistory.get(id);
    break;
case EVENT:
  binList=(LinkedList)eventHistory.get(id);
break;
case VIEW:
binList=(LinkedList)viewHistory.get(id);
break;
case ENTITY:
binList=(LinkedList)entityHistory.get(id);
break;
case SERVICE:
binList=(LinkedList)serviceHistory.get(id);
break;
}
binList.removeFirst();
if (this.numberHits > 0) {
binList.addFirst(new ServerHitBin(this));
if (UtilProperties.propertyValueEqualsIgnoreCase("serverstats","stats.persist." + ServerHitBin.typeIds[type] + ".bin","true")) {
GenericValue serverHitBin=delegator.makeValue("ServerHitBin");
serverHitBin.set("contentId",this.id);
serverHitBin.set("hitTypeId",ServerHitBin.typeIds[this.type]);
serverHitBin.set("binStartDateTime",new java.sql.Timestamp(this.startTime));
serverHitBin.set("binEndDateTime",new java.sql.Timestamp(this.endTime));
serverHitBin.set("numberHits",new Long(this.numberHits));
serverHitBin.set("totalTimeMillis",new Long(this.totalRunningTime));
serverHitBin.set("minTimeMillis",new Long(this.minTime));
serverHitBin.set("maxTimeMillis",new Long(this.maxTime));
try {
InetAddress address=InetAddress.getLocalHost();
if (address != null) {
serverHitBin.set("serverIpAddress",address.getHostAddress());
serverHitBin.set("serverHostName",address.getHostName());
}
 else {
Debug.logError("Unable to get localhost internet address, was null",module);
}
}
 catch (java.net.UnknownHostException e) {
Debug.logError("Unable to get localhost internet address: " + e.toString(),module);
}
try {
delegator.createSetNextSeqId(serverHitBin);
}
 catch (GenericEntityException e) {
Debug.logError(e,"Could not save ServerHitBin:",module);
}
}
}
this.reset(this.endTime + 1);
binList.addFirst(this);
}
}
