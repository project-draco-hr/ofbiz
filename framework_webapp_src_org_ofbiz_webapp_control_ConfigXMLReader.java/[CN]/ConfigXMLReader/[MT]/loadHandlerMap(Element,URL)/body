{
  long startTime=System.currentTimeMillis();
  FastMap map=FastMap.newInstance();
  if (root == null) {
    root=loadDocument(xml);
  }
  if (root != null) {
    Map rMap=FastMap.newInstance();
    Map vMap=FastMap.newInstance();
    List handlerElementList=UtilXml.childElementList(root,HANDLER);
    Iterator handlerElementIter=handlerElementList.iterator();
    while (handlerElementIter.hasNext()) {
      Element handlerElement=(Element)handlerElementIter.next();
      String hName=checkEmpty(handlerElement.getAttribute(HANDLER_NAME));
      String hClass=checkEmpty(handlerElement.getAttribute(HANDLER_CLASS));
      String hType=checkEmpty(handlerElement.getAttribute(HANDLER_TYPE));
      if (hType.equals("view")) {
        vMap.put(hName,hClass);
      }
 else {
        rMap.put(hName,hClass);
      }
    }
    map.put("view",vMap);
    map.put("event",rMap);
  }
  if (Debug.verboseOn()) {
    Debug.logVerbose("-------- Handler Mappings --------",module);
    Map debugMap=(Map)map.get("event");
    if (debugMap != null && debugMap.size() > 0) {
      Debug.logVerbose("-------------- EVENT -------------",module);
      Set debugSet=debugMap.keySet();
      Iterator i=debugSet.iterator();
      while (i.hasNext()) {
        Object o=i.next();
        String handlerName=(String)o;
        String className=(String)debugMap.get(o);
        Debug.logVerbose("[EH] : " + handlerName + " => "+ className,module);
      }
    }
    debugMap=(Map)map.get("view");
    if (debugMap != null && debugMap.size() > 0) {
      Debug.logVerbose("-------------- VIEW --------------",module);
      Set debugSet=debugMap.keySet();
      Iterator i=debugSet.iterator();
      while (i.hasNext()) {
        Object o=i.next();
        String handlerName=(String)o;
        String className=(String)debugMap.get(o);
        Debug.logVerbose("[VH] : " + handlerName + " => "+ className,module);
      }
    }
    Debug.logVerbose("------ End Handler Mappings ------",module);
  }
  double totalSeconds=(System.currentTimeMillis() - startTime) / 1000.0;
  if (Debug.infoOn())   Debug.logInfo("HandlerMap Created: (" + map.size() + ") records in "+ totalSeconds+ "s",module);
  return map;
}
