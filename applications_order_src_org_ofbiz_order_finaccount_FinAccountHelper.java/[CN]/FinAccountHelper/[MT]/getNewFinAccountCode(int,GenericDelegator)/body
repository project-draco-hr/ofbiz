{
  Random r=new Random();
  boolean foundUniqueNewCode=false;
  StringBuffer newAccountCode=null;
  while (!foundUniqueNewCode) {
    newAccountCode=new StringBuffer(codeLength);
    for (int i=0; i < codeLength; i++) {
      newAccountCode.append(char_pool[r.nextInt(char_pool.length)]);
    }
    List existingAccountsWithCode=delegator.findByAnd("FinAccount",UtilMisc.toMap("finAccountCode",newAccountCode.toString()));
    if (existingAccountsWithCode.size() == 0) {
      foundUniqueNewCode=true;
    }
  }
  return newAccountCode.toString();
}
