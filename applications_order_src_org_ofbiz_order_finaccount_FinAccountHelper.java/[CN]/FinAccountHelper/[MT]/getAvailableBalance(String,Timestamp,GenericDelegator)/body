{
  if (asOfDateTime == null)   asOfDateTime=UtilDateTime.nowTimestamp();
  BigDecimal netBalance=getBalance(finAccountId,asOfDateTime,delegator);
  EntityConditionList authorizationConditions=new EntityConditionList(UtilMisc.toList(new EntityExpr("finAccountId",EntityOperator.EQUALS,finAccountId),new EntityExpr("authorizationDate",EntityOperator.LESS_THAN_EQUAL_TO,asOfDateTime),EntityUtil.getFilterByDateExpr(asOfDateTime)),EntityOperator.AND);
  List authSums=delegator.findList("FinAccountAuthSum",authorizationConditions,UtilMisc.toSet("amount"),null,null,false);
  BigDecimal authorizationsTotal=addFirstEntryAmount(ZERO,authSums,"amount",(decimals + 1),rounding);
  return netBalance.subtract(authorizationsTotal).setScale(decimals,rounding);
}
