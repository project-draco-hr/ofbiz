{
  if (session == null || !session.isLive()) {
    Credentials credentials=new SimpleCredentials(CREDENTIALS_USERNAME,CREDENTIALS_PASSWORD);
    try {
      session=repository.login(credentials);
      RepositoryUtil.setupSession(session);
      try {
        registerNodeTypes(session);
      }
 catch (      InvalidNodeTypeDefException e) {
        Debug.logError(e,module);
      }
catch (      IOException e) {
        Debug.logError(e,module);
      }
    }
 catch (    RepositoryException e) {
      Debug.logError(e,"Could not login to the workspace");
      throw e;
    }
  }
  return session;
}
