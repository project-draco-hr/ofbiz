{
  GenericDelegator delegator=billingAccount.getDelegator();
  String billingAccountId=billingAccount.getString("billingAccountId");
  BigDecimal balance=getBillingAccountNetBalance(delegator,billingAccountId);
  List orderHeaders=getBillingAccountOpenOrders(delegator,billingAccountId);
  if (orderHeaders != null) {
    Iterator ohi=orderHeaders.iterator();
    while (ohi.hasNext()) {
      GenericValue orderHeader=(GenericValue)ohi.next();
      OrderReadHelper orh=new OrderReadHelper(orderHeader);
      balance=balance.add(orh.getOrderGrandTotalBd());
    }
  }
  BigDecimal accountLimit=new BigDecimal(billingAccount.getDouble("accountLimit").doubleValue());
  if (balance.compareTo(accountLimit) == 1) {
    balance=accountLimit;
  }
 else {
    balance=balance.setScale(decimals,rounding);
  }
  return balance;
}
