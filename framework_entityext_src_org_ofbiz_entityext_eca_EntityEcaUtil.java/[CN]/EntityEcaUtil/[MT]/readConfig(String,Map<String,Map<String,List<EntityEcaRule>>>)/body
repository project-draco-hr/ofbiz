{
  EntityEcaReaderInfo entityEcaReaderInfo=EntityConfigUtil.getEntityEcaReaderInfo(entityEcaReaderName);
  if (entityEcaReaderInfo == null) {
    Debug.logError("BAD ERROR: Could not find entity-eca-reader config with name: " + entityEcaReaderName,module);
    return;
  }
  List<Future<List<EntityEcaRule>>> futures=FastList.newInstance();
  for (  Element eecaResourceElement : entityEcaReaderInfo.resourceElements) {
    ResourceHandler handler=new MainResourceHandler(EntityConfigUtil.ENTITY_ENGINE_XML_FILENAME,eecaResourceElement);
    futures.add(ExecutionPool.GLOBAL_EXECUTOR.submit(createEcaLoaderCallable(handler)));
  }
  for (  ComponentConfig.EntityResourceInfo componentResourceInfo : ComponentConfig.getAllEntityResourceInfos("eca")) {
    if (entityEcaReaderName.equals(componentResourceInfo.readerName)) {
      futures.add(ExecutionPool.GLOBAL_EXECUTOR.submit(createEcaLoaderCallable(componentResourceInfo.createResourceHandler())));
    }
  }
  for (  List<EntityEcaRule> oneFileRules : ExecutionPool.getAllFutures(futures)) {
    for (    EntityEcaRule rule : oneFileRules) {
      String entityName=rule.getEntityName();
      String eventName=rule.getEventName();
      Map<String,List<EntityEcaRule>> eventMap=ecaCache.get(entityName);
      List<EntityEcaRule> rules=null;
      if (eventMap == null) {
        eventMap=FastMap.newInstance();
        rules=FastList.newInstance();
        ecaCache.put(entityName,eventMap);
        eventMap.put(eventName,rules);
      }
 else {
        rules=eventMap.get(eventName);
        if (rules == null) {
          rules=FastList.newInstance();
          eventMap.put(eventName,rules);
        }
      }
      rules.add(rule);
    }
  }
}
