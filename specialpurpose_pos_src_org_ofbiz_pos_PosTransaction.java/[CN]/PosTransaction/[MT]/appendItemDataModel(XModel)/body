{
  if (cart != null) {
    Iterator i=cart.iterator();
    while (i.hasNext()) {
      ShoppingCartItem item=(ShoppingCartItem)i.next();
      double quantity=item.getQuantity();
      double unitPrice=item.getBasePrice();
      double subTotal=unitPrice * quantity;
      double adjustment=item.getOtherAdjustments();
      XModel line=Journal.appendNode(model,"tr","","");
      Journal.appendNode(line,"td","sku",item.getProductId());
      Journal.appendNode(line,"td","desc",item.getName());
      Journal.appendNode(line,"td","qty",UtilFormatOut.formatQuantity(quantity));
      Journal.appendNode(line,"td","price",UtilFormatOut.formatPrice(subTotal));
      Journal.appendNode(line,"td","index",Integer.toString(cart.getItemIndex(item)));
      if (this.isAggregatedItem(item.getProductId())) {
        ProductConfigWrapper pcw=null;
        pcw=item.getConfigWrapper();
        List selected=pcw.getSelectedOptions();
        Iterator iter=selected.iterator();
        while (iter.hasNext()) {
          ConfigOption configoption=(ConfigOption)iter.next();
          if (configoption.isSelected()) {
            XModel option=Journal.appendNode(model,"tr","","");
            Journal.appendNode(option,"td","sku","");
            Journal.appendNode(option,"td","desc",configoption.getDescription());
            Journal.appendNode(option,"td","qty","");
            Journal.appendNode(option,"td","price",UtilFormatOut.formatPrice(configoption.getPrice()));
            Journal.appendNode(option,"td","index",Integer.toString(cart.getItemIndex(item)));
          }
        }
      }
      if (adjustment != 0) {
        XModel promo=Journal.appendNode(model,"tr","","");
        Journal.appendNode(promo,"td","sku","");
        Journal.appendNode(promo,"td","desc",UtilProperties.getMessage("pos","(ItemDiscount)",defaultLocale));
        Journal.appendNode(promo,"td","qty","");
        Journal.appendNode(promo,"td","price",UtilFormatOut.formatPrice(adjustment));
      }
    }
  }
}
