{
  if (delegator == null) {
    throw new IllegalArgumentException("Null delegator is not allowed in this method");
  }
  GenericValue invoice=null;
  try {
    invoice=delegator.findOne("Invoice",UtilMisc.toMap("invoiceId",invoiceId),false);
  }
 catch (  GenericEntityException e) {
    Debug.logError(e,"Problem getting Invoice",module);
  }
  if (invoice == null) {
    throw new IllegalArgumentException("The invoiceId passed does not match an existing invoice");
  }
  return getInvoiceCurrencyConversionRate(invoice);
}
