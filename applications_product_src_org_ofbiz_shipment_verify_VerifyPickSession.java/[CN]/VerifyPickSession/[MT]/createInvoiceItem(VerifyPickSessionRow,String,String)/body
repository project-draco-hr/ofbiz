{
  Map createInvoiceItemContext=FastMap.newInstance();
  createInvoiceItemContext.put("invoiceId",invoiceId);
  createInvoiceItemContext.put("orderId",line.getOrderId());
  createInvoiceItemContext.put("invoiceItemTypeId","INV_FPROD_ITEM");
  createInvoiceItemContext.put("productId",line.getProductId());
  createInvoiceItemContext.put("quantity",line.getReadyToVerifyQty());
  createInvoiceItemContext.put("userLogin",this.getUserLogin());
  Map createInvoiceItemResult=this.getDispatcher().runSync("createInvoiceItem",createInvoiceItemContext);
  if (ServiceUtil.isError(createInvoiceItemResult)) {
    throw new GeneralException(ServiceUtil.getErrorMessage(createInvoiceItemResult));
  }
  String invoiceItemSeqId=(String)createInvoiceItemResult.get("invoiceItemSeqId");
  GenericValue shipmentItemBilling=this.getDelegator().makeValue("ShipmentItemBilling",UtilMisc.toMap("invoiceId",invoiceId,"invoiceItemSeqId",invoiceItemSeqId));
  shipmentItemBilling.put("shipmentId",shipmentId);
  shipmentItemBilling.put("shipmentItemSeqId",line.getShipmentItemSeqId());
  shipmentItemBilling.create();
  return invoiceItemSeqId;
}
