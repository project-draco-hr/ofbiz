{
  if (isOn(level)) {
    if (msg != null && params.length > 0) {
      StringBuilder sb=new StringBuilder();
      Formatter formatter=new Formatter(sb);
      formatter.format(msg,params);
      msg=sb.toString();
    }
    if (packException && t != null) {
      msg=System.getProperty("line.separator") + ExceptionHelper.packException(msg,t,true);
      t=null;
    }
    if (useLog4J) {
      Logger logger=getLogger(module);
      if (SYS_DEBUG != null) {
        logger.setLevel(Level.DEBUG);
      }
      logger.log(callingClass,levelObjs[level],msg,t);
    }
 else {
      StringBuilder prefixBuf=new StringBuilder();
      DateToString dateToString=new DateToString();
      try {
        prefixBuf.append(dateToString.convert(new java.util.Date(),Locale.getDefault(),TimeZone.getDefault(),UtilDateTime.DATE_TIME_FORMAT));
      }
 catch (      ConversionException e) {
        logFatal(e,Debug.class.getName());
      }
      prefixBuf.append(" [OFBiz");
      if (module != null) {
        prefixBuf.append(":");
        prefixBuf.append(module);
      }
      prefixBuf.append(":");
      prefixBuf.append(levels[level]);
      prefixBuf.append("] ");
      if (msg != null) {
        getPrintWriter().print(prefixBuf.toString());
        getPrintWriter().println(msg);
      }
      if (t != null) {
        getPrintWriter().print(prefixBuf.toString());
        getPrintWriter().println("Received throwable:");
        t.printStackTrace(getPrintWriter());
      }
    }
  }
}
