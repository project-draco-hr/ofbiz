{
  StringWriter writer=new StringWriter();
  JSONWriter jsonWriter;
  if (allowResolve) {
    jsonWriter=new JSONWriter(writer,JSONWriter.ResolvingFallbackHandler);
  }
 else {
    jsonWriter=new JSONWriter(writer);
  }
  assertTrue("writer is IndentingWriter",jsonWriter.getWriter() instanceof IndentingWriter);
  jsonWriter.write(object);
  return writer.toString();
}
