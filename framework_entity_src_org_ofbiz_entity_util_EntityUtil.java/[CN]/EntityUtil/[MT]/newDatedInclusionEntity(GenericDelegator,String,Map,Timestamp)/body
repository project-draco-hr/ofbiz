{
  List entities=findDatedInclusionEntity(delegator,entityName,search,now);
  if (entities != null && entities.size() > 0) {
    search=null;
    for (int i=0; i < entities.size(); i++) {
      GenericValue entity=(GenericValue)entities.get(i);
      if (now.equals(entity.get("fromDate"))) {
        search=FastMap.newInstance();
        search.putAll(entity.getPrimaryKey());
        entity.remove("thruDate");
      }
 else {
        entity.set("thruDate",now);
      }
      entity.store();
    }
    if (search == null) {
      search=FastMap.newInstance();
      search.putAll(EntityUtil.getFirst(entities));
    }
  }
 else {
  }
  if (now.equals(search.get("fromDate"))) {
    return EntityUtil.getOnly(delegator.findByAnd(entityName,search));
  }
 else {
    search.put("fromDate",now);
    search.remove("thruDate");
    return delegator.makeValue(entityName,search);
  }
}
