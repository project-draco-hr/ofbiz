{
  List returnItems=getOrderReturnItems();
  Map returnMap=FastMap.newInstance();
  for (Iterator iter=this.getValidOrderItems().iterator(); iter.hasNext(); ) {
    GenericValue orderItem=(GenericValue)iter.next();
    List group=EntityUtil.filterByAnd(returnItems,UtilMisc.toMap("orderId",orderItem.get("orderId"),"orderItemSeqId",orderItem.get("orderItemSeqId")));
    double returned=0;
    for (Iterator groupiter=group.iterator(); groupiter.hasNext(); ) {
      GenericValue returnItem=(GenericValue)groupiter.next();
      if (returnItem.getDouble("returnQuantity") != null) {
        returned+=(returnItem.getDouble("returnQuantity")).doubleValue();
      }
    }
    returnMap.put(orderItem.get("orderItemSeqId"),new Double(returned));
  }
  return returnMap;
}
