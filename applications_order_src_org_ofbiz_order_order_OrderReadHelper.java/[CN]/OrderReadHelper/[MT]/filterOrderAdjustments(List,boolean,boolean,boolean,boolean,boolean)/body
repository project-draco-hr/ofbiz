{
  List newOrderAdjustmentsList=FastList.newInstance();
  if (adjustments != null && adjustments.size() > 0) {
    Iterator adjIt=adjustments.iterator();
    while (adjIt.hasNext()) {
      GenericValue orderAdjustment=(GenericValue)adjIt.next();
      boolean includeAdjustment=false;
      if ("SALES_TAX".equals(orderAdjustment.getString("orderAdjustmentTypeId"))) {
        if (includeTax)         includeAdjustment=true;
      }
 else       if ("SHIPPING_CHARGES".equals(orderAdjustment.getString("orderAdjustmentTypeId"))) {
        if (includeShipping)         includeAdjustment=true;
      }
 else {
        if (includeOther)         includeAdjustment=true;
      }
      if (forTax && "N".equals(orderAdjustment.getString("includeInTax"))) {
        includeAdjustment=false;
      }
      if (forShipping && "N".equals(orderAdjustment.getString("includeInShipping"))) {
        includeAdjustment=false;
      }
      if (includeAdjustment) {
        newOrderAdjustmentsList.add(orderAdjustment);
      }
    }
  }
  return newOrderAdjustmentsList;
}
