{
  double quantity=0.0;
  List openOrdersExprs=UtilMisc.toList(new EntityExpr("orderTypeId",EntityOperator.EQUALS,"PURCHASE_ORDER"));
  openOrdersExprs.add(new EntityExpr("itemStatusId",EntityOperator.NOT_EQUAL,"ITEM_CANCELLED"));
  openOrdersExprs.add(new EntityExpr("itemStatusId",EntityOperator.NOT_EQUAL,"ITEM_REJECTED"));
  openOrdersExprs.add(new EntityExpr("itemStatusId",EntityOperator.NOT_EQUAL,"ITEM_COMPLETED"));
  openOrdersExprs.add(new EntityExpr("productId",EntityOperator.EQUALS,productId));
  EntityCondition openOrdersCond=new EntityConditionList(openOrdersExprs,EntityOperator.AND);
  List openOrders=null;
  try {
    openOrders=delegator.findByCondition("OrderHeaderAndItems",openOrdersCond,null,null);
  }
 catch (  GenericEntityException e) {
    Debug.logError(e,module);
  }
  if (openOrders != null && openOrders.size() > 0) {
    Iterator i=openOrders.iterator();
    while (i.hasNext()) {
      GenericValue order=(GenericValue)i.next();
      Double thisQty=order.getDouble("quantity");
      if (thisQty == null) {
        thisQty=new Double(0);
      }
      quantity+=thisQty.doubleValue();
    }
  }
  return quantity;
}
