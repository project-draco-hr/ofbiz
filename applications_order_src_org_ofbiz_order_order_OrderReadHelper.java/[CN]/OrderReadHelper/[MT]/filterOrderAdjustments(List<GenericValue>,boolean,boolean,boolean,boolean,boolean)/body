{
  List<GenericValue> newOrderAdjustmentsList=FastList.newInstance();
  if (UtilValidate.isNotEmpty(adjustments)) {
    Iterator<GenericValue> adjIt=adjustments.iterator();
    while (adjIt.hasNext()) {
      GenericValue orderAdjustment=adjIt.next();
      boolean includeAdjustment=false;
      if ("SALES_TAX".equals(orderAdjustment.getString("orderAdjustmentTypeId")) || "VAT_TAX".equals(orderAdjustment.getString("orderAdjustmentTypeId")) || "VAT_PRICE_CORRECT".equals(orderAdjustment.getString("orderAdjustmentTypeId"))) {
        if (includeTax)         includeAdjustment=true;
      }
 else       if ("SHIPPING_CHARGES".equals(orderAdjustment.getString("orderAdjustmentTypeId"))) {
        if (includeShipping)         includeAdjustment=true;
      }
 else {
        if (includeOther)         includeAdjustment=true;
      }
      if (forTax && "N".equals(orderAdjustment.getString("includeInTax"))) {
        includeAdjustment=false;
      }
      if (forShipping && "N".equals(orderAdjustment.getString("includeInShipping"))) {
        includeAdjustment=false;
      }
      if (includeAdjustment) {
        newOrderAdjustmentsList.add(orderAdjustment);
      }
    }
  }
  return newOrderAdjustmentsList;
}
