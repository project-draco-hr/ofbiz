{
  HttpSession session=request.getSession();
  GenericValue userLogin=(GenericValue)session.getAttribute("userLogin");
  if (userLogin != null && "anonymous".equals(userLogin.getString("userLoginId"))) {
    userLogin=null;
  }
  if (userLogin != null) {
    if (!hasBasePermission(userLogin,request) || isFlaggedLoggedOut(userLogin)) {
      Debug.logInfo("User does not have permission or is flagged as logged out",module);
      doBasicLogout(userLogin,request,response);
      userLogin=null;
    }
  }
  return userLogin;
}
