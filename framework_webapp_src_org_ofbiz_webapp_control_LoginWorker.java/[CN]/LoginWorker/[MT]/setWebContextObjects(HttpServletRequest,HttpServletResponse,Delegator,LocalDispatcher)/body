{
  HttpSession session=request.getSession();
  Security security=null;
  try {
    security=SecurityFactory.getInstance(delegator);
  }
 catch (  SecurityConfigurationException e) {
    Debug.logError(e,module);
  }
  Authorization authz=null;
  try {
    authz=AuthorizationFactory.getInstance(delegator);
  }
 catch (  SecurityConfigurationException e) {
    Debug.logError(e,module);
  }
  session.setAttribute("delegatorName",delegator.getDelegatorName());
  request.setAttribute("delegator",delegator);
  request.setAttribute("dispatcher",dispatcher);
  request.setAttribute("security",security);
  request.setAttribute("authz",authz);
  session.removeAttribute("visitor");
  session.removeAttribute("visit");
  VisitHandler.getVisitor(request,response);
  VisitHandler.getVisit(session);
}
