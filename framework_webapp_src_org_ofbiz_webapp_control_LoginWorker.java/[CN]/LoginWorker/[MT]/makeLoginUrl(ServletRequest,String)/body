{
  String queryString=null;
  Enumeration parameterNames=request.getParameterNames();
  while (parameterNames != null && parameterNames.hasMoreElements()) {
    String paramName=(String)parameterNames.nextElement();
    if (paramName != null) {
      String sane_paramName, sane_value;
      try {
        sane_paramName=URLEncoder.encode((String)paramName,"UTF-8");
        sane_value=URLEncoder.encode(request.getParameter(paramName),"UTF-8");
      }
 catch (      UnsupportedEncodingException ex) {
        Debug.logError(ex,module);
        sane_paramName=paramName;
        sane_value=request.getParameter(paramName);
      }
      if (queryString == null) {
        queryString=sane_paramName + "=" + sane_value;
      }
 else {
        queryString=queryString + "&" + sane_paramName+ "="+ sane_value;
      }
    }
  }
  String loginUrl="/" + requestName + "/"+ UtilFormatOut.checkNull((String)request.getAttribute("_CURRENT_VIEW_"));
  if (queryString != null)   loginUrl=loginUrl + "?" + UtilFormatOut.checkNull(queryString);
  return loginUrl;
}
