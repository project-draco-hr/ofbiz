{
  Map<String,Object> attrMap=UtilHttp.getJSONAttributeMap(request);
  JSONObject json=JSONObject.fromObject(attrMap);
  String jsonStr=json.toString();
  if (jsonStr == null) {
    Debug.logError("JSON Object was empty; fatal error!",module);
    return "success";
  }
  response.setContentType("application/x-json");
  try {
    response.setContentLength(jsonStr.getBytes("UTF8").length);
  }
 catch (  UnsupportedEncodingException e) {
    Debug.logError("Problems with Json encoding: " + e,module);
  }
  Writer out;
  try {
    out=response.getWriter();
    out.write(jsonStr);
    out.flush();
  }
 catch (  IOException e) {
    Debug.logError(e,module);
  }
  return "success";
}
