{
  List certs=FastList.newInstance();
  Iterator i=keystores.iterator();
  while (i.hasNext()) {
    KeyStore k=(KeyStore)i.next();
    try {
      Enumeration e=k.aliases();
      while (e.hasMoreElements()) {
        String alias=(String)e.nextElement();
        Certificate[] cert=k.getCertificateChain(alias);
        if (cert != null) {
          for (int x=0; x < cert.length; x++) {
            if (cert[x] instanceof X509Certificate) {
              if (Debug.verboseOn())               Debug.log("Read certificate (chain) : " + ((X509Certificate)cert[x]).getSubjectX500Principal().getName(),module);
              certs.add(cert[x]);
            }
          }
        }
 else {
          Certificate c=k.getCertificate(alias);
          if (c != null && c instanceof X509Certificate) {
            if (Debug.verboseOn())             Debug.log("Read certificate : " + ((X509Certificate)c).getSubjectX500Principal().getName(),module);
            certs.add(c);
          }
        }
      }
    }
 catch (    KeyStoreException e) {
      Debug.logError(e,module);
    }
  }
  return (X509Certificate[])certs.toArray(new X509Certificate[certs.size()]);
}
