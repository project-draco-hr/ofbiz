{
  String editMode="Edit";
  String editRequest=content.getEditRequest(context);
  String editContainerStyle=content.getEditContainerStyle(context);
  String enableEditName=content.getEnableEditName(context);
  String enableEditValue=(String)context.get(enableEditName);
  String expandedContentId=content.getContentId(context);
  String expandedMapKey=content.getMapKey(context);
  String urlString="";
  if (editRequest != null && editRequest.toUpperCase().indexOf("IMAGE") > 0) {
    editMode+=" Image";
  }
  if (UtilValidate.isNotEmpty(editRequest) && "true".equals(enableEditValue)) {
    HttpServletResponse response=(HttpServletResponse)context.get("response");
    HttpServletRequest request=(HttpServletRequest)context.get("request");
    if (request != null && response != null) {
      if (editRequest.indexOf("?") < 0)       editRequest+="?";
 else       editRequest+="&amp;";
      editRequest+="contentId=" + expandedContentId;
      if (UtilValidate.isNotEmpty(expandedMapKey)) {
        editRequest+="&amp;mapKey=" + expandedMapKey;
      }
      ServletContext ctx=(ServletContext)request.getAttribute("servletContext");
      RequestHandler rh=(RequestHandler)ctx.getAttribute("_REQUEST_HANDLER_");
      urlString=rh.makeLink(request,response,editRequest,false,false,false);
    }
  }
  StringWriter sr=new StringWriter();
  sr.append("<@renderSubContentEnd ");
  sr.append("urlString=\"");
  sr.append(urlString);
  sr.append("\" editMode=\"");
  sr.append(editMode);
  sr.append("\" editContainerStyle=\"");
  sr.append(editContainerStyle);
  sr.append("\" editRequest=\"");
  sr.append(editRequest);
  sr.append("\" enableEditValue=\"");
  sr.append(enableEditValue);
  sr.append("\" />");
  executeMacro(sr.toString());
}
