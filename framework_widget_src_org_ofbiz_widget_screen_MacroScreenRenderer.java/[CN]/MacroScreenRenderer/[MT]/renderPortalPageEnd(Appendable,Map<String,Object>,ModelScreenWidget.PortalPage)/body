{
  String editMode=portalPage.getEditMode(context);
  HttpServletRequest request=(HttpServletRequest)context.get("request");
  String actualRequest=request.getRequestURL().toString();
  if (actualRequest.indexOf("?") < 0) {
    actualRequest+="?";
  }
 else   if (!actualRequest.endsWith("?")) {
    actualRequest+="&amp;";
  }
  String editOnURL=actualRequest + "editmode=true";
  String editOffURL=actualRequest + "editmode=false";
  StringWriter sr=new StringWriter();
  sr.append("<@renderPortalPageEnd ");
  sr.append("editMode=\"");
  sr.append(editMode);
  sr.append("\" editOnURL=\"");
  sr.append(editOnURL);
  sr.append("\" editOffURL=\"");
  sr.append(editOffURL);
  sr.append("\" />");
  executeMacro(writer,sr.toString());
}
