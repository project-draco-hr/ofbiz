{
  Map<String,Object> results=FastMap.newInstance();
  GenericValue content=delegator.makeValue("Content",UtilMisc.toMap("contentId",siteId));
  if (Debug.infoOn())   Debug.logInfo("in indexTree, siteId:" + siteId + " content:"+ content,module);
  List<GenericValue> siteList=ContentWorker.getAssociatedContent(content,"To",UtilMisc.toList("SUBSITE","PUBLISH_LINK","SUB_CONTENT"),null,UtilDateTime.nowTimestamp().toString(),null);
  if (siteList != null) {
    for (    GenericValue siteContent : siteList) {
      String siteContentId=siteContent.getString("contentId");
      List<GenericValue> subContentList=ContentWorker.getAssociatedContent(siteContent,"To",UtilMisc.toList("SUBSITE","PUBLISH_LINK","SUB_CONTENT"),null,UtilDateTime.nowTimestamp().toString(),null);
      if (subContentList != null) {
        List<String> contentIdList=FastList.newInstance();
        for (        GenericValue subContent : subContentList) {
          contentIdList.add(subContent.getString("contentId"));
        }
        indexContentList(dispatcher,delegator,context,contentIdList,null);
        indexTree(dispatcher,delegator,siteContentId,context,path);
      }
 else {
        List<String> badIndexList=UtilGenerics.checkList(context.get("badIndexList"));
        badIndexList.add(siteContentId + " had no sub-entities.");
      }
    }
  }
 else {
    List<String> badIndexList=UtilGenerics.checkList(context.get("badIndexList"));
    badIndexList.add(siteId + " had no sub-entities.");
  }
  results.put("badIndexList",context.get("badIndexList"));
  results.put("goodIndexCount",context.get("goodIndexCount"));
  return results;
}
