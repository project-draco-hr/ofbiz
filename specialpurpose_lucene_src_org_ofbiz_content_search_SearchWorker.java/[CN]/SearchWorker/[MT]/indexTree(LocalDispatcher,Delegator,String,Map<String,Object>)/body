{
  GenericValue content=delegator.makeValue("Content",UtilMisc.toMap("contentId",siteId));
  if (Debug.infoOn())   Debug.logInfo("in indexTree, siteId:" + siteId + " content:"+ content,module);
  List<GenericValue> siteList=ContentWorker.getAssociatedContent(content,"To",UtilMisc.toList("SUBSITE","PUBLISH_LINK","SUB_CONTENT"),null,UtilDateTime.nowTimestamp().toString(),null);
  if (siteList != null) {
    for (    GenericValue siteContent : siteList) {
      String siteContentId=siteContent.getString("contentId");
      List<GenericValue> subContentList=ContentWorker.getAssociatedContent(siteContent,"To",UtilMisc.toList("SUBSITE","PUBLISH_LINK","SUB_CONTENT"),null,UtilDateTime.nowTimestamp().toString(),null);
      if (subContentList != null) {
        List<String> contentIdList=new ArrayList<String>();
        for (        GenericValue subContent : subContentList) {
          contentIdList.add(subContent.getString("contentId"));
        }
        indexContentList(dispatcher,delegator,context,contentIdList);
        indexTree(dispatcher,delegator,siteContentId,context);
      }
 else {
        List<String> badIndexList=UtilGenerics.checkList(context.get("badIndexList"));
        badIndexList.add(siteContentId + " had no sub-entities.");
      }
    }
  }
 else {
    List<String> badIndexList=UtilGenerics.checkList(context.get("badIndexList"));
    badIndexList.add(siteId + " had no sub-entities.");
  }
  return UtilMisc.toMap("badIndexList",context.get("badIndexList"),"goodIndexCount",context.get("goodIndexCount"));
}
