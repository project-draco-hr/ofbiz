{
  String entityName=null;
  EntityCondition condition=null;
  if (userLogin == null)   return false;
  if (primaryKey.equals("") && roles == null) {
    if (hasEntityPermission(application,action,userLogin))     return true;
    if (hasEntityPermission(application + "_ROLE",action,userLogin))     return true;
  }
  Map<String,String> simpleRoleMap=OFBizSecurity.simpleRoleEntity.get(application);
  if (simpleRoleMap != null && roles != null) {
    entityName=(String)simpleRoleMap.get("name");
    String pkey=(String)simpleRoleMap.get("pkey");
    if (pkey != null) {
      List<EntityExpr> expressions=new ArrayList<EntityExpr>();
      for (      String role : roles) {
        expressions.add(new EntityExpr("roleTypeId",EntityOperator.EQUALS,role));
      }
      EntityConditionList<EntityExpr> exprList=new EntityConditionList<EntityExpr>(expressions,EntityOperator.OR);
      EntityExpr keyExpr=new EntityExpr(pkey,EntityOperator.EQUALS,primaryKey);
      EntityExpr partyExpr=new EntityExpr("partyId",EntityOperator.EQUALS,userLogin.getString("partyId"));
      List<EntityCondition> joinList=UtilMisc.toList(exprList,keyExpr,partyExpr);
      condition=new EntityConditionList<EntityCondition>(joinList,EntityOperator.AND);
    }
  }
  return hasRolePermission(application,action,entityName,condition,userLogin);
}
