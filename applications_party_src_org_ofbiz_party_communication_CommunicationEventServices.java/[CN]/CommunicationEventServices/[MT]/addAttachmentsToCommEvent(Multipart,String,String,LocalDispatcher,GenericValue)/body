{
  Map<String,Object> commEventMap=FastMap.newInstance();
  commEventMap.put("communicationEventId",communicationEventId);
  commEventMap.put("contentTypeId","DOCUMENT");
  commEventMap.put("mimeTypeId","text/html");
  commEventMap.put("userLogin",userLogin);
  if (subject != null && subject.length() > 80) {
    subject=subject.substring(0,80);
  }
  currentIndex="";
  attachmentCount=0;
  return addMultipartAttachementToComm(messageContent,commEventMap,subject,dispatcher,userLogin);
}
