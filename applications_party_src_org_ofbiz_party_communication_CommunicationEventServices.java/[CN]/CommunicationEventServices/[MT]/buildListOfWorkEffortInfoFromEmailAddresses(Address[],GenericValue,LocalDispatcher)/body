{
  InternetAddress emailAddress=null;
  Map<String,Object> result=null;
  List<Map<String,Object>> tempResults=FastList.newInstance();
  String caseInsensitiveEmail=org.ofbiz.base.util.UtilProperties.getPropertyValue("general.properties","mail.address.caseInsensitive","N");
  if (addresses != null) {
    for (    Address addr : addresses) {
      if (addr instanceof InternetAddress) {
        emailAddress=(InternetAddress)addr;
        if (!UtilValidate.isEmpty(emailAddress)) {
          Map<String,String> inputFields=FastMap.newInstance();
          inputFields.put("infoString",emailAddress.getAddress());
          inputFields.put("infoString_ic",caseInsensitiveEmail);
          result=dispatcher.runSync("performFind",UtilMisc.<String,Object>toMap("entityName","WorkEffortContactMechView","inputFields",inputFields,"userLogin",userLogin));
          EntityListIterator listIt=(EntityListIterator)result.get("listIt");
          try {
            List<GenericValue> list=listIt.getCompleteList();
            List<GenericValue> filteredList=EntityUtil.filterByDate(list);
            tempResults.addAll(filteredList);
          }
 catch (          GenericEntityException e) {
            Debug.logError(e,module);
          }
 finally {
            try {
              listIt.close();
            }
 catch (            GenericEntityException e) {
              Debug.logError(e,module);
            }
          }
        }
      }
    }
  }
  return tempResults;
}
