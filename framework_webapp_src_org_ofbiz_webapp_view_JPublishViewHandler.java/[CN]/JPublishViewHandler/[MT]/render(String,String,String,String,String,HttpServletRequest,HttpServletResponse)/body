{
  Writer writer=null;
  try {
    boolean useOutputStreamNotWriter=false;
    if (this.servletContext != null) {
      useOutputStreamNotWriter=UtilJ2eeCompat.useOutputStreamNotWriter(this.servletContext);
    }
    if (useOutputStreamNotWriter) {
      ServletOutputStream ros=response.getOutputStream();
      writer=new OutputStreamWriter(ros,"UTF-8");
    }
 else {
      writer=response.getWriter();
    }
    wrapper.render(page,request,response,writer,null,true);
  }
 catch (  IOException e) {
    throw new ViewHandlerException("Problems with the response writer/output stream",e);
  }
catch (  GeneralException e) {
    throw new ViewHandlerException("Cannot render page",e);
  }
}
