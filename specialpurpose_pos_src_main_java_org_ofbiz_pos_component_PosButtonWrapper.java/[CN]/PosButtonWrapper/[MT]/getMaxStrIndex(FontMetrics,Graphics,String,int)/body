{
  for (int i=str.length(); i > 0; i--) {
    double widthTest=fm.getStringBounds(str.substring(0,i),g).getWidth();
    if (widthTest < width) {
      return i;
    }
  }
  return str.length();
}
