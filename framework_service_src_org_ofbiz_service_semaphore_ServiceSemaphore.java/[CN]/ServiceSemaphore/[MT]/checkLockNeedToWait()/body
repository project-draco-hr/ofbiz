{
  String threadName=Thread.currentThread().getName();
  GenericValue semaphore;
  try {
    semaphore=delegator.findByPrimaryKey("ServiceSemaphore",UtilMisc.toMap("serviceName",model.name));
  }
 catch (  GenericEntityException e) {
    throw new SemaphoreFailException(e);
  }
  if (semaphore == null) {
    Map fields=UtilMisc.toMap("serviceName",model.name,"lockThread",threadName,"lockTime",lockTime);
    semaphore=delegator.makeValue("ServiceSemaphore",fields);
    dbWrite(semaphore,false);
    return false;
  }
 else {
    return true;
  }
}
