{
  PosTransaction trans=PosTransaction.getCurrentTx(pos.getSession());
  Input input=pos.getInput();
  String[] ckInfo=input.getFunction("CHECK");
  int paymentCheck=trans.checkPaymentMethodType("PERSONAL_CHECK");
  if (paymentCheck == PosTransaction.NO_PAYMENT) {
    trans.clearPayment("PERSONAL_CHECK");
    processNoPayment(pos,"PERSONAL_CHECK");
    return;
  }
 else   if (paymentCheck == PosTransaction.EXTERNAL_PAYMENT) {
    if (ckInfo == null) {
      input.setFunction("CHECK");
      pos.getOutput().print(UtilProperties.getMessage(PosTransaction.resource,"PosRefNum",Locale.getDefault()));
      return;
    }
 else {
      processExternalPayment(pos,"PERSONAL_CHECK",ckInfo[1]);
      return;
    }
  }
  pos.showDialog("dialog/error/notyetsupported");
}
