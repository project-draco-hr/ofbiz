{
  PosTransaction trans=PosTransaction.getCurrentTx(pos.getSession());
  Input input=pos.getInput();
  String refNum=input.value();
  if (refNum == null) {
    pos.getOutput().print(UtilProperties.getMessage(PosTransaction.resource,"PosRefNum",Locale.getDefault()));
    return;
  }
  input.clearInput();
  try {
    BigDecimal amount=processAmount(trans,pos,amountStr);
    Debug.logInfo("Processing [" + paymentMethodTypeId + "] Amount : "+ amount,module);
    trans.addPayment(paymentMethodTypeId,amount,refNum,null);
  }
 catch (  GeneralException e) {
  }
  clearInputPaymentFunctions(pos);
  pos.refresh();
}
