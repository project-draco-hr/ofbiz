{
  GenericDelegator delegator=dctx.getDelegator();
  String orderId=(String)context.get("orderId");
  GenericValue order=findGoogleOrder(delegator,orderId);
  if (order != null) {
    MerchantInfo mInfo=getMerchantInfo(delegator,getProductStoreFromOrder(order));
    if (mInfo != null) {
      String externalId=order.getString("externalId");
      Double amountToCharge=(Double)context.get("captureAmount");
      if (amountToCharge == null || amountToCharge == 0) {
        amountToCharge=order.getDouble("grandTotal");
      }
      if (amountToCharge > 0) {
        ChargeOrderRequest cor=new ChargeOrderRequest(mInfo,externalId,amountToCharge.floatValue());
        try {
          cor.send();
        }
 catch (        CheckoutException e) {
          Debug.logError(e,module);
        }
      }
    }
  }
  return ServiceUtil.returnSuccess();
}
