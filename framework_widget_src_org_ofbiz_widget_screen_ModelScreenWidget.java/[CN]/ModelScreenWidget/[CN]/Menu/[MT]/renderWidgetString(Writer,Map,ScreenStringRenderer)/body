{
  getModelMenu(context);
  MenuStringRenderer menuStringRenderer=(MenuStringRenderer)context.get("menuStringRenderer");
  if (menuStringRenderer == null) {
    HttpServletRequest request=(HttpServletRequest)context.get("request");
    HttpServletResponse response=(HttpServletResponse)context.get("response");
    if (request != null && response != null) {
      menuStringRenderer=new HtmlMenuRenderer(request,response);
    }
  }
  if (menuStringRenderer == null) {
    throw new IllegalArgumentException("Could not find a menuStringRenderer in the context, and could not find HTTP request/response objects need to create one.");
  }
  StringBuffer renderBuffer=new StringBuffer();
  this.modelMenu.renderMenuString(renderBuffer,context,menuStringRenderer);
  try {
    writer.write(renderBuffer.toString());
  }
 catch (  IOException e) {
    String errMsg="Error rendering included menu named [" + name + "] at location ["+ this.getLocation(context)+ "]: "+ e.toString();
    Debug.logError(e,errMsg,module);
    throw new RuntimeException(errMsg);
  }
}
