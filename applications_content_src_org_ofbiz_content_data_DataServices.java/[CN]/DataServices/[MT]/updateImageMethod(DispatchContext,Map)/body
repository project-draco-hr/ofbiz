{
  HashMap result=new HashMap();
  GenericDelegator delegator=dctx.getDelegator();
  LocalDispatcher dispatcher=dctx.getDispatcher();
  GenericValue image=null;
  String dataResourceId=(String)context.get("dataResourceId");
  ByteWrapper byteWrapper=(ByteWrapper)context.get("imageData");
  if (byteWrapper != null) {
    byte[] imageBytes=byteWrapper.getBytes();
    try {
      GenericValue imageDataResource=delegator.findByPrimaryKey("ImageDataResource",UtilMisc.toMap("dataResourceId",dataResourceId));
      if (Debug.infoOn())       Debug.logInfo("imageDataResource(U):" + imageDataResource,module);
      if (Debug.infoOn())       Debug.logInfo("imageBytes(U):" + imageBytes,module);
      if (imageDataResource == null) {
        return createImageMethod(dctx,context);
      }
 else {
        imageDataResource.setBytes("imageData",imageBytes);
        imageDataResource.store();
      }
    }
 catch (    GenericEntityException e) {
      return ServiceUtil.returnError(e.getMessage());
    }
  }
  return result;
}
