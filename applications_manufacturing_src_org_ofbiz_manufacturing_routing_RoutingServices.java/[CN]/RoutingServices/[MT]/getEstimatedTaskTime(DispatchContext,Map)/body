{
  Map result=new HashMap();
  GenericDelegator delegator=ctx.getDelegator();
  LocalDispatcher dispatcher=ctx.getDispatcher();
  String taskId=(String)context.get("taskId");
  Double quantity=(Double)context.get("quantity");
  String productId=(String)context.get("productId");
  String routingId=(String)context.get("routingId");
  if (quantity == null) {
    quantity=new Double(1);
  }
  GenericValue task=null;
  try {
    task=delegator.findByPrimaryKey("WorkEffort",UtilMisc.toMap("workEffortId",taskId));
  }
 catch (  GenericEntityException gee) {
    ServiceUtil.returnError("Error finding routing task with id: " + taskId);
  }
  long estimatedTaskTime=ProductionRun.getEstimatedTaskTime(task,quantity,productId,routingId,dispatcher);
  result.put("estimatedTaskTime",new Long(estimatedTaskTime));
  if (task != null && task.get("estimatedSetupMillis") != null) {
    result.put("setupTime",task.getDouble("estimatedSetupMillis"));
  }
  if (task != null && task.get("estimatedMilliSeconds") != null) {
    result.put("taskUnitTime",task.getDouble("estimatedMilliSeconds"));
  }
  return result;
}
