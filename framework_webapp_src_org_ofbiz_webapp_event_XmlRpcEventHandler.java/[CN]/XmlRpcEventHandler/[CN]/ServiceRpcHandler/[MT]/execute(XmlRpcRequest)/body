{
  String serviceName=xmlRpcReq.getMethodName();
  Map context;
  if (xmlRpcReq.getParameterCount() == 0) {
    context=FastMap.newInstance();
  }
 else {
    context=(Map)xmlRpcReq.getParameter(0);
  }
  XmlRpcHttpRequestConfig config=(XmlRpcHttpRequestConfig)xmlRpcReq.getConfig();
  String username=config.getBasicUserName();
  String password=config.getBasicPassword();
  if (UtilValidate.isNotEmpty(username)) {
    context.put("login.username",username);
    context.put("login.password",password);
  }
  Map resp;
  try {
    resp=dispatcher.runSync(serviceName,context);
  }
 catch (  GenericServiceException e) {
    throw new XmlRpcException(e.getMessage(),e);
  }
  if (ServiceUtil.isError(resp)) {
    throw new XmlRpcException(ServiceUtil.getErrorMessage(resp));
  }
  return resp;
}
