{
  Debug.logInfo("Print Receipt Requested : " + trans.getTransactionId(),module);
  POSPrinter printer=(POSPrinter)control;
  this.lastTransaction=trans;
  try {
    if (!checkState(printer)) {
      return;
    }
  }
 catch (  JposException e) {
    Debug.logError(e,module);
  }
  if (printStoreCopy) {
    String[] storeReceipt=this.readStoreTemplate();
    int payments=trans.getNumberOfPayments();
    for (int i=0; i < payments; i++) {
      Map<String,Object> info=trans.getPaymentInfo(i);
      if (info.containsKey("cardNumber")) {
        this.printReceipt(trans,storeReceipt,1,info);
      }
      try {
        Thread.sleep(3000);
      }
 catch (      Exception e) {
        Debug.logError(e,module);
      }
    }
  }
  String[] custReceipt=this.readCustomerTemplate();
  this.printReceipt(trans,custReceipt,0,null);
}
