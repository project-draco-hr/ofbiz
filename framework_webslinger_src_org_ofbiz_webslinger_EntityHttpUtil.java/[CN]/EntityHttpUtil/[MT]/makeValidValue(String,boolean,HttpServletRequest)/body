{
  GenericDelegator delegator=(GenericDelegator)request.getAttribute("delegator");
  GenericValue value=delegator.makeValue(entityName,(Map)null);
  ModelEntity model=value.getModelEntity();
  Iterator<ModelField> it=includePks ? model.getFieldsIterator() : model.getNopksIterator();
  Locale locale=UtilHttp.getLocale(request);
  while (it.hasNext()) {
    ModelField field=it.next();
    String fieldName=field.getName();
    String parameterValue=request.getParameter(fieldName);
    Object fieldValue;
    if (parameterValue == null) {
      fieldValue=null;
    }
 else {
      ModelFieldType fieldType=delegator.getEntityFieldType(model,field.getType());
      String wantedType=fieldType.getJavaType();
      fieldValue=ObjectType.simpleTypeConvert(parameterValue,wantedType,null,locale,true);
    }
    value.put(fieldName,fieldValue);
  }
  return value;
}
