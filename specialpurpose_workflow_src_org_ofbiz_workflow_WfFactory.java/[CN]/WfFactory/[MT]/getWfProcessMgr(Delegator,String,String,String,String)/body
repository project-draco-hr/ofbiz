{
  if (delegator == null)   throw new WfException("Delegator cannot be null");
  if (pkg == null)   throw new WfException("Workflow package id cannot be null.");
  if (pid == null)   throw new WfException("Workflow process id cannot be null");
  String key=delegator.getDelegatorName() + ":" + pkg+ ":"+ pkver+ ":"+ pid+ ":"+ pver;
  WfProcessMgrImpl wfProcessMgr=wfProcessMgrCache.get(key);
  if (wfProcessMgr == null) {
    wfProcessMgr=wfProcessMgrCache.putIfAbsentAndGet(key,new WfProcessMgrImpl(delegator,pkg,pkver,pid,pver));
  }
  return wfProcessMgr;
}
