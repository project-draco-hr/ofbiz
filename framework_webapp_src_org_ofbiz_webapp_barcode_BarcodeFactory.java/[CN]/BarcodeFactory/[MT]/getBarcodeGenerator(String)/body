{
synchronized (barcodeGeneratorMap) {
    if (barcodeGeneratorMap.containsKey(barcodeType)) {
      return (BarcodeGenerator)barcodeGeneratorMap.get(barcodeType);
    }
 else {
      String specificationFile="barcode/" + barcodeType + ".xml";
      URL specificationUrl=UtilURL.fromResource(specificationFile);
      if (specificationUrl == null) {
        Debug.logError("Problem getting the specification URL: " + specificationFile + " not found",module);
        return null;
      }
      StringBuffer format=new StringBuffer();
      BufferedReader specificationReader=null;
      try {
        specificationReader=new BufferedReader(new InputStreamReader(specificationUrl.openStream()));
        String line=null;
        while ((line=specificationReader.readLine()) != null) {
          format.append(line);
        }
      }
 catch (      java.io.IOException e) {
        Debug.logError(e,"Error reading the specification URL: " + specificationFile,module);
        return null;
      }
 finally {
        if (specificationReader != null) {
          try {
            specificationReader.close();
          }
 catch (          IOException e) {
            Debug.logError(e,"Error closing the specification URL: " + specificationFile,module);
            return null;
          }
        }
      }
      BarcodeGenerator generator=new BarcodeGenerator(format.toString());
      barcodeGeneratorMap.put(barcodeType,generator);
      return generator;
    }
  }
}
