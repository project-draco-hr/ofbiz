{
  Element serviceElement=getServiceElement(modelService);
  List serverList=serverList(serviceElement);
  Map result=FastMap.newInstance();
  Iterator i=serverList.iterator();
  while (i.hasNext()) {
    Element server=(Element)i.next();
    String serverType=server.getAttribute("type");
    if (serverType.equals("topic"))     result.putAll(runTopic(modelService,context,server));
 else     if (serverType.equals("queue"))     result.putAll(runQueue(modelService,context,server));
 else     throw new GenericServiceException("Illegal server messaging type.");
  }
  return result;
}
