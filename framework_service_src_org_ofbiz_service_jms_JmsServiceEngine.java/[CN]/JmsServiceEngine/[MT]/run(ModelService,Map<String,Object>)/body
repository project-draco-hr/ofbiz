{
  Element serviceElement=getServiceElement(modelService);
  List<? extends Element> serverList=serverList(serviceElement);
  Map<String,Object> result=FastMap.newInstance();
  for (  Element server : serverList) {
    String serverType=server.getAttribute("type");
    if (serverType.equals("topic"))     result.putAll(runTopic(modelService,context,server));
 else     if (serverType.equals("queue"))     result.putAll(runQueue(modelService,context,server));
 else     throw new GenericServiceException("Illegal server messaging type.");
  }
  return result;
}
