{
  GenericValue dataObject=getRuntimeObject();
  if (validStates().contains(newState)) {
    try {
      long now=(new Date()).getTime();
      dataObject.set("currentStatusId",WfUtil.getOFBStatus(newState));
      dataObject.set("lastStatusUpdate",new Timestamp(now));
      dataObject.store();
    }
 catch (    GenericEntityException e) {
      throw new WfException(e.getMessage(),e);
    }
  }
 else {
    throw new InvalidState();
  }
}
