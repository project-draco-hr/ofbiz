{
  LocalDispatcher dispatcher=dctx.getDispatcher();
  Map result=new HashMap();
  try {
    ModelService checkPermModel=dispatcher.getDispatchContext().getModelService("checkContentPermission");
    Map ctx=checkPermModel.makeValid(context,"IN");
    Map thisResult=dispatcher.runSync("checkContentPermission",ctx);
    String permissionStatus=(String)thisResult.get("permissionStatus");
    if (UtilValidate.isNotEmpty(permissionStatus) && permissionStatus.equalsIgnoreCase("granted")) {
      result=persistDataResourceAndDataMethod(dctx,context);
    }
  }
 catch (  GenericServiceException e) {
    return ServiceUtil.returnError(e.getMessage());
  }
catch (  GenericEntityException e) {
    return ServiceUtil.returnError(e.getMessage());
  }
catch (  Exception e) {
    return ServiceUtil.returnError(e.getMessage());
  }
  String errorMsg=ServiceUtil.getErrorMessage(result);
  if (UtilValidate.isNotEmpty(errorMsg)) {
    return ServiceUtil.returnError(errorMsg);
  }
  return result;
}
