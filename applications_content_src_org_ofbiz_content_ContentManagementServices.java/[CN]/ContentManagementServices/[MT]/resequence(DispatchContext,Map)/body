{
  HashMap result=new HashMap();
  GenericDelegator delegator=dctx.getDelegator();
  String contentIdTo=(String)context.get("contentIdTo");
  Integer seqInc=(Integer)context.get("seqInc");
  if (seqInc == null)   seqInc=new Integer(100);
  int seqIncrement=seqInc.intValue();
  List typeList=(List)context.get("typeList");
  if (typeList == null)   typeList=new ArrayList();
  String contentAssocTypeId=(String)context.get("contentAssocTypeId");
  if (UtilValidate.isNotEmpty(contentAssocTypeId))   typeList.add(contentAssocTypeId);
  if (UtilValidate.isEmpty(typeList))   typeList=UtilMisc.toList("PUBLISH_LINK","SUB_CONTENT");
  List condList=new ArrayList();
  Iterator iterType=typeList.iterator();
  while (iterType.hasNext()) {
    String type=(String)iterType.next();
    condList.add(new EntityExpr("contentAssocTypeId",EntityOperator.EQUALS,type));
  }
  EntityCondition conditionType=new EntityConditionList(condList,EntityOperator.OR);
  EntityCondition conditionMain=new EntityConditionList(UtilMisc.toList(new EntityExpr("contentIdTo",EntityOperator.EQUALS,contentIdTo),conditionType),EntityOperator.AND);
  try {
    List listAll=delegator.findByCondition("ContentAssoc",conditionMain,null,UtilMisc.toList("sequenceNum","fromDate","createdDate"));
    List listFiltered=EntityUtil.filterByDate(listAll);
    String contentId=(String)context.get("contentId");
    String dir=(String)context.get("dir");
    int seqNum=seqIncrement;
    String thisContentId=null;
    for (int i=0; i < listFiltered.size(); i++) {
      GenericValue contentAssoc=(GenericValue)listFiltered.get(i);
      if (UtilValidate.isNotEmpty(contentId) && UtilValidate.isNotEmpty(dir)) {
        thisContentId=contentAssoc.getString("contentId");
        if (contentId.equals(thisContentId)) {
          if (dir.startsWith("up")) {
            if (i > 0) {
              try {
                GenericValue prevValue=(GenericValue)listFiltered.get(i - 1);
                Long prevSeqNum=(Long)prevValue.get("sequenceNum");
                prevValue.put("sequenceNum",new Long(seqNum));
                prevValue.store();
                contentAssoc.put("sequenceNum",prevSeqNum);
                contentAssoc.store();
              }
 catch (              Exception e) {
                return ServiceUtil.returnError(e.getMessage());
              }
            }
          }
 else {
            if (i < listFiltered.size()) {
              GenericValue nextValue=(GenericValue)listFiltered.get(i + 1);
              nextValue.put("sequenceNum",new Long(seqNum));
              nextValue.store();
              seqNum+=seqIncrement;
              contentAssoc.put("sequenceNum",new Long(seqNum));
              contentAssoc.store();
              i++;
            }
          }
        }
 else {
          contentAssoc.put("sequenceNum",new Long(seqNum));
          contentAssoc.store();
        }
      }
 else {
        contentAssoc.put("sequenceNum",new Long(seqNum));
        contentAssoc.store();
      }
      seqNum+=seqIncrement;
    }
  }
 catch (  GenericEntityException e) {
    Debug.logError(e,module);
    return ServiceUtil.returnError(e.getMessage());
  }
  return result;
}
