{
  LocalDispatcher dispatcher=dctx.getDispatcher();
  Delegator delegator=dctx.getDelegator();
  Map<String,Object> results=FastMap.newInstance();
  Map<String,Object> serviceContext=FastMap.newInstance();
  String siteContentId=(String)context.get("contentId");
  String partyId=(String)context.get("partyId");
  serviceContext.put("partyId",partyId);
  serviceContext.put("contentId",siteContentId);
  List<GenericValue> siteRoles=null;
  try {
    siteRoles=delegator.findByAndCache("RoleType",UtilMisc.toMap("parentTypeId","BLOG"));
  }
 catch (  GenericEntityException e) {
    return ServiceUtil.returnError(e.toString());
  }
  Iterator<GenericValue> siteRoleIter=siteRoles.iterator();
  while (siteRoleIter.hasNext()) {
    GenericValue roleType=siteRoleIter.next();
    String siteRole=(String)roleType.get("roleTypeId");
    String cappedSiteRole=ModelUtil.dbNameToVarName(siteRole);
    String siteRoleVal=(String)context.get(cappedSiteRole);
    Object fromDate=context.get(cappedSiteRole + "FromDate");
    serviceContext.put("roleTypeId",siteRole);
    if (siteRoleVal != null && siteRoleVal.equalsIgnoreCase("Y")) {
      if (fromDate == null) {
        try {
          serviceContext.put("fromDate",UtilDateTime.nowTimestamp());
          if (Debug.infoOn()) {
            Debug.logInfo("updateSiteRoles, serviceContext(1):" + serviceContext,module);
          }
          addRoleToUser(delegator,dispatcher,serviceContext);
          dispatcher.runSync("createContentRole",serviceContext);
        }
 catch (        GenericServiceException e) {
          Debug.logError(e,e.toString(),module);
        }
catch (        Exception e2) {
          Debug.logError(e2,e2.toString(),module);
        }
      }
    }
 else {
      if (fromDate != null) {
        try {
          Debug.logInfo("updateSiteRoles, serviceContext(2):" + serviceContext,module);
          Map<String,Object> newContext=FastMap.newInstance();
          newContext.put("contentId",serviceContext.get("contentId"));
          newContext.put("partyId",serviceContext.get("partyId"));
          newContext.put("roleTypeId",serviceContext.get("roleTypeId"));
          dispatcher.runSync("deactivateAllContentRoles",newContext);
        }
 catch (        GenericServiceException e) {
          Debug.logError(e,e.toString(),module);
        }
catch (        Exception e2) {
          Debug.logError(e2,e2.toString(),module);
        }
      }
    }
  }
  return results;
}
