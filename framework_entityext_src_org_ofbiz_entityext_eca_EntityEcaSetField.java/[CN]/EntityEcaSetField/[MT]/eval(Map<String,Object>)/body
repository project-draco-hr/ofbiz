{
  if (fieldName != null) {
    if (UtilValidate.isEmpty(value)) {
      if (UtilValidate.isNotEmpty(envName) && envName.startsWith("${")) {
        FlexibleStringExpander exp=FlexibleStringExpander.getInstance(envName);
        String s=exp.expandString(context);
        if (UtilValidate.isNotEmpty(s)) {
          value=s;
        }
        Debug.log("Expanded String: " + s,module);
      }
    }
    if (UtilValidate.isNotEmpty(value)) {
      context.put(fieldName,this.format(value,context));
    }
 else     if (UtilValidate.isNotEmpty(envName) && context.get(envName) != null) {
      context.put(fieldName,this.format((String)context.get(envName),context));
    }
  }
}
