{
  String resourceCacheKey=resource + "_" + locale.toString();
  ResourceBundleMapWrapper.InternalRbmWrapper bundleMap=bundleLocaleCache.get(resourceCacheKey);
  if (bundleMap == null) {
synchronized (UtilProperties.class) {
      bundleMap=bundleLocaleCache.get(resourceCacheKey);
      if (bundleMap == null) {
        ResourceBundle bundle=getBaseResourceBundle(resource,locale);
        if (bundle == null) {
          throw new IllegalArgumentException("Could not find resource bundle [" + resource + "] in the locale ["+ locale+ "]");
        }
        bundleMap=new ResourceBundleMapWrapper.InternalRbmWrapper(bundle);
        if (bundleMap != null) {
          bundleLocaleCache.put(resourceCacheKey,bundleMap);
        }
      }
    }
  }
  return bundleMap;
}
