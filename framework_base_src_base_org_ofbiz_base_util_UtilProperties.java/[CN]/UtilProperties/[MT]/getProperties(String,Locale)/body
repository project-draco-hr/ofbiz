{
  if (resource == null || resource.length() <= 0)   return null;
  if (locale == null)   locale=Locale.getDefault();
  String localeString=locale.toString();
  String resourceLocale=resource + "_" + localeString;
  FlexibleProperties properties=resourceCache.get(resourceLocale);
  if (properties == null) {
    try {
      URL url=UtilURL.fromResource(resourceLocale);
      if (url == null) {
        properties=(FlexibleProperties)getProperties(resource);
      }
 else {
        properties=FlexibleProperties.makeFlexibleProperties(url);
      }
    }
 catch (    MissingResourceException e) {
      Debug.log(e.getMessage(),module);
    }
    resourceCache.put(resourceLocale,properties);
  }
  if (properties == null)   Debug.logInfo("[UtilProperties.getProperties] could not find resource: " + resource + ", locale: "+ locale,module);
  return properties;
}
