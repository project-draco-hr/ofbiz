{
  ResourceBundle bundle=null;
  try {
    bundle=ResourceBundle.getBundle(resource,locale,loader);
  }
 catch (  MissingResourceException e) {
  }
  if (bundle != null) {
    return bundle;
  }
  try {
    URL url=FlexibleLocation.resolveLocation(resource,loader);
    if (url == null) {
      url=FlexibleLocation.resolveLocation(resource + ".xml");
    }
    if (url != null) {
      Document doc=UtilXml.readXmlDocument(url);
      bundle=createBundle(doc,locale.toString());
      if (bundle == null && !Locale.getDefault().toString().equals(locale.toString())) {
        bundle=createBundle(doc,Locale.getDefault().toString());
      }
      if (bundle == null && !getFallbackLocale().toString().equals(locale.toString())) {
        bundle=createBundle(doc,getFallbackLocale().toString());
      }
    }
  }
 catch (  Exception e) {
    throw new MissingResourceException(e.getMessage(),null,null);
  }
  if (bundle == null) {
    throw new MissingResourceException("Resource " + resource + " not found",null,null);
  }
  return bundle;
}
