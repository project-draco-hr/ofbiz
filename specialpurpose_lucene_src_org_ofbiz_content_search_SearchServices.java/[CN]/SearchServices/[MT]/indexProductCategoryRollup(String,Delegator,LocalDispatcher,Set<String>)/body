{
  List<GenericValue> productCategoryRollups=delegator.findByAnd("ProductCategoryRollup",UtilMisc.toMap("parentProductCategoryId",parentProductCategoryId),null,false);
  for (  GenericValue productCategoryRollup : productCategoryRollups) {
    String productCategoryId=productCategoryRollup.getString("productCategoryId");
    if (!excludeProductCategoryIds.add(productCategoryId)) {
      continue;
    }
    indexProductCategoryMembers(productCategoryId,delegator,dispatcher);
    indexProductCategoryRollup(productCategoryId,delegator,dispatcher,excludeProductCategoryIds);
  }
}
