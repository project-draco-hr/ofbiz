{
  Iterator tools=null;
  try {
    ActivityTypes acTypes=actDef.getActivityTypes();
    org.enhydra.shark.xpdl.elements.Implementation impl=acTypes.getImplementation();
    ImplementationTypes implt=impl.getImplementationTypes();
    org.enhydra.shark.xpdl.elements.Tools tolls=implt.getTools();
    ArrayList al=tolls.toElements();
    tools=al.iterator();
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw new BaseException(e);
  }
  while (tools.hasNext()) {
    Tool tool=(Tool)tools.next();
    cus.info("Activity" + activity.toString() + " - Executing tool [id="+ tool.getId()+ "]");
    try {
      invokeApplication(tool);
    }
 catch (    Throwable ex) {
      cus.error("Activity" + activity.toString() + " - failed to execute tool [id="+ tool.getId()+ "]");
      if (ex instanceof ToolAgentGeneralException) {
        throw (ToolAgentGeneralException)ex;
      }
 else {
        throw new BaseException(ex);
      }
    }
  }
}
