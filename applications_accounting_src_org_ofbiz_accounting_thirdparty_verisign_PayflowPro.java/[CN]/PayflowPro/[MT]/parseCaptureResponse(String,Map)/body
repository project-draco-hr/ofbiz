{
  Map parameters=new LinkedMap();
  List params=StringUtil.split(resp,"&");
  Iterator i=params.iterator();
  while (i.hasNext()) {
    String str=(String)i.next();
    if (str.length() > 0) {
      List kv=StringUtil.split(str,"=");
      Object k=kv.get(0);
      Object v=kv.get(1);
      if (k != null && v != null)       parameters.put(k,v);
    }
  }
  String respCode=(String)parameters.get("RESULT");
  if (respCode.equals("0")) {
    result.put("captureResult",Boolean.TRUE);
    result.put("captureCode",parameters.get("AUTHCODE"));
  }
 else {
    Debug.logWarning("In PayflowPro failing authorization; respCode/RESULT=" + respCode + "; PNREF="+ parameters.get("PNREF")+ "; AUTHCODE="+ parameters.get("AUTHCODE"),module);
    result.put("captureResult",Boolean.FALSE);
  }
  result.put("captureRefNum",parameters.get("PNREF"));
  result.put("captureFlag",parameters.get("RESULT"));
  result.put("captureMessage",parameters.get("RESPMSG"));
}
