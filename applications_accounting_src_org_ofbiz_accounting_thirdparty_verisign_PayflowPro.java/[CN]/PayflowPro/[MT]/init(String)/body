{
  String certsPath=UtilProperties.getPropertyValue(resource,"payment.verisign.certsPath","pfcerts");
  String hostAddress=UtilProperties.getPropertyValue(resource,"payment.verisign.hostAddress","test-payflow.verisign.com");
  Integer hostPort=Integer.decode(UtilProperties.getPropertyValue(resource,"payment.verisign.hostPort","443"));
  Integer timeout=Integer.decode(UtilProperties.getPropertyValue(resource,"payment.verisign.timeout","80"));
  String proxyAddress=UtilProperties.getPropertyValue(resource,"payment.verisign.proxyAddress","");
  Integer proxyPort=Integer.decode(UtilProperties.getPropertyValue(resource,"payment.verisign.proxyPort","80"));
  String proxyLogon=UtilProperties.getPropertyValue(resource,"payment.verisign.proxyLogon","");
  String proxyPassword=UtilProperties.getPropertyValue(resource,"payment.verisign.proxyPassword","");
  PFProAPI pn=new PFProAPI();
  pn.SetCertPath(certsPath);
  pn.CreateContext(hostAddress,hostPort.intValue(),timeout.intValue(),proxyAddress,proxyPort.intValue(),proxyLogon,proxyPassword);
  return pn;
}
