{
  if (str == null)   return null;
  try {
    byte codeBytes[]=null;
    if (code == null)     codeBytes=str.getBytes();
 else     codeBytes=str.getBytes(code);
    MessageDigest messagedigest=MessageDigest.getInstance(hashType);
    messagedigest.update(codeBytes);
    byte digestBytes[]=messagedigest.digest();
    char[] digestChars=Hex.encodeHex(digestBytes);
    ;
    StringBuilder sb=new StringBuilder();
    sb.append("{").append(hashType).append("}");
    sb.append(digestChars,0,digestChars.length);
    return sb.toString();
  }
 catch (  Exception e) {
    throw new GeneralRuntimeException("Error while computing hash of type " + hashType,e);
  }
}
