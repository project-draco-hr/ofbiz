{
  try {
    MessageDigest messagedigest=MessageDigest.getInstance(hashType);
    messagedigest.update(salt.getBytes("UTF-8"));
    messagedigest.update(password.getBytes("UTF-8"));
    StringBuilder sb=new StringBuilder();
    sb.append("$").append(hashType).append("$").append(salt).append("$");
    sb.append(Base64.encodeBase64URLSafeString(messagedigest.digest()).replace('+','.'));
    return sb.toString();
  }
 catch (  NoSuchAlgorithmException e) {
    throw new GeneralRuntimeException("Error while comparing password",e);
  }
catch (  UnsupportedEncodingException e) {
    throw new GeneralRuntimeException("Error while comparing password",e);
  }
}
