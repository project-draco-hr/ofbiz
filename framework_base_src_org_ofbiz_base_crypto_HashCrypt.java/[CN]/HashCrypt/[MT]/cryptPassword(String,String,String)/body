{
  if (hashType == null) {
    hashType="SHA";
  }
  if (salt == null) {
    salt=RandomStringUtils.random(new Random().nextInt(15) + 1,CRYPT_CHAR_SET);
  }
  StringBuilder sb=new StringBuilder();
  sb.append("$").append(hashType).append("$").append(salt).append("$");
  sb.append(getCryptedBytes(hashType,salt,password.getBytes(UTF8)));
  return sb.toString();
}
