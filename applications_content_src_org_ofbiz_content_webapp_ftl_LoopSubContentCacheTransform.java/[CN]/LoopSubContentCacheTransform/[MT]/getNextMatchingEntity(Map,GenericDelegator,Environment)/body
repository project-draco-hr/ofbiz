{
  int lowIndex=((Integer)templateRoot.get("lowIndex")).intValue();
  int entityIndex=((Integer)templateRoot.get("entityIndex")).intValue();
  int outputIndex=((Integer)templateRoot.get("outputIndex")).intValue();
  int listSize=((Integer)templateRoot.get("listSize")).intValue();
  boolean matchFound=false;
  while (!matchFound && entityIndex < listSize) {
    try {
      matchFound=prepCtx(delegator,templateRoot,env);
    }
 catch (    GeneralException e) {
      throw new IOException(e.getMessage());
    }
    entityIndex++;
    templateRoot.put("entityIndex",new Integer(entityIndex));
    if (matchFound) {
      outputIndex++;
      if (outputIndex >= lowIndex) {
        break;
      }
 else {
        matchFound=false;
      }
    }
  }
  templateRoot.put("outputIndex",new Integer(outputIndex));
  env.setVariable("outputIndex",FreeMarkerWorker.autoWrap(new Integer(outputIndex),env));
  env.setVariable("entityIndex",FreeMarkerWorker.autoWrap(new Integer(entityIndex),env));
  return matchFound;
}
