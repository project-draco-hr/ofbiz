{
  Assert.notNull("webAppInfo",webAppInfo,"delegator",delegator);
  WebSiteProperties webSiteProps=null;
  String webSiteId=WebAppUtil.getWebSiteId(webAppInfo);
  if (webSiteId != null) {
    GenericValue webSiteValue=delegator.findOne("WebSite",UtilMisc.toMap("webSiteId",webSiteId),true);
    if (webSiteValue != null) {
      webSiteProps=WebSiteProperties.from(webSiteValue);
    }
  }
  if (webSiteProps == null) {
    webSiteProps=WebSiteProperties.defaults();
  }
  ControllerConfig config=ConfigXMLReader.getControllerConfig(webAppInfo);
  String servletPath=WebAppUtil.getControlServletPath(webAppInfo);
  return new OfbizUrlBuilder(config,webSiteProps,servletPath);
}
