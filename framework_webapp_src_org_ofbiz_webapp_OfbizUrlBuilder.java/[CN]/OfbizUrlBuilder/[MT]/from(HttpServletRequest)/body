{
  Assert.notNull("request",request);
  WebSiteProperties webSiteProps=(WebSiteProperties)request.getAttribute("_WEBSITE_PROPS_");
  if (webSiteProps == null) {
    webSiteProps=WebSiteProperties.from(request);
    request.setAttribute("_WEBSITE_PROPS_",webSiteProps);
  }
  URL url=ConfigXMLReader.getControllerConfigURL(request.getServletContext());
  ControllerConfig config=ConfigXMLReader.getControllerConfig(url);
  String servletPath=(String)request.getAttribute("_CONTROL_PATH_");
  return new OfbizUrlBuilder(config,webSiteProps,servletPath);
}
