{
  try {
    Interpreter interpreter=makeInterpreter(context);
    Interpreter.ParsedScript script=null;
    script=parsedScripts.get(location);
    if (script == null) {
      URL scriptUrl=FlexibleLocation.resolveLocation(location);
      if (scriptUrl == null) {
        throw new GeneralException("Could not find bsh script at [" + location + "]");
      }
      Reader scriptReader=new InputStreamReader(scriptUrl.openStream());
      script=interpreter.parseScript(location,scriptReader);
      if (Debug.verboseOn())       Debug.logVerbose("Caching BSH script at: " + location,module);
      script=parsedScripts.putIfAbsentAndGet(location,script);
    }
    return interpreter.evalParsedScript(script);
  }
 catch (  MalformedURLException e) {
    String errMsg="Error loading BSH script at [" + location + "]: "+ e.toString();
    Debug.logError(e,errMsg,module);
    throw new GeneralException(errMsg,e);
  }
catch (  ParseException e) {
    String errMsg="Error parsing BSH script at [" + location + "]: "+ e.toString();
    Debug.logError(e,errMsg,module);
    throw new GeneralException(errMsg,e);
  }
catch (  IOException e) {
    String errMsg="Error loading BSH script at [" + location + "]: "+ e.toString();
    Debug.logError(e,errMsg,module);
    throw new GeneralException(errMsg,e);
  }
catch (  EvalError ee) {
    Throwable t=ee.getCause();
    if (t == null) {
      Debug.logWarning(ee,"WARNING: no cause (from getCause) found for BSH EvalError: " + ee.toString(),module);
      t=ee;
    }
 else {
      Debug.logError(t,"ERROR: Got cause (from getCause) for BSH EvalError: " + ee.toString(),module);
    }
    String errMsg="Error running BSH script at [" + location + "], line ["+ ee.getErrorLineNumber()+ "]: "+ t.toString();
    throw new GeneralException(errMsg,t);
  }
}
