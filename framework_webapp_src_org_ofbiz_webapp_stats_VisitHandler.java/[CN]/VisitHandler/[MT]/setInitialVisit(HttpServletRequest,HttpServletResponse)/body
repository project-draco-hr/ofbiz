{
  HttpSession session=request.getSession();
  getVisitor(request,response);
  String webappName=UtilHttp.getApplicationName(request);
  StringBuffer fullRequestUrl=UtilHttp.getFullRequestUrl(request);
  String initialLocale=request.getLocale() != null ? request.getLocale().toString() : "";
  String initialRequest=fullRequestUrl.toString();
  String initialReferrer=request.getHeader("Referer") != null ? request.getHeader("Referer") : "";
  String initialUserAgent=request.getHeader("User-Agent") != null ? request.getHeader("User-Agent") : "";
  session.setAttribute("_CLIENT_LOCALE_",request.getLocale());
  session.setAttribute("_CLIENT_REQUEST_",initialRequest);
  session.setAttribute("_CLIENT_USER_AGENT_",initialUserAgent);
  session.setAttribute("_CLIENT_REFERER_",initialUserAgent);
  VisitHandler.setInitials(request,session,initialLocale,initialRequest,initialReferrer,initialUserAgent,webappName);
}
