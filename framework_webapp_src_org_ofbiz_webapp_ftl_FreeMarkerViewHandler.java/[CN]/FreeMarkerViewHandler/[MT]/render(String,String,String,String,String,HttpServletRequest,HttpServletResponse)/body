{
  if (page == null || page.length() == 0)   throw new ViewHandlerException("Invalid template source");
  SimpleHash root=new SimpleHash(BeansWrapper.getDefaultInstance());
  prepOfbizRoot(root,request,response);
  Template template=null;
  try {
    template=config.getTemplate(page,UtilHttp.getLocale(request));
  }
 catch (  IOException e) {
    throw new ViewHandlerException("Cannot open template file: " + page,e);
  }
  template.setObjectWrapper(BeansWrapper.getDefaultInstance());
  try {
    template.process(root,response.getWriter(),BeansWrapper.getDefaultInstance());
    response.flushBuffer();
  }
 catch (  TemplateException te) {
    throw new ViewHandlerException("Problems processing Freemarker template",te);
  }
catch (  IOException ie) {
    throw new ViewHandlerException("Problems writing to output stream",ie);
  }
}
