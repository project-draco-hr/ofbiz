{
  this.servletContext=context;
  config=new freemarker.template.Configuration();
  JPublishTemplateLoader templateLoader=new JPublishTemplateLoader();
  config.setTemplateLoader(templateLoader);
  config.setLocalizedLookup(false);
  try {
    config.setDirectoryForTemplateLoading(new File(context.getRealPath("/")));
  }
 catch (  java.io.IOException e) {
    throw new ViewHandlerException("Could not create file for webapp root path",e);
  }
  WrappingTemplateModel.setDefaultObjectWrapper(BeansWrapper.getDefaultInstance());
  try {
    config.setObjectWrapper(BeansWrapper.getDefaultInstance());
    config.setCacheStorage(new OfbizCacheStorage("unknown"));
    config.setSetting("datetime_format","yyyy-MM-dd HH:mm:ss.SSS");
  }
 catch (  TemplateException e) {
    throw new ViewHandlerException("Freemarker TemplateException",e.getCause());
  }
}
