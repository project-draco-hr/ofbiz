{
  boolean allDelegated=true;
  boolean acceptAll=activity.getDefinitionObject().get("acceptAllAssignments") != null ? activity.getDefinitionObject().getBoolean("acceptAllAssignments").booleanValue() : false;
  if (!acceptAll) {
    if (!activity.state().equals("open.not_running.not_started")) {
      Iterator<WfAssignment> ai=activity.getIteratorAssignment();
      while (ai.hasNext() && allDelegated) {
        WfAssignment a=(WfAssignment)ai.next();
        if (!a.equals(this) && !a.status().equals("CAL_DELEGATED")) {
          allDelegated=false;
        }
      }
      if (!allDelegated) {
        throw new WfException("Cannot accept; Activity already running with active assignments");
      }
    }
 else {
      Debug.logVerbose("[WfAssignment.accept] : setting other assignments to delegated status.",module);
      Iterator<WfAssignment> ai=activity.getIteratorAssignment();
      while (ai.hasNext()) {
        WfAssignment a=(WfAssignment)ai.next();
        if (!this.isEqual(a))         a.delegate();
      }
    }
  }
  changeStatus("CAL_ACCEPTED");
}
