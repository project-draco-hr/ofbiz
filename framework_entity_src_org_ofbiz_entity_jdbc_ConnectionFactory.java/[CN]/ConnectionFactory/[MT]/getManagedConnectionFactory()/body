{
  ConnectionFactoryInterface instance=connFactoryRef.get();
  if (instance == null) {
    try {
      instance=createConnectionFactoryInterface();
      if (connFactoryRef.compareAndSet(null,instance)) {
        Debug.logInfo("Factory method created new ConnectionFactoryInterface instance " + instance,module);
      }
 else {
        instance=connFactoryRef.get();
      }
    }
 catch (    Exception e) {
      Debug.logError(e,"Exception thrown while creating ConnectionFactoryInterface instance: ",module);
      throw new IllegalStateException("Error loading ConnectionFactoryInterface class: " + e);
    }
  }
  return instance;
}
