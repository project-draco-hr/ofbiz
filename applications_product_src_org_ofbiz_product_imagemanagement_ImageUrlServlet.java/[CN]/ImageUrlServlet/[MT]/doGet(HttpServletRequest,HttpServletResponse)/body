{
  Delegator delegator=(Delegator)getServletContext().getAttribute("delegator");
  String pathInfo=request.getPathInfo();
  List<String> pathElements=StringUtil.split(pathInfo,"/");
  String lastPathElement=pathElements.get(pathElements.size() - 1);
  List<String> tagElements=FastList.newInstance();
  for (  String pathElement : pathElements) {
    tagElements.addAll(StringUtil.split(pathElement,"-"));
  }
  String lastTagElement=tagElements.get(tagElements.size() - 1);
  String contentId=lastTagElement.substring(0,lastTagElement.lastIndexOf("."));
  String sizeTagElement=tagElements.get(tagElements.size() - 2);
  GenericValue content=null;
  try {
    GenericValue contentResult=delegator.findOne("Content",UtilMisc.toMap("contentId",contentId),false);
    if (contentResult == null) {
      content=delegator.findOne("Content",UtilMisc.toMap("contentId",sizeTagElement),false);
    }
 else {
      content=delegator.findOne("Content",UtilMisc.toMap("contentId",contentId),false);
    }
  }
 catch (  GenericEntityException e) {
    Debug.logError(e,module);
  }
  GenericValue dataResource=null;
  try {
    dataResource=content.getRelatedOne("DataResource");
  }
 catch (  GenericEntityException e) {
    Debug.logError(e,module);
  }
  String imageUrl=dataResource.getString("objectInfo");
  RequestDispatcher rd=request.getRequestDispatcher("/control/viewImage?drObjectInfo=" + imageUrl);
  rd.forward(request,response);
}
