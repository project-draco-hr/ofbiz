{
  Map result=ServiceUtil.returnSuccess();
  ShoppingCart shoppingCart=(ShoppingCart)context.get("shoppingCart");
  if (shoppingCart != null) {
    result.put("totalQuantity",new Double(shoppingCart.getTotalQuantity()));
    result.put("currencyIsoCode",shoppingCart.getCurrency());
    result.put("subTotal",new Double(shoppingCart.getSubTotal()));
    result.put("totalShipping",new Double(shoppingCart.getTotalShipping()));
    result.put("totalSalesTax",new Double(shoppingCart.getTotalSalesTax()));
    result.put("displayGrandTotal",new Double(shoppingCart.getDisplayGrandTotal()));
    Iterator i=shoppingCart.iterator();
    Map cartItemData=FastMap.newInstance();
    while (i.hasNext()) {
      ShoppingCartItem cartLine=(ShoppingCartItem)i.next();
      int cartLineIndex=shoppingCart.getItemIndex(cartLine);
      cartItemData.put("displayItemSubTotal_" + cartLineIndex,new Double(cartLine.getDisplayItemSubTotal()));
    }
    result.put("cartItemData",cartItemData);
  }
  return result;
}
