{
  Iterator<ModelIndex.Field> fieldsIter=modelIndex.getFieldsIterator();
  StringBuilder mainCols=new StringBuilder();
  while (fieldsIter.hasNext()) {
    ModelIndex.Field field=fieldsIter.next();
    ModelIndex.Function function=field.getFunction();
    if (mainCols.length() > 0) {
      mainCols.append(", ");
    }
    if (function != null) {
      mainCols.append(function.toString()).append('(');
    }
    ModelField mainField=entity.getField(field.getFieldName());
    mainCols.append(mainField.getColName());
    if (function != null) {
      mainCols.append(')');
    }
  }
  StringBuilder indexSqlBuf=new StringBuilder("CREATE ");
  if (datasourceInfo.useIndicesUnique && modelIndex.getUnique()) {
    indexSqlBuf.append("UNIQUE ");
  }
  indexSqlBuf.append("INDEX ");
  indexSqlBuf.append(makeIndexName(modelIndex,datasourceInfo.constraintNameClipLength));
  indexSqlBuf.append(" ON ");
  indexSqlBuf.append(entity.getTableName(datasourceInfo));
  indexSqlBuf.append(" (");
  indexSqlBuf.append(mainCols.toString());
  indexSqlBuf.append(")");
  return indexSqlBuf.toString();
}
