{
  String freq[]={"","SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"};
  if (frequency < 1 || frequency > 7)   throw new RecurrenceRuleException("Invalid frequency");
  if (interval < 0)   throw new RecurrenceRuleException("Invalid interval");
  String freqStr=freq[frequency];
  try {
    String ruleId=delegator.getNextSeqId("RecurrenceRule").toString();
    GenericValue value=delegator.makeValue("RecurrenceRule",UtilMisc.toMap("recurrenceRuleId",ruleId));
    value.set("frequency",freqStr);
    value.set("intervalNumber",new Long(interval));
    value.set("countNumber",new Long(count));
    if (endTime > 0) {
      value.set("untilDateTime",new java.sql.Timestamp(endTime));
    }
    delegator.create(value);
    RecurrenceRule newRule=new RecurrenceRule(value);
    return newRule;
  }
 catch (  GenericEntityException ee) {
    throw new RecurrenceRuleException(ee.getMessage(),ee);
  }
catch (  RecurrenceRuleException re) {
    throw re;
  }
}
