{
  if (!loaded) {
    loaded=true;
  }
 else {
    throw new AlreadyLoadedException("Components already loaded, cannot start");
  }
  List<ComponentLoaderConfig.ComponentDef> components=ComponentLoaderConfig.getRootComponents(loaderConfig);
  String parentPath;
  try {
    parentPath=FileUtil.getFile(System.getProperty("ofbiz.home")).getCanonicalFile().toString().replaceAll("\\\\","/");
  }
 catch (  MalformedURLException e) {
    throw new ComponentException(e.getMessage(),e);
  }
catch (  IOException e) {
    throw new ComponentException(e.getMessage(),e);
  }
  if (components != null) {
    for (    ComponentLoaderConfig.ComponentDef def : components) {
      this.loadComponentFromConfig(parentPath,def);
    }
  }
  if (updateClasspath) {
    if (UtilValidate.isNotEmpty(instrumenterFile) && UtilValidate.isNotEmpty(instrumenterClassName)) {
      classPath.instrument(instrumenterFile,instrumenterClassName);
    }
    System.setProperty("java.class.path",classPath.toString());
    System.setProperty("java.library.path",libraryPath.toString());
    ClassLoader cl=classPath.getClassLoader();
    Thread.currentThread().setContextClassLoader(cl);
  }
  Debug.logInfo("All components loaded",module);
}
