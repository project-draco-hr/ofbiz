{
  LocalDispatcher dispatcher=(LocalDispatcher)config.getServletContext().getAttribute("dispatcher");
  if (dispatcher == null) {
    GenericDelegator delegator=getDelegator();
    if (delegator == null) {
      Debug.logError("[ContextFilter.init] ERROR: delegator not defined.",module);
      return null;
    }
    Collection readers=null;
    String readerFiles=config.getServletContext().getInitParameter("serviceReaderUrls");
    if (readerFiles != null) {
      readers=new ArrayList();
      List readerList=StringUtil.split(readerFiles,";");
      Iterator i=readerList.iterator();
      while (i.hasNext()) {
        try {
          String name=(String)i.next();
          URL readerURL=config.getServletContext().getResource(name);
          if (readerURL != null)           readers.add(readerURL);
        }
 catch (        NullPointerException npe) {
          Debug.logInfo(npe,"[ContextFilter.init] ERROR: Null pointer exception thrown.",module);
        }
catch (        MalformedURLException e) {
          Debug.logError(e,"[ContextFilter.init] ERROR: cannot get URL from String.",module);
        }
      }
    }
    String dispatcherName=config.getServletContext().getInitParameter("localDispatcherName");
    if (dispatcherName == null)     Debug.logError("No localDispatcherName specified in the web.xml file",module);
    dispatcher=new WebAppDispatcher(dispatcherName,delegator,readers);
    config.getServletContext().setAttribute("dispatcher",dispatcher);
    if (dispatcher == null)     Debug.logError("[ContextFilter.init] ERROR: dispatcher could not be initialized.",module);
  }
  return dispatcher;
}
