{
  Debug.logError(msg + ": " + e,module);
  try {
    Writer writer=new StringWriter();
    ScreenRenderer screens=new ScreenRenderer(writer,null,new HtmlScreenRenderer());
    screens.populateContextForRequest(request,response,servletContext);
    screens.getContext().put("errorMessage",e.toString());
    screens.render(DEFAULT_ERROR_TEMPLATE);
    response.setContentType("text/html");
    response.getOutputStream().write(writer.toString().getBytes());
    writer.close();
  }
 catch (  Exception x) {
    Debug.logError("Multiple errors rendering FOP",module);
  }
  return new ViewHandlerException(msg,e);
}
