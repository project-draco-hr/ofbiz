{
  Map commEventMap=FastMap.newInstance();
  commEventMap.put("communicationEventId",communicationEventId);
  commEventMap.put("contentTypeId","DOCUMENT");
  commEventMap.put("mimeTypeId","text/html");
  commEventMap.put("userLogin",userLogin);
  String subject=message.getSubject();
  if (subject != null && subject.length() > 80) {
    subject=subject.substring(0,80);
  }
  currentIndex="";
  attachmentCount=0;
  return addMultipartAttachementToComm((Multipart)message.getContent(),commEventMap,subject,dispatcher,userLogin);
}
