{
  if (!enabled) {
    Debug.logInfo("Entity ECA [" + this.entityName + "] on ["+ this.eventName+ "] is disabled; not running.",module);
    return;
  }
  if (isError && !this.runOnError) {
    return;
  }
  if (!"any".equals(this.operationName) && this.operationName.indexOf(currentOperation) == -1) {
    return;
  }
  Map context=FastMap.newInstance();
  context.putAll(value);
  boolean allCondTrue=true;
  Iterator c=conditions.iterator();
  while (c.hasNext()) {
    EntityEcaCondition ec=(EntityEcaCondition)c.next();
    if (!ec.eval(dctx,value)) {
      allCondTrue=false;
      break;
    }
  }
  if (allCondTrue) {
    Iterator actionsAndSetIter=actionsAndSets.iterator();
    while (actionsAndSetIter.hasNext()) {
      Object actionOrSet=actionsAndSetIter.next();
      if (actionOrSet instanceof EntityEcaAction) {
        EntityEcaAction ea=(EntityEcaAction)actionOrSet;
        if (!actionsRun.contains(ea.serviceName)) {
          if (Debug.infoOn())           Debug.logInfo("Running Entity ECA Service: " + ea.serviceName + ", triggered by rule on Entity: "+ value.getEntityName(),module);
          ea.runAction(dctx,context,value);
          actionsRun.add(ea.serviceName);
        }
      }
 else {
        EntityEcaSetField sf=(EntityEcaSetField)actionOrSet;
        sf.eval(context);
      }
    }
  }
}
