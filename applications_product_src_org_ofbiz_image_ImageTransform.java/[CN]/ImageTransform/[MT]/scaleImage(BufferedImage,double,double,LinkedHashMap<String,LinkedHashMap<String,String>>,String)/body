{
  BufferedImage bufNewImg;
  double defaultHeight, defaultWidth, scaleFactor;
  FastMap result=new FastMap();
  defaultHeight=Double.parseDouble(dimensionMap.get(sizeType).get("height").toString());
  defaultWidth=Double.parseDouble(dimensionMap.get(sizeType).get("width").toString());
  if (defaultHeight == 0.0 || defaultWidth == 0.0) {
    String errMsg="Any default dimension is null : defaultHeight = " + defaultHeight + " ; defaultWidth = "+ defaultWidth+ ";";
    Debug.logError(errMsg,module);
    result.put("errorMessage",errMsg);
    return result;
  }
  if (imgHeight > imgWidth) {
    scaleFactor=defaultHeight / imgHeight;
    if (scaleFactor == 0.0) {
      String errMsg="Height scaleFactor is null (defaultHeight = " + defaultHeight + "; imgHeight = "+ imgHeight+ ";";
      Debug.logError(errMsg,module);
      result.put("errorMessage",errMsg);
      return result;
    }
    if (defaultWidth < (imgWidth * scaleFactor)) {
      scaleFactor=defaultWidth / imgWidth;
    }
  }
 else {
    scaleFactor=defaultWidth / imgWidth;
    if (scaleFactor == 0.0) {
      String errMsg="Width scaleFactor is null (defaultWidth = " + defaultWidth + "; imgWidth = "+ imgWidth+ ";";
      Debug.logError(errMsg,module);
      result.put("errorMessage",errMsg);
      return result;
    }
    if (defaultHeight < (imgHeight * scaleFactor)) {
      scaleFactor=defaultHeight / imgHeight;
    }
  }
  if (scaleFactor == 0.0) {
    String errMsg="Final scaleFactor is null = " + scaleFactor + ";";
    Debug.logError(errMsg,module);
    result.put("errorMessage",errMsg);
    return result;
  }
  bufNewImg=new BufferedImage((int)(imgWidth * scaleFactor),(int)(imgHeight * scaleFactor),bufImg.getType());
  result.put("responseMessage","success");
  result.put("bufferedImage",bufNewImg);
  result.put("scaleFactor",scaleFactor);
  return result;
}
