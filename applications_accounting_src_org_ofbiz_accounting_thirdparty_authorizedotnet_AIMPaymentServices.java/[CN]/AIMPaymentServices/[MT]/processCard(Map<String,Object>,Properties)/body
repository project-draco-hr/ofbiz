{
  Map<String,Object> result=FastMap.newInstance();
  String url=props.getProperty("url");
  if (url == null || url.length() == 0) {
    return ServiceUtil.returnFailure("No payment.authorizedotnet.url found.");
  }
  if (isTestMode()) {
    Debug.logInfo("TEST Authorize.net using url [" + url + "]",module);
    Debug.logInfo("TEST Authorize.net request string " + request.toString(),module);
    Debug.logInfo("TEST Authorize.net properties string " + props.toString(),module);
  }
  try {
    HttpClient httpClient=new HttpClient(url,request);
    String certificateAlias=props.getProperty("certificateAlias");
    httpClient.setClientCertificateAlias(certificateAlias);
    String httpResponse=httpClient.post();
    Debug.logInfo("transaction response: " + httpResponse,module);
    AuthorizeResponse ar=new AuthorizeResponse(httpResponse);
    String resp=ar.getResponseCode();
    if (resp.equals(AuthorizeResponse.APPROVED)) {
      result.put("authResult",Boolean.TRUE);
    }
 else {
      result.put("authResult",Boolean.FALSE);
      Debug.logInfo("responseCode:   " + ar.getResponseField(AuthorizeResponse.RESPONSE_CODE),module);
      Debug.logInfo("responseReason: " + ar.getResponseField(AuthorizeResponse.RESPONSE_REASON_CODE),module);
      Debug.logInfo("reasonText:     " + ar.getResponseField(AuthorizeResponse.RESPONSE_REASON_TEXT),module);
    }
    result.put("httpResponse",httpResponse);
    result.put("authorizeResponse",ar);
  }
 catch (  HttpClientException e) {
    Debug.logInfo("Could not complete Authorize.Net transaction: " + e.toString(),module);
  }
  result.put(ModelService.RESPONSE_MESSAGE,ModelService.RESPOND_SUCCESS);
  return result;
}
