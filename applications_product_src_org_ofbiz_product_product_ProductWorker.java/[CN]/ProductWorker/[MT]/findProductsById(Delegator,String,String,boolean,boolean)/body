{
  if (Debug.verboseOn())   Debug.logVerbose("Analyze goodIdentification: entered id = " + idToFind + ", goodIdentificationTypeId = "+ goodIdentificationTypeId,module);
  GenericValue product=null;
  List<GenericValue> productsFound=null;
  if (searchProductFirst) {
    product=delegator.findOne("Product",UtilMisc.toMap("productId",idToFind),true);
  }
  if (searchAllId || (searchProductFirst && UtilValidate.isEmpty(product))) {
    Map<String,String> conditions=UtilMisc.toMap("idValue",idToFind);
    if (UtilValidate.isNotEmpty(goodIdentificationTypeId)) {
      conditions.put("goodIdentificationTypeId",goodIdentificationTypeId);
    }
    productsFound=delegator.findByAndCache("GoodIdentificationAndProduct",conditions,UtilMisc.toList("productId"));
  }
  if (!searchProductFirst) {
    product=delegator.findOne("Product",UtilMisc.toMap("productId",idToFind),true);
  }
  if (UtilValidate.isNotEmpty(product)) {
    if (UtilValidate.isNotEmpty(productsFound))     productsFound.add(product);
 else     productsFound=UtilMisc.toList(product);
  }
  if (Debug.verboseOn())   Debug.logVerbose("Analyze goodIdentification: found product.productId = " + product + ", and list : "+ productsFound,module);
  return productsFound;
}
