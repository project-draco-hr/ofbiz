{
  GenericValue product=delegator.findByPrimaryKeyCache("Product",UtilMisc.toMap("productId",idToFind));
  String productId=null;
  if (product == null) {
    Map goodIdLookup=UtilMisc.toMap("idValue",idToFind);
    if (UtilValidate.isNotEmpty(goodIdentificationTypeId)) {
      goodIdLookup.put("goodIdentificationTypeId",goodIdentificationTypeId);
    }
    List goodIds=delegator.findByAndCache("GoodIdentification",goodIdLookup,UtilMisc.toList("-createdStamp"));
    GenericValue lastGoodId=EntityUtil.getFirst(goodIds);
    if (lastGoodId != null) {
      productId=lastGoodId.getString("productId");
    }
  }
 else {
    productId=product.getString("productId");
  }
  if (productId != null) {
    return productId;
  }
 else {
    return null;
  }
}
