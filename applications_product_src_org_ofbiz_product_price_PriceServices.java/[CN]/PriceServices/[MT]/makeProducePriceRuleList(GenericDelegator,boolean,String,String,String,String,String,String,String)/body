{
  List productPriceRules=null;
  if (optimizeForLargeRuleSet) {
    TreeSet productPriceRuleIds=new TreeSet();
    Collection productCategoryIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PROD_CAT_ID"));
    if (UtilValidate.isNotEmpty(productCategoryIdConds)) {
      Iterator productCategoryIdCondsIter=productCategoryIdConds.iterator();
      while (productCategoryIdCondsIter.hasNext()) {
        GenericValue productCategoryIdCond=(GenericValue)productCategoryIdCondsIter.next();
        productPriceRuleIds.add(productCategoryIdCond.getString("productPriceRuleId"));
      }
    }
    Collection productFeatureIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PROD_FEAT_ID"));
    if (UtilValidate.isNotEmpty(productFeatureIdConds)) {
      Iterator productFeatureIdCondsIter=productFeatureIdConds.iterator();
      while (productFeatureIdCondsIter.hasNext()) {
        GenericValue productFeatureIdCond=(GenericValue)productFeatureIdCondsIter.next();
        productPriceRuleIds.add(productFeatureIdCond.getString("productPriceRuleId"));
      }
    }
    Collection quantityConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_QUANTITY"));
    if (UtilValidate.isNotEmpty(quantityConds)) {
      Iterator quantityCondsIter=quantityConds.iterator();
      while (quantityCondsIter.hasNext()) {
        GenericValue quantityCond=(GenericValue)quantityCondsIter.next();
        productPriceRuleIds.add(quantityCond.getString("productPriceRuleId"));
      }
    }
    Collection roleTypeIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_ROLE_TYPE"));
    if (UtilValidate.isNotEmpty(roleTypeIdConds)) {
      Iterator roleTypeIdCondsIter=roleTypeIdConds.iterator();
      while (roleTypeIdCondsIter.hasNext()) {
        GenericValue roleTypeIdCond=(GenericValue)roleTypeIdCondsIter.next();
        productPriceRuleIds.add(roleTypeIdCond.getString("productPriceRuleId"));
      }
    }
    Collection listPriceConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_LIST_PRICE"));
    if (UtilValidate.isNotEmpty(listPriceConds)) {
      Iterator listPriceCondsIter=listPriceConds.iterator();
      while (listPriceCondsIter.hasNext()) {
        GenericValue listPriceCond=(GenericValue)listPriceCondsIter.next();
        productPriceRuleIds.add(listPriceCond.getString("productPriceRuleId"));
      }
    }
    Collection productIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PRODUCT_ID","condValue",productId));
    if (UtilValidate.isNotEmpty(productIdConds)) {
      Iterator productIdCondsIter=productIdConds.iterator();
      while (productIdCondsIter.hasNext()) {
        GenericValue productIdCond=(GenericValue)productIdCondsIter.next();
        productPriceRuleIds.add(productIdCond.getString("productPriceRuleId"));
      }
    }
    if (virtualProductId != null) {
      Collection virtualProductIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PRODUCT_ID","condValue",virtualProductId));
      if (UtilValidate.isNotEmpty(virtualProductIdConds)) {
        Iterator virtualProductIdCondsIter=virtualProductIdConds.iterator();
        while (virtualProductIdCondsIter.hasNext()) {
          GenericValue virtualProductIdCond=(GenericValue)virtualProductIdCondsIter.next();
          productPriceRuleIds.add(virtualProductIdCond.getString("productPriceRuleId"));
        }
      }
    }
    if (UtilValidate.isNotEmpty(prodCatalogId)) {
      Collection prodCatalogIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PROD_CLG_ID","condValue",prodCatalogId));
      if (UtilValidate.isNotEmpty(prodCatalogIdConds)) {
        Iterator prodCatalogIdCondsIter=prodCatalogIdConds.iterator();
        while (prodCatalogIdCondsIter.hasNext()) {
          GenericValue prodCatalogIdCond=(GenericValue)prodCatalogIdCondsIter.next();
          productPriceRuleIds.add(prodCatalogIdCond.getString("productPriceRuleId"));
        }
      }
    }
    if (UtilValidate.isNotEmpty(productStoreGroupId)) {
      Collection storeGroupConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PROD_SGRP_ID","condValue",productStoreGroupId));
      if (UtilValidate.isNotEmpty(storeGroupConds)) {
        Iterator storeGroupCondsIter=storeGroupConds.iterator();
        while (storeGroupCondsIter.hasNext()) {
          GenericValue storeGroupCond=(GenericValue)storeGroupCondsIter.next();
          productPriceRuleIds.add(storeGroupCond.getString("productPriceRuleId"));
        }
      }
    }
    if (UtilValidate.isNotEmpty(webSiteId)) {
      Collection webSiteIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_WEBSITE_ID","condValue",webSiteId));
      if (UtilValidate.isNotEmpty(webSiteIdConds)) {
        Iterator webSiteIdCondsIter=webSiteIdConds.iterator();
        while (webSiteIdCondsIter.hasNext()) {
          GenericValue webSiteIdCond=(GenericValue)webSiteIdCondsIter.next();
          productPriceRuleIds.add(webSiteIdCond.getString("productPriceRuleId"));
        }
      }
    }
    if (UtilValidate.isNotEmpty(partyId)) {
      Collection partyIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PARTY_ID","condValue",partyId));
      if (UtilValidate.isNotEmpty(partyIdConds)) {
        Iterator partyIdCondsIter=partyIdConds.iterator();
        while (partyIdCondsIter.hasNext()) {
          GenericValue partyIdCond=(GenericValue)partyIdCondsIter.next();
          productPriceRuleIds.add(partyIdCond.getString("productPriceRuleId"));
        }
      }
    }
    Collection currencyUomIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_CURRENCY_UOMID","condValue",currencyUomId));
    if (UtilValidate.isNotEmpty(currencyUomIdConds)) {
      Iterator currencyUomIdCondsIter=currencyUomIdConds.iterator();
      while (currencyUomIdCondsIter.hasNext()) {
        GenericValue currencyUomIdCond=(GenericValue)currencyUomIdCondsIter.next();
        productPriceRuleIds.add(currencyUomIdCond.getString("productPriceRuleId"));
      }
    }
    productPriceRules=FastList.newInstance();
    Iterator productPriceRuleIdsIter=productPriceRuleIds.iterator();
    while (productPriceRuleIdsIter.hasNext()) {
      String productPriceRuleId=(String)productPriceRuleIdsIter.next();
      GenericValue productPriceRule=delegator.findByPrimaryKeyCache("ProductPriceRule",UtilMisc.toMap("productPriceRuleId",productPriceRuleId));
      if (productPriceRule == null)       continue;
      productPriceRules.add(productPriceRule);
    }
  }
 else {
    productPriceRules=delegator.findList("ProductPriceRule",null,null,null,null,true);
    if (productPriceRules == null)     productPriceRules=new LinkedList();
  }
  return productPriceRules;
}
