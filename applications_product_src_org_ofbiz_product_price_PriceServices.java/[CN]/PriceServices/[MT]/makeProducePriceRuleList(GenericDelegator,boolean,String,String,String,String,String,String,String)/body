{
  List<GenericValue> productPriceRules=null;
  if (optimizeForLargeRuleSet) {
    TreeSet<String> productPriceRuleIds=new TreeSet<String>();
    Collection<GenericValue> productCategoryIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PROD_CAT_ID"));
    if (UtilValidate.isNotEmpty(productCategoryIdConds)) {
      for (      GenericValue productCategoryIdCond : productCategoryIdConds) {
        productPriceRuleIds.add(productCategoryIdCond.getString("productPriceRuleId"));
      }
    }
    Collection<GenericValue> productFeatureIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PROD_FEAT_ID"));
    if (UtilValidate.isNotEmpty(productFeatureIdConds)) {
      for (      GenericValue productFeatureIdCond : productFeatureIdConds) {
        productPriceRuleIds.add(productFeatureIdCond.getString("productPriceRuleId"));
      }
    }
    Collection<GenericValue> quantityConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_QUANTITY"));
    if (UtilValidate.isNotEmpty(quantityConds)) {
      for (      GenericValue quantityCond : quantityConds) {
        productPriceRuleIds.add(quantityCond.getString("productPriceRuleId"));
      }
    }
    Collection<GenericValue> roleTypeIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_ROLE_TYPE"));
    if (UtilValidate.isNotEmpty(roleTypeIdConds)) {
      for (      GenericValue roleTypeIdCond : roleTypeIdConds) {
        productPriceRuleIds.add(roleTypeIdCond.getString("productPriceRuleId"));
      }
    }
    Collection<GenericValue> listPriceConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_LIST_PRICE"));
    if (UtilValidate.isNotEmpty(listPriceConds)) {
      for (      GenericValue listPriceCond : listPriceConds) {
        productPriceRuleIds.add(listPriceCond.getString("productPriceRuleId"));
      }
    }
    Collection<GenericValue> productIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PRODUCT_ID","condValue",productId));
    if (UtilValidate.isNotEmpty(productIdConds)) {
      for (      GenericValue productIdCond : productIdConds) {
        productPriceRuleIds.add(productIdCond.getString("productPriceRuleId"));
      }
    }
    if (virtualProductId != null) {
      Collection<GenericValue> virtualProductIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PRODUCT_ID","condValue",virtualProductId));
      if (UtilValidate.isNotEmpty(virtualProductIdConds)) {
        for (        GenericValue virtualProductIdCond : virtualProductIdConds) {
          productPriceRuleIds.add(virtualProductIdCond.getString("productPriceRuleId"));
        }
      }
    }
    if (UtilValidate.isNotEmpty(prodCatalogId)) {
      Collection<GenericValue> prodCatalogIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PROD_CLG_ID","condValue",prodCatalogId));
      if (UtilValidate.isNotEmpty(prodCatalogIdConds)) {
        for (        GenericValue prodCatalogIdCond : prodCatalogIdConds) {
          productPriceRuleIds.add(prodCatalogIdCond.getString("productPriceRuleId"));
        }
      }
    }
    if (UtilValidate.isNotEmpty(productStoreGroupId)) {
      Collection<GenericValue> storeGroupConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PROD_SGRP_ID","condValue",productStoreGroupId));
      if (UtilValidate.isNotEmpty(storeGroupConds)) {
        for (        GenericValue storeGroupCond : storeGroupConds) {
          productPriceRuleIds.add(storeGroupCond.getString("productPriceRuleId"));
        }
      }
    }
    if (UtilValidate.isNotEmpty(webSiteId)) {
      Collection<GenericValue> webSiteIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_WEBSITE_ID","condValue",webSiteId));
      if (UtilValidate.isNotEmpty(webSiteIdConds)) {
        for (        GenericValue webSiteIdCond : webSiteIdConds) {
          productPriceRuleIds.add(webSiteIdCond.getString("productPriceRuleId"));
        }
      }
    }
    if (UtilValidate.isNotEmpty(partyId)) {
      Collection<GenericValue> partyIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_PARTY_ID","condValue",partyId));
      if (UtilValidate.isNotEmpty(partyIdConds)) {
        for (        GenericValue partyIdCond : partyIdConds) {
          productPriceRuleIds.add(partyIdCond.getString("productPriceRuleId"));
        }
      }
    }
    Collection<GenericValue> currencyUomIdConds=delegator.findByAndCache("ProductPriceCond",UtilMisc.toMap("inputParamEnumId","PRIP_CURRENCY_UOMID","condValue",currencyUomId));
    if (UtilValidate.isNotEmpty(currencyUomIdConds)) {
      for (      GenericValue currencyUomIdCond : currencyUomIdConds) {
        productPriceRuleIds.add(currencyUomIdCond.getString("productPriceRuleId"));
      }
    }
    productPriceRules=FastList.newInstance();
    for (    String productPriceRuleId : productPriceRuleIds) {
      GenericValue productPriceRule=delegator.findByPrimaryKeyCache("ProductPriceRule",UtilMisc.toMap("productPriceRuleId",productPriceRuleId));
      if (productPriceRule == null)       continue;
      productPriceRules.add(productPriceRule);
    }
  }
 else {
    productPriceRules=delegator.findList("ProductPriceRule",null,null,null,null,true);
    if (productPriceRules == null)     productPriceRules=FastList.newInstance();
  }
  return productPriceRules;
}
