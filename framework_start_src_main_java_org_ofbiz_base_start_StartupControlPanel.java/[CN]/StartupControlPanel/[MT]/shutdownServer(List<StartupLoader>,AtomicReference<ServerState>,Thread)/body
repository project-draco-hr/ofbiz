{
  ServerState currentState;
  do {
    currentState=serverState.get();
    if (currentState == ServerState.STOPPING) {
      return;
    }
  }
 while (!serverState.compareAndSet(currentState,ServerState.STOPPING));
synchronized (loaders) {
    for (int i=loaders.size(); i > 0; i--) {
      StartupLoader loader=loaders.get(i - 1);
      try {
        loader.unload();
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
  }
  if (adminServer != null && adminServer.isAlive()) {
    adminServer.interrupt();
  }
}
