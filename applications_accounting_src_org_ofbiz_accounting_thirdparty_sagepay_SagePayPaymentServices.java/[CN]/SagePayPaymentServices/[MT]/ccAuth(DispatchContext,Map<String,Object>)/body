{
  Debug.logInfo("SagePay - Entered ccAuth",module);
  Debug.logInfo("SagePay ccAuth context : " + context,module);
  Map<String,Object> response=null;
  String orderId=(String)context.get("orderId");
  GenericValue orderPaymentPreference=(GenericValue)context.get("orderPaymentPreference");
  if (null == orderPaymentPreference) {
    response=ServiceUtil.returnError("OrderPaymentPreference for order : " + orderId + " is null : "+ orderPaymentPreference);
  }
 else {
    response=processCardAuthorisationPayment(dctx,context);
  }
  Debug.logInfo("SagePay ccAuth response : " + response,module);
  Debug.logInfo("SagePay - Exiting ccAuth",module);
  return response;
}
