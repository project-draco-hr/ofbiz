{
  if (request == null) {
    throw new ViewHandlerException("The HttpServletRequest object was null, how did that happen?");
  }
  if (page == null || page.length() == 0) {
    throw new ViewHandlerException("View page was null or empty, but must be specified");
  }
  if (info == null || info.length() == 0) {
    Debug.logWarning("View info string was null or empty, but must be used to specify an Entity that is mapped to the Entity Engine datasource that the report will use.",module);
  }
  request.setAttribute(ContextFilter.FORWARDED_FROM_SERVLET,new Boolean(true));
  GenericDelegator delegator=(GenericDelegator)request.getAttribute("delegator");
  if (delegator == null) {
    throw new ViewHandlerException("The delegator object was null, how did that happen?");
  }
  try {
    String datasourceName=delegator.getEntityHelperName(info);
    InputStream is=context.getResourceAsStream(page);
    Map parameters=UtilHttp.getParameterMap(request);
    JasperReport report=JasperCompileManager.compileReport(is);
    response.setContentType("text/xml");
    PipedOutputStream fillToPrintOutputStream=new PipedOutputStream();
    PipedInputStream fillToPrintInputStream=new PipedInputStream(fillToPrintOutputStream);
    if (datasourceName != null && datasourceName.length() > 0) {
      JasperFillManager.fillReportToStream(report,fillToPrintOutputStream,parameters,ConnectionFactory.getConnection(datasourceName));
    }
 else {
      JasperFillManager.fillReportToStream(report,fillToPrintOutputStream,parameters,new JREmptyDataSource());
    }
    JasperExportManager.exportReportToXmlStream(fillToPrintInputStream,response.getOutputStream());
  }
 catch (  IOException ie) {
    throw new ViewHandlerException("IO Error in region",ie);
  }
catch (  java.sql.SQLException e) {
    throw new ViewHandlerException("Database error while running report",e);
  }
catch (  Exception e) {
    throw new ViewHandlerException("Error in report",e);
  }
}
