{
  Element avResponseElement=rateResponseDocument.getDocumentElement();
  Element responseElement=UtilXml.firstChildElement(avResponseElement,"Response");
  String responseStatusCode=UtilXml.childElementValue(responseElement,"ResponseStatusCode");
  List errorList=new LinkedList();
  UpsServices.handleErrors(responseElement,errorList);
  if ("1".equals(responseStatusCode)) {
    List matches=new LinkedList();
    List avResultList=UtilXml.childElementList(avResponseElement,"AddressValidationResult");
    if (UtilValidate.isNotEmpty(avResultList)) {
      Iterator i=avResultList.iterator();
      while (i.hasNext()) {
        Element avResultElement=(Element)i.next();
        Map match=new HashMap();
        match.put("Rank",UtilXml.childElementValue(avResultElement,"Rank"));
        match.put("Quality",UtilXml.childElementValue(avResultElement,"Quality"));
        Element addressElement=UtilXml.firstChildElement(avResultElement,"Address");
        match.put("City",UtilXml.childElementValue(addressElement,"City"));
        match.put("StateProvinceCode",UtilXml.childElementValue(addressElement,"StateProvinceCode"));
        match.put("PostalCodeLowEnd",UtilXml.childElementValue(avResultElement,"PostalCodeLowEnd"));
        match.put("PostalCodeHighEnd",UtilXml.childElementValue(avResultElement,"PostalCodeHighEnd"));
        matches.add(match);
      }
    }
    Map result=ServiceUtil.returnSuccess();
    result.put("matches",matches);
    return result;
  }
 else {
    errorList.add("Error status code : " + responseStatusCode);
    return ServiceUtil.returnError(errorList);
  }
}
