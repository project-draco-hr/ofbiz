{
  if (UtilValidate.isEmpty(cart.getShippingContactMechId()) && cart.getBillingAddress() == null && shipAddress == null) {
    return;
  }
  int shipGroups=this.cart.getShipGroupSize();
  for (int i=0; i < shipGroups; i++) {
    Map shoppingCartItemIndexMap=new HashMap();
    Map serviceContext=this.makeTaxContext(i,shipAddress,shoppingCartItemIndexMap);
    List taxReturn=this.getTaxAdjustments(dispatcher,"calcTax",serviceContext);
    if (Debug.verboseOn())     Debug.logVerbose("ReturnList: " + taxReturn,module);
    ShoppingCart.CartShipInfo csi=cart.getShipInfo(i);
    List orderAdj=(List)taxReturn.get(0);
    List itemAdj=(List)taxReturn.get(1);
    if (itemAdj != null) {
      for (int x=0; x < itemAdj.size(); x++) {
        List adjs=(List)itemAdj.get(x);
        ShoppingCartItem item=(ShoppingCartItem)shoppingCartItemIndexMap.get(Integer.valueOf(x));
        if (adjs == null) {
          adjs=new LinkedList();
        }
        csi.setItemInfo(item,adjs);
        if (Debug.verboseOn())         Debug.logVerbose("Added item adjustments to ship group [" + i + " / "+ x+ "] - "+ adjs,module);
      }
    }
    csi.shipTaxAdj.clear();
    csi.shipTaxAdj.addAll(orderAdj);
  }
}
