{
  GenericValue userLogin=(GenericValue)context.get("userLogin");
  Security security=dctx.getSecurity();
  if (!security.hasPermission("ENTITY_MAINT",userLogin)) {
    return ServiceUtil.returnError(UtilProperties.getMessage("WebtoolsUiLabels","WebtoolsPermissionError",(Locale)context.get("locale")));
  }
  GenericDelegator delegator=dctx.getDelegator();
  URL url=(URL)context.get("url");
  String xmltext=(String)context.get("xmltext");
  if (url == null && xmltext == null) {
    return ServiceUtil.returnError("No entity xml file or text specified");
  }
  boolean mostlyInserts=(String)context.get("mostlyInserts") != null;
  boolean maintainTimeStamps=(String)context.get("maintainTimeStamps") != null;
  boolean createDummyFks=(String)context.get("createDummyFks") != null;
  Integer txTimeout=(Integer)context.get("txTimeout");
  if (txTimeout == null) {
    txTimeout=new Integer(7200);
  }
  Long rowProcessed=new Long(0);
  try {
    EntitySaxReader reader=new EntitySaxReader(delegator);
    reader.setUseTryInsertMethod(mostlyInserts);
    reader.setMaintainTxStamps(maintainTimeStamps);
    reader.setTransactionTimeout(txTimeout.intValue());
    reader.setCreateDummyFks(createDummyFks);
    long numberRead=(url != null ? reader.parse(url) : reader.parse(xmltext));
    rowProcessed=new Long(numberRead);
  }
 catch (  Exception ex) {
    return ServiceUtil.returnError("Error parsing entity xml file: " + ex.toString());
  }
  Map resp=UtilMisc.toMap("rowProcessed",rowProcessed);
  return resp;
}
