{
  List<EntityCondition> allConditions=FastList.newInstance();
  if (facilityId != null) {
    allConditions.add(EntityCondition.makeCondition("originFacilityId",EntityOperator.EQUALS,facilityId));
  }
  if (filterDate != null) {
    List<EntityCondition> andExprs=FastList.newInstance();
    andExprs.add(EntityCondition.makeCondition("orderDate",EntityOperator.GREATER_THAN_EQUAL_TO,UtilDateTime.getDayStart(filterDate)));
    andExprs.add(EntityCondition.makeCondition("orderDate",EntityOperator.LESS_THAN_EQUAL_TO,UtilDateTime.getDayEnd(filterDate)));
    allConditions.add(EntityCondition.makeCondition(andExprs,EntityOperator.AND));
  }
  List<EntityCondition> statusConditions=FastList.newInstance();
  for (  String status : orderStatusState.keySet()) {
    if (!hasStatus(status))     continue;
    statusConditions.add(EntityCondition.makeCondition("statusId",EntityOperator.EQUALS,parameterToOrderStatusId.get(status)));
  }
  List<EntityCondition> typeConditions=FastList.newInstance();
  for (  String type : orderTypeState.keySet()) {
    if (!hasType(type))     continue;
    typeConditions.add(EntityCondition.makeCondition("orderTypeId",EntityOperator.EQUALS,parameterToOrderTypeId.get(type)));
  }
  EntityCondition statusConditionsList=EntityCondition.makeCondition(statusConditions,EntityOperator.OR);
  EntityCondition typeConditionsList=EntityCondition.makeCondition(typeConditions,EntityOperator.OR);
  if (statusConditions.size() > 0) {
    allConditions.add(statusConditionsList);
  }
  if (typeConditions.size() > 0) {
    allConditions.add(typeConditionsList);
  }
  EntityCondition queryConditionsList=EntityCondition.makeCondition(allConditions,EntityOperator.AND);
  EntityFindOptions options=new EntityFindOptions(true,EntityFindOptions.TYPE_SCROLL_INSENSITIVE,EntityFindOptions.CONCUR_READ_ONLY,true);
  options.setMaxRows(viewSize * (viewIndex + 1));
  EntityListIterator iterator=delegator.find("OrderHeader",queryConditionsList,null,null,UtilMisc.toList("orderDate DESC"),options);
  List<GenericValue> orders=iterator.getPartialList(viewSize * viewIndex,viewSize);
  orderListSize=iterator.getResultsSizeAfterPartialList();
  iterator.close();
  return orders;
}
