{
  HttpSession session=request.getSession();
  String externalKey=request.getParameter(LoginWorker.EXTERNAL_LOGIN_KEY_ATTR);
  if (externalKey == null)   return "success";
  GenericValue userLogin=(GenericValue)LoginWorker.externalLoginKeys.get(externalKey);
  if (userLogin != null) {
    GenericValue currentUserLogin=(GenericValue)session.getAttribute("userLogin");
    if (currentUserLogin != null) {
      if (currentUserLogin.getString("userLoginId").equals(userLogin.getString("userLoginId"))) {
        return "success";
      }
      logout(request,response);
    }
    doBasicLogin(userLogin,request);
  }
 else {
    Debug.logWarning("Could not find userLogin for external login key: " + externalKey,module);
  }
  return "success";
}
