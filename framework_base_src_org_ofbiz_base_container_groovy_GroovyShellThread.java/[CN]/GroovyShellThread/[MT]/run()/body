{
  PrintStream out=null;
  InputStream in=null;
  try {
    in=socket.getInputStream();
    out=new PrintStream(socket.getOutputStream());
    binding.setVariable("out",out);
    final IO io=new IO(in,out,out);
    final Groovysh gsh=new Groovysh(binding,io);
    gsh.run();
  }
 catch (  Exception e) {
    log.error("Error running the Groovy shell.",e);
  }
 finally {
    try {
      if (out != null)       out.close();
    }
 catch (    Exception e) {
    }
    try {
      if (in != null)       in.close();
    }
 catch (    Exception e) {
    }
    try {
      if (socket != null)       socket.close();
    }
 catch (    Exception e) {
    }
  }
}
