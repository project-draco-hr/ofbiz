{
  Boolean userIsAllowed=false;
  if (UtilValidate.isNotEmpty(portalPageId)) {
    GenericValue userLogin=(GenericValue)context.get("userLogin");
    if (UtilValidate.isNotEmpty(userLogin)) {
      String userLoginId=(String)userLogin.get("userLoginId");
      Authorization authz=(Authorization)context.get("authz");
      Boolean hasPortalAdminPermission=authz.hasPermission(userLoginId,"PORTALPAGE_ADMIN",context);
      try {
        Delegator delegator=WidgetWorker.getDelegator(context);
        GenericValue portalPage=delegator.findOne("PortalPage",UtilMisc.toMap("portalPageId",portalPageId),false);
        if (UtilValidate.isNotEmpty(portalPage)) {
          String ownerUserLoginId=(String)portalPage.get("ownerUserLoginId");
          userIsAllowed=(ownerUserLoginId.equals(userLoginId) || hasPortalAdminPermission);
        }
      }
 catch (      GenericEntityException e) {
        return false;
      }
    }
  }
  return userIsAllowed;
}
