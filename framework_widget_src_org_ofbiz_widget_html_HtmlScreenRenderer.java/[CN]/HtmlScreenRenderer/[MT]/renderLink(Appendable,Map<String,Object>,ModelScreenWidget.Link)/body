{
  HttpServletResponse response=(HttpServletResponse)context.get("response");
  HttpServletRequest request=(HttpServletRequest)context.get("request");
  String targetWindow=link.getTargetWindow(context);
  String target=link.getTarget(context);
  String uniqueItemName=link.getModelScreen().getName() + "_LF_" + UtilMisc.<String>addToBigDecimalInMap(context,"screenUniqueItemIndex",BigDecimal.ONE);
  String linkType=WidgetWorker.determineAutoLinkType(link.getLinkType(),target,link.getUrlMode(),request);
  if ("hidden-form".equals(linkType)) {
    writer.append("<form method=\"post\"");
    writer.append(" action=\"");
    WidgetWorker.buildHyperlinkUrl(writer,target,link.getUrlMode(),null,link.getPrefix(context),link.getFullPath(),link.getSecure(),link.getEncode(),request,response,context);
    writer.append("\"");
    if (UtilValidate.isNotEmpty(targetWindow)) {
      writer.append(" target=\"");
      writer.append(targetWindow);
      writer.append("\"");
    }
    writer.append(" onsubmit=\"javascript:submitFormDisableSubmits(this)\"");
    writer.append(" name=\"");
    writer.append(uniqueItemName);
    writer.append("\">");
    for (    Map.Entry<String,String> parameter : link.getParameterMap(context).entrySet()) {
      writer.append("<input name=\"");
      writer.append(parameter.getKey());
      writer.append("\" value=\"");
      writer.append(parameter.getValue());
      writer.append("\" type=\"hidden\"/>");
    }
    writer.append("</form>");
  }
  writer.append("<a");
  String id=link.getId(context);
  if (UtilValidate.isNotEmpty(id)) {
    writer.append(" id=\"");
    writer.append(id);
    writer.append("\"");
  }
  String style=link.getStyle(context);
  if (UtilValidate.isNotEmpty(style)) {
    writer.append(" class=\"");
    writer.append(style);
    writer.append("\"");
  }
  String name=link.getName(context);
  if (UtilValidate.isNotEmpty(name)) {
    writer.append(" name=\"");
    writer.append(name);
    writer.append("\"");
  }
  if (UtilValidate.isNotEmpty(targetWindow)) {
    writer.append(" target=\"");
    writer.append(targetWindow);
    writer.append("\"");
  }
  if (UtilValidate.isNotEmpty(target)) {
    writer.append(" href=\"");
    if ("hidden-form".equals(linkType)) {
      writer.append("javascript:document.");
      writer.append(uniqueItemName);
      writer.append(".submit()");
    }
 else {
      WidgetWorker.buildHyperlinkUrl(writer,target,link.getUrlMode(),link.getParameterMap(context),link.getPrefix(context),link.getFullPath(),link.getSecure(),link.getEncode(),request,response,context);
    }
    writer.append("\"");
  }
  writer.append(">");
  ModelScreenWidget.Image img=link.getImage();
  if (img == null) {
    writer.append(link.getText(context));
  }
 else {
    renderImage(writer,context,img);
  }
  writer.append("</a>");
  appendWhitespace(writer);
}
