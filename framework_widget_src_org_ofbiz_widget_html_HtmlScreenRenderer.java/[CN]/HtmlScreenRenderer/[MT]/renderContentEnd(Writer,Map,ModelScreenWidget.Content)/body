{
  String expandedContentId=content.getContentId(context);
  String editMode="Edit";
  String editRequest=content.getEditRequest(context);
  String editContainerStyle=content.getEditContainerStyle(context);
  String enableEditName=content.getEnableEditName(context);
  String enableEditValue=(String)context.get(enableEditName);
  if (editRequest != null && editRequest.toUpperCase().indexOf("IMAGE") > 0) {
    editMode+=" Image";
  }
  Map params=(Map)context.get("parameters");
  if (UtilValidate.isNotEmpty(editRequest) && "true".equals(enableEditValue)) {
    String contentId=content.getContentId(context);
    HttpServletResponse response=(HttpServletResponse)context.get("response");
    HttpServletRequest request=(HttpServletRequest)context.get("request");
    if (request != null && response != null) {
      if (editRequest.indexOf("?") < 0)       editRequest+="?";
 else       editRequest+="&amp;";
      editRequest+="contentId=" + expandedContentId;
      ServletContext ctx=(ServletContext)request.getAttribute("servletContext");
      RequestHandler rh=(RequestHandler)ctx.getAttribute("_REQUEST_HANDLER_");
      String urlString=rh.makeLink(request,response,editRequest,false,false,false);
      String linkString="<a href=\"" + urlString + "\">"+ editMode+ "</a>";
      writer.write(linkString);
    }
    if (UtilValidate.isNotEmpty(editContainerStyle)) {
      writer.write("</div>");
    }
    appendWhitespace(writer);
  }
}
