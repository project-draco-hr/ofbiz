{
  if (resource == null || resource.length() <= 0) {
    return null;
  }
  if (name == null || name.length() <= 0)   return null;
  resource=resource.replace(".properties","");
  try {
    GenericValue systemProperty=EntityQuery.use(delegator).from("SystemProperty").where("systemResourceId",resource,"systemPropertyId",name).cache().queryOne();
    if (systemProperty != null) {
      String systemPropertyValue=systemProperty.getString("systemPropertyValue");
      if (UtilValidate.isNotEmpty(systemPropertyValue)) {
        return systemPropertyValue;
      }
    }
  }
 catch (  Exception e) {
    Debug.logWarning("Could not get a system property for " + name + " : "+ e.getMessage(),module);
  }
  return null;
}
