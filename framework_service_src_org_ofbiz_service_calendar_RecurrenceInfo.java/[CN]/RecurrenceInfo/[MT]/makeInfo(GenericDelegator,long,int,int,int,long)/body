{
  try {
    RecurrenceRule r=RecurrenceRule.makeRule(delegator,frequency,interval,count,endTime);
    String ruleId=r.primaryKey();
    String infoId=delegator.getNextSeqId("RecurrenceInfo");
    GenericValue value=delegator.makeValue("RecurrenceInfo",UtilMisc.toMap("recurrenceInfoId",infoId));
    value.set("recurrenceRuleId",ruleId);
    value.set("startDateTime",new java.sql.Timestamp(startTime));
    delegator.create(value);
    RecurrenceInfo newInfo=new RecurrenceInfo(value);
    return newInfo;
  }
 catch (  RecurrenceRuleException re) {
    throw new RecurrenceInfoException(re.getMessage(),re);
  }
catch (  GenericEntityException ee) {
    throw new RecurrenceInfoException(ee.getMessage(),ee);
  }
catch (  RecurrenceInfoException rie) {
    throw rie;
  }
}
