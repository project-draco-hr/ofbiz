{
  if (is == null) {
    Debug.logWarning("[UtilXml.readXmlDocument] InputStream was null, doing nothing",module);
    return null;
  }
  long startTime=System.currentTimeMillis();
  Document document=null;
  DocumentBuilderFactory factory=new org.apache.xerces.jaxp.DocumentBuilderFactoryImpl();
  factory.setValidating(validate);
  factory.setNamespaceAware(true);
  factory.setAttribute("http://xml.org/sax/features/validation",Boolean.TRUE);
  factory.setAttribute("http://apache.org/xml/features/validation/schema",Boolean.TRUE);
  DocumentBuilder builder=factory.newDocumentBuilder();
  if (validate) {
    LocalResolver lr=new LocalResolver(new DefaultHandler());
    ErrorHandler eh=new LocalErrorHandler(docDescription,lr);
    builder.setEntityResolver(lr);
    builder.setErrorHandler(eh);
  }
  document=builder.parse(is);
  double totalSeconds=(System.currentTimeMillis() - startTime) / 1000.0;
  if (Debug.timingOn())   Debug.logTiming("XML Read " + totalSeconds + "s: "+ docDescription,module);
  return document;
}
