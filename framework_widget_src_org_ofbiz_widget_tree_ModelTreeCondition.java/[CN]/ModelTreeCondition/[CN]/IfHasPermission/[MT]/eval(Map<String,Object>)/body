{
  GenericValue userLogin=(GenericValue)context.get("userLogin");
  if (userLogin != null) {
    String permission=permissionExdr.expandString(context);
    String action=actionExdr.expandString(context);
    Authorization authz=(Authorization)context.get("authorization");
    Security security=(Security)context.get("security");
    if (action != null && action.length() > 0) {
      if (security.hasEntityPermission(permission,action,userLogin)) {
        return true;
      }
    }
 else {
      if (authz.hasPermission(userLogin.getString("userLoginId"),permission,context,true)) {
        return true;
      }
    }
  }
  return false;
}
