{
  if (map == null)   return null;
  StringBuffer buf=new StringBuffer();
  Set keySet=map.keySet();
  Iterator i=keySet.iterator();
  boolean first=true;
  while (i.hasNext()) {
    Object key=i.next();
    Object value=map.get(key);
    if (!(key instanceof String) || !(value instanceof String))     continue;
    String encodedName=null;
    try {
      encodedName=URLEncoder.encode((String)key,"UTF-8");
    }
 catch (    UnsupportedEncodingException e) {
      Debug.logError(e,module);
    }
    String encodedValue=null;
    try {
      encodedValue=URLEncoder.encode((String)value,"UTF-8");
    }
 catch (    UnsupportedEncodingException e) {
      Debug.logError(e,module);
    }
    if (first)     first=false;
 else     buf.append("|");
    buf.append(encodedName);
    buf.append("=");
    buf.append(encodedValue);
  }
  return buf.toString();
}
