{
  boolean passedCondition=false;
  if (serviceName != null) {
    Map result=null;
    try {
      result=dispatcher.runSync(serviceName,UtilMisc.toMap("messageWrapper",messageWrapper,"userLogin",userLogin));
    }
 catch (    GenericServiceException e) {
      Debug.logError(e,module);
      return false;
    }
    if (result == null) {
      Debug.logError("Service MCA Condition Service [" + serviceName + "] returned null!",module);
      return false;
    }
 else {
      if (ServiceUtil.isError(result)) {
        Debug.logError(ServiceUtil.getErrorMessage(result),module);
        return false;
      }
 else {
        Boolean reply=(Boolean)result.get("conditionReply");
        if (reply == null) {
          reply=Boolean.FALSE;
        }
        return reply.booleanValue();
      }
    }
  }
 else   if (headerName != null) {
    MimeMessage message=messageWrapper.getMessage();
    String[] headerValue=null;
    try {
      headerValue=message.getHeader(headerName);
    }
 catch (    MessagingException e) {
      Debug.logError(e,module);
    }
    if (headerValue != null) {
      for (int i=0; i < headerValue.length; i++) {
        if ("equals".equals(operator)) {
          if (headerValue[i].equals(value)) {
            passedCondition=true;
            break;
          }
        }
 else         if ("not-equals".equals(operator)) {
          if (!headerValue[i].equals(value)) {
            passedCondition=true;
          }
 else {
            passedCondition=false;
          }
        }
 else         if ("matches".equals(operator)) {
          if (headerValue[i].matches(value)) {
            passedCondition=true;
            break;
          }
        }
 else         if ("not-matches".equals(operator)) {
          if (!headerValue[i].matches(value)) {
            passedCondition=true;
          }
 else {
            passedCondition=false;
          }
        }
 else         if ("not-empty".equals(operator)) {
          passedCondition=true;
          break;
        }
      }
    }
 else     if ("empty".equals(operator)) {
      passedCondition=true;
    }
  }
 else   if (fieldName != null) {
    MimeMessage message=messageWrapper.getMessage();
    String[] fieldValue=null;
    try {
      fieldValue=this.getFieldValue(message,fieldName);
    }
 catch (    MessagingException e) {
      Debug.logError(e,module);
    }
catch (    IOException e) {
      Debug.logError(e,module);
    }
    if (fieldValue != null) {
      for (int i=0; i < fieldValue.length; i++) {
        if ("equals".equals(operator)) {
          if (fieldValue[i].equals(value)) {
            passedCondition=true;
            break;
          }
        }
 else         if ("not-equals".equals(operator)) {
          if (!fieldValue[i].equals(value)) {
            passedCondition=true;
          }
 else {
            passedCondition=false;
          }
        }
 else         if ("matches".equals(operator)) {
          if (fieldValue[i].matches(value)) {
            passedCondition=true;
            break;
          }
        }
 else         if ("not-matches".equals(operator)) {
          if (!fieldValue[i].matches(value)) {
            passedCondition=true;
          }
 else {
            passedCondition=false;
          }
        }
 else         if ("not-empty".equals(operator)) {
          passedCondition=true;
          break;
        }
      }
    }
 else     if ("empty".equals(operator)) {
      passedCondition=true;
    }
  }
 else {
    passedCondition=false;
  }
  return passedCondition;
}
