{
  CacheLine oldCacheLine;
  CacheLine newCacheLine;
  if (expireTime > 0) {
    newCacheLine=useSoftReference ? new SoftRefCacheLine(value,System.currentTimeMillis(),expireTime) : new HardRefCacheLine(value,System.currentTimeMillis(),expireTime);
  }
 else {
    newCacheLine=useSoftReference ? new SoftRefCacheLine(value,expireTime) : new HardRefCacheLine(value,expireTime);
  }
  oldCacheLine=cacheLineTable.put(key,newCacheLine);
  if (oldCacheLine == null) {
    noteAddition(key,value);
    return null;
  }
 else {
    noteUpdate(key,value,oldCacheLine.getValue());
    return oldCacheLine.getValue();
  }
}
