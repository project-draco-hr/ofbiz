{
  GenericValue glAccount=account.getRelatedOne("GlAccount");
  double balance=0.0;
  if (isDebitAccount(glAccount)) {
    balance=account.getDouble("postedDebits").doubleValue() - account.getDouble("postedCredits").doubleValue();
  }
 else   if (isCreditAccount(glAccount)) {
    balance=account.getDouble("postedCredits").doubleValue() - account.getDouble("postedDebits").doubleValue();
  }
  return new Double(balance);
}
