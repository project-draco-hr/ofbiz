{
  GenericValue glAccount=account.getRelatedOne("GlAccount",false);
  BigDecimal balance=BigDecimal.ZERO;
  if (isDebitAccount(glAccount)) {
    balance=account.getBigDecimal("postedDebits").subtract(account.getBigDecimal("postedCredits"));
  }
 else   if (isCreditAccount(glAccount)) {
    balance=account.getBigDecimal("postedCredits").subtract(account.getBigDecimal("postedDebits"));
  }
  return balance;
}
