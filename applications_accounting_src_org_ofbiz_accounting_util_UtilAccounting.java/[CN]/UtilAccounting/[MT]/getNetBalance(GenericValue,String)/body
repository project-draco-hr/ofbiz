{
  try {
    String parentClassId=account.getRelatedOne("GlAccount").getRelatedOne("GlAccountClass").getRelatedOne("ParentGlAccountClass").getString("glAccountClassId");
    double balance=0.0;
    if (parentClassId.equals("DEBIT")) {
      balance=account.getDouble("postedDebits").doubleValue() - account.getDouble("postedCredits").doubleValue();
    }
 else     if (parentClassId.equals("CREDIT")) {
      balance=account.getDouble("postedCredits").doubleValue() - account.getDouble("postedDebits").doubleValue();
    }
    return new Double(balance);
  }
 catch (  GenericEntityException ex) {
    Debug.logError(ex.getMessage(),debugModule);
    return null;
  }
}
