{
  ModelFormField modelFormField=dateTimeField.getModelFormField();
  String paramName=modelFormField.getParameterName(context);
  String defaultDateTimeString=dateTimeField.getDefaultDateTimeString(context);
  String event=modelFormField.getEvent();
  String action=modelFormField.getAction(context);
  Map<String,String> uiLabelMap=UtilGenerics.checkMap(context.get("uiLabelMap"));
  if (uiLabelMap == null) {
    Debug.logWarning("Could not find uiLabelMap in context",module);
  }
  String localizedInputTitle="", localizedIconTitle="";
  boolean shortDateInput=("date".equals(dateTimeField.getType()) || "time-dropdown".equals(dateTimeField.getInputMethod()) ? true : false);
  writer.append("<input type=\"text\"");
  appendClassNames(writer,context,modelFormField);
  writer.append(" name=\"");
  if ("time-dropdown".equals(dateTimeField.getInputMethod())) {
    writer.append(UtilHttp.makeCompositeParam(paramName,"date"));
  }
 else {
    writer.append(paramName);
  }
  writer.append('"');
  int size=25;
  int maxlength=30;
  if (shortDateInput) {
    size=maxlength=10;
    if ("time".equals(dateTimeField.getType())) {
      writer.append(" style=\"height:1px;width:1px;border:none;background-color:transparent\"");
    }
    if (uiLabelMap != null) {
      localizedInputTitle=uiLabelMap.get("CommonFormatDate");
    }
  }
 else   if ("time".equals(dateTimeField.getType())) {
    size=maxlength=8;
    if (uiLabelMap != null) {
      localizedInputTitle=uiLabelMap.get("CommonFormatTime");
    }
  }
 else {
    if (uiLabelMap != null) {
      localizedInputTitle=uiLabelMap.get("CommonFormatDateTime");
    }
  }
  writer.append(" title=\"");
  writer.append(localizedInputTitle);
  writer.append('"');
  String value=modelFormField.getEntry(context,dateTimeField.getDefaultValue(context));
  if (UtilValidate.isNotEmpty(value)) {
    if (value.length() > maxlength) {
      value=value.substring(0,maxlength);
    }
    writer.append(" value=\"");
    writer.append(value);
    writer.append('"');
  }
  writer.append(" size=\"");
  writer.append(Integer.toString(size));
  writer.append('"');
  writer.append(" maxlength=\"");
  writer.append(Integer.toString(maxlength));
  writer.append('"');
  String idName=modelFormField.getCurrentContainerId(context);
  if (UtilValidate.isNotEmpty(idName)) {
    writer.append(" id=\"");
    writer.append(idName);
    writer.append('"');
  }
  if (UtilValidate.isNotEmpty(event) && UtilValidate.isNotEmpty(action)) {
    writer.append(" ");
    writer.append(event);
    writer.append("=\"");
    writer.append(action);
    writer.append('"');
  }
  writer.append("/>");
  if (uiLabelMap != null) {
    localizedIconTitle=uiLabelMap.get("CommonViewCalendar");
  }
  if (!"time".equals(dateTimeField.getType())) {
    if (shortDateInput) {
      writer.append("<a href=\"javascript:call_cal_notime(document.");
    }
 else {
      writer.append("<a href=\"javascript:call_cal(document.");
    }
    writer.append(modelFormField.getModelForm().getCurrentFormName(context));
    writer.append('.');
    if ("time-dropdown".equals(dateTimeField.getInputMethod())) {
      writer.append(UtilHttp.makeCompositeParam(paramName,"date"));
    }
 else {
      writer.append(paramName);
    }
    writer.append(",'");
    writer.append(UtilHttp.encodeBlanks(modelFormField.getEntry(context,defaultDateTimeString)));
    writer.append("');\">");
    writer.append("<img src=\"");
    this.appendContentUrl(writer,"/images/cal.gif");
    writer.append("\" width=\"16\" height=\"16\" border=\"0\" alt=\"");
    writer.append(localizedIconTitle);
    writer.append("\" title=\"");
    writer.append(localizedIconTitle);
    writer.append("\"/></a>");
  }
  if ("time-dropdown".equals(dateTimeField.getInputMethod())) {
    String className=modelFormField.getWidgetStyle();
    String classString=(className != null ? " class=\"" + className + "\" " : "");
    boolean isTwelveHour="12".equals(dateTimeField.getClock());
    Calendar cal=null;
    try {
      Timestamp defaultTimestamp=Timestamp.valueOf(modelFormField.getEntry(context,defaultDateTimeString));
      cal=Calendar.getInstance();
      cal.setTime(defaultTimestamp);
    }
 catch (    IllegalArgumentException e) {
      Debug.logWarning("Form widget field [" + paramName + "] with input-method=\"time-dropdown\" was not able to understand the default time ["+ defaultDateTimeString+ "]. The parsing error was: "+ e.getMessage(),module);
    }
    writer.append("&nbsp;<select name=\"").append(UtilHttp.makeCompositeParam(paramName,"hour")).append("\"");
    writer.append(classString).append(">");
    if (isTwelveHour) {
      for (int i=1; i <= 12; i++) {
        writer.append("<option value=\"").append(Integer.toString(i)).append("\"");
        if (cal != null) {
          int hour=cal.get(Calendar.HOUR_OF_DAY);
          if (hour == 0)           hour=12;
          if (hour > 12)           hour-=12;
          if (i == hour)           writer.append(" selected");
        }
        writer.append(">").append(Integer.toString(i)).append("</option>");
      }
    }
 else {
      for (int i=0; i < 24; i++) {
        writer.append("<option value=\"").append(Integer.toString(i)).append("\"");
        if (cal != null && i == cal.get(Calendar.HOUR_OF_DAY)) {
          writer.append(" selected");
        }
        writer.append(">").append(Integer.toString(i)).append("</option>");
      }
    }
    writer.append("</select>:<select name=\"");
    writer.append(UtilHttp.makeCompositeParam(paramName,"minutes")).append("\"");
    writer.append(classString).append(">");
    for (int i=0; i < 60; i++) {
      writer.append("<option value=\"").append(Integer.toString(i)).append("\"");
      if (cal != null && i == cal.get(Calendar.MINUTE)) {
        writer.append(" selected");
      }
      writer.append(">").append(Integer.toString(i)).append("</option>");
    }
    writer.append("</select>");
    if (isTwelveHour) {
      String amSelected=((cal != null && cal.get(Calendar.AM_PM) == Calendar.AM) ? "selected" : "");
      String pmSelected=((cal != null && cal.get(Calendar.AM_PM) == Calendar.PM) ? "selected" : "");
      writer.append("<select name=\"").append(UtilHttp.makeCompositeParam(paramName,"ampm")).append("\"");
      writer.append(classString).append(">");
      writer.append("<option value=\"AM\" ").append(amSelected).append(">AM</option>");
      writer.append("<option value=\"PM\" ").append(pmSelected).append(">PM</option>");
      writer.append("</select>");
    }
    writer.append("<input type=\"hidden\" name=\"");
    writer.append(UtilHttp.makeCompositeParam(paramName,"compositeType"));
    writer.append("\" value=\"Timestamp\"/>");
  }
  this.addAsterisks(writer,context,modelFormField);
  this.appendTooltip(writer,context,modelFormField);
}
