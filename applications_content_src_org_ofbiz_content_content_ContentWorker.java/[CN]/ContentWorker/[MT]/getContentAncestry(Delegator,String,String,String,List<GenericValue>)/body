{
  String contentIdField=null;
  String contentIdOtherField=null;
  if (direction != null && direction.equalsIgnoreCase("to")) {
    contentIdField="contentId";
    contentIdOtherField="contentIdTo";
  }
 else {
    contentIdField="contentIdTo";
    contentIdOtherField="contentId";
  }
  if (Debug.infoOn()) {
    Debug.logInfo("getContentAncestry, contentId:" + contentId,"");
    Debug.logInfo("getContentAncestry, contentAssocTypeId:" + contentAssocTypeId,"");
  }
  Map<String,Object> andMap=null;
  if (UtilValidate.isEmpty(contentAssocTypeId)) {
    andMap=UtilMisc.<String,Object>toMap(contentIdField,contentId);
  }
 else {
    andMap=UtilMisc.<String,Object>toMap(contentIdField,contentId,"contentAssocTypeId",contentAssocTypeId);
  }
  try {
    List<GenericValue> lst=delegator.findByAndCache("ContentAssoc",andMap);
    List<GenericValue> lst2=EntityUtil.filterByDate(lst);
    if (lst2.size() > 0) {
      GenericValue contentAssoc=lst2.get(0);
      getContentAncestry(delegator,contentAssoc.getString(contentIdOtherField),contentAssocTypeId,direction,contentAncestorList);
      contentAncestorList.add(contentAssoc);
    }
  }
 catch (  GenericEntityException e) {
    Debug.logError(e,module);
    return;
  }
}
