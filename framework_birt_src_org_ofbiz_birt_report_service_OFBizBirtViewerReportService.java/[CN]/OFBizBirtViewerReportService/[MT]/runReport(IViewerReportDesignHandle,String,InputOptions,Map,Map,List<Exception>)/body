{
  if (design == null || design.getDesignObject() == null) {
    throw new ReportServiceException(BirtResources.getMessage(ResourceConstants.GENERAL_EXCEPTION_NO_REPORT_DESIGN));
  }
  IReportRunnable runnable;
  HttpServletRequest request=(HttpServletRequest)runOptions.getOption(InputOptions.OPT_REQUEST);
  Locale locale=(Locale)runOptions.getOption(InputOptions.OPT_LOCALE);
  TimeZone timeZone=(TimeZone)runOptions.getOption(InputOptions.OPT_TIMEZONE);
  ViewerAttributeBean attrBean=(ViewerAttributeBean)request.getAttribute(IBirtConstants.ATTRIBUTE_BEAN);
  Map parsedParams=attrBean.getParameters();
  if (parameters != null) {
    parsedParams.putAll(parameters);
  }
  Map displayTextMap=attrBean.getDisplayTexts();
  if (displayTexts != null) {
    displayTextMap.putAll(displayTexts);
  }
  runnable=(IReportRunnable)design.getDesignObject();
  try {
    Integer maxRows=null;
    if (ParameterAccessor.isReportParameterExist(request,ParameterAccessor.PARAM_MAXROWS)) {
      maxRows=Integer.valueOf(ParameterAccessor.getMaxRows(request));
    }
    try {
      ReportEngineService.getInstance().getEngineConfig().getAppContext().putAll(BirtContainer.getReportEngine().getConfig().getAppContext());
    }
 catch (    Exception e) {
      Debug.logError(e,module);
    }
    List<Exception> errors=this.runReport(request,runnable,outputDocName,locale,timeZone,parsedParams,displayTextMap,maxRows);
    if (UtilValidate.isNotEmpty(errors)) {
      errorList.addAll(errors);
    }
  }
 catch (  RemoteException e) {
    if (e.getCause() instanceof ReportServiceException) {
      throw (ReportServiceException)e.getCause();
    }
 else {
      throw new ReportServiceException(e.getLocalizedMessage(),e.getCause());
    }
  }
  return outputDocName;
}
