{
  GenericDelegator delegator=dctx.getDelegator();
  Map<String,Object> result=FastMap.newInstance();
  String productId=(String)context.get("productId");
  String distinct=(String)context.get("distinct");
  String type=(String)context.get("type");
  Locale locale=(Locale)context.get("locale");
  String errMsg=null;
  List<GenericValue> features=null;
  try {
    Map<String,String> fields=UtilMisc.toMap("productId",productId);
    List<String> order=UtilMisc.toList("sequenceNum","productFeatureTypeId");
    if (distinct != null)     fields.put("productFeatureTypeId",distinct);
    if (type != null)     fields.put("productFeatureApplTypeId",type);
    features=delegator.findByAndCache("ProductFeatureAndAppl",fields,order);
    result.put("productFeatures",features);
    result.put(ModelService.RESPONSE_MESSAGE,ModelService.RESPOND_SUCCESS);
  }
 catch (  GenericEntityException e) {
    Map<String,String> messageMap=UtilMisc.toMap("errMessage",e.toString());
    errMsg=UtilProperties.getMessage(resource,"productservices.problem_reading_product_feature_entity",messageMap,locale);
    result.put(ModelService.RESPONSE_MESSAGE,ModelService.RESPOND_ERROR);
    result.put(ModelService.ERROR_MESSAGE,errMsg);
  }
  return result;
}
