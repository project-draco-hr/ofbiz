{
  Map tempSample=new HashMap();
  Map sample=new LinkedMap();
  Iterator itemIt=items.iterator();
  while (itemIt.hasNext()) {
    String productId=(String)itemIt.next();
    List features=null;
    try {
      Map fields=UtilMisc.toMap("productId",productId,"productFeatureTypeId",feature,"productFeatureApplTypeId","STANDARD_FEATURE");
      List sort=UtilMisc.toList("sequenceNum","description");
      features=delegator.findByAndCache("ProductFeatureAndAppl",fields,sort);
      features=EntityUtil.filterByDate(features,true);
    }
 catch (    GenericEntityException e) {
      throw new IllegalStateException("Problem reading relation: " + e.getMessage());
    }
    Iterator featureIt=features.iterator();
    while (featureIt.hasNext()) {
      GenericValue featureAppl=(GenericValue)featureIt.next();
      try {
        GenericValue product=delegator.findByPrimaryKeyCache("Product",UtilMisc.toMap("productId",productId));
        tempSample.put(featureAppl.getString("description"),product);
      }
 catch (      GenericEntityException e) {
        throw new RuntimeException("Cannot get product entity: " + e.getMessage());
      }
    }
  }
  List features=(LinkedList)featureList.get(feature);
  Iterator fi=features.iterator();
  while (fi.hasNext()) {
    String f=(String)fi.next();
    if (tempSample.containsKey(f))     sample.put(f,tempSample.get(f));
  }
  return sample;
}
