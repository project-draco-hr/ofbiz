{
  Map<String,GenericValue> tempSample=FastMap.newInstance();
  Map<String,GenericValue> sample=new LinkedHashMap<String,GenericValue>();
  Iterator<String> itemIt=items.iterator();
  while (itemIt.hasNext()) {
    String productId=itemIt.next();
    List<GenericValue> features=null;
    try {
      Map<String,String> fields=UtilMisc.toMap("productId",productId,"productFeatureTypeId",feature,"productFeatureApplTypeId","STANDARD_FEATURE");
      List<String> sort=UtilMisc.toList("sequenceNum","description");
      features=delegator.findByAndCache("ProductFeatureAndAppl",fields,sort);
      features=EntityUtil.filterByDate(features,true);
    }
 catch (    GenericEntityException e) {
      throw new IllegalStateException("Problem reading relation: " + e.getMessage());
    }
    Iterator<GenericValue> featureIt=features.iterator();
    while (featureIt.hasNext()) {
      GenericValue featureAppl=featureIt.next();
      try {
        GenericValue product=delegator.findByPrimaryKeyCache("Product",UtilMisc.toMap("productId",productId));
        tempSample.put(featureAppl.getString("description"),product);
      }
 catch (      GenericEntityException e) {
        throw new RuntimeException("Cannot get product entity: " + e.getMessage());
      }
    }
  }
  List<String> features=featureList.get(feature);
  Iterator<String> fi=features.iterator();
  while (fi.hasNext()) {
    String f=fi.next();
    if (tempSample.containsKey(f))     sample.put(f,tempSample.get(f));
  }
  return sample;
}
