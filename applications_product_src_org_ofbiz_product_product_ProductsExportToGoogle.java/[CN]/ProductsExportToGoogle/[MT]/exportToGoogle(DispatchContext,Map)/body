{
  Locale locale=(Locale)context.get("locale");
  GenericDelegator delegator=dctx.getDelegator();
  LocalDispatcher dispatcher=dctx.getDispatcher();
  Map result=null;
  try {
    String configString="productsExport.properties";
    String developerKey=UtilProperties.getPropertyValue(configString,"productsExport.google.developerKey");
    String authenticationUrl=UtilProperties.getPropertyValue(configString,"productsExport.google.authenticationUrl");
    String accountEmail=UtilProperties.getPropertyValue(configString,"productsExport.google.accountEmail");
    String accountPassword=UtilProperties.getPropertyValue(configString,"productsExport.google.accountPassword");
    String postItemsUrl=UtilProperties.getPropertyValue(configString,"productsExport.google.postItemsUrl");
    StringBuffer dataItemsXml=new StringBuffer();
    result=buildDataItemsXml(dctx,context,dataItemsXml);
    if (!ServiceUtil.isFailure(result)) {
      String token=authenticate(authenticationUrl,accountEmail,accountPassword);
      if (token != null) {
        result=postItem(token,postItemsUrl,developerKey,dataItemsXml,locale,(String)context.get("testMode"),(List)result.get("newProductsInGoogle"),(List)result.get("productsRemovedFromGoogle"),dispatcher,delegator);
      }
 else {
        Debug.logError("Error during authentication to Google Account",module);
        return ServiceUtil.returnFailure(UtilProperties.getMessage(resource,"productsExportToGoogle.errorDuringAuthenticationToGoogle",locale));
      }
    }
 else {
      return ServiceUtil.returnFailure(ServiceUtil.getErrorMessage(result));
    }
  }
 catch (  Exception e) {
    Debug.logError("Exception in exportToGoogle",module);
    return ServiceUtil.returnFailure(UtilProperties.getMessage(resource,"productsExportToGoogle.exceptionInExportToGoogle",locale));
  }
  return result;
}
