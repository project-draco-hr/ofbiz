{
  Locale locale=(Locale)context.get("locale");
  WeightPackageSession weightPackageSession=(WeightPackageSession)context.get("weightPackageSession");
  String shipmentId=(String)context.get("shipmentId");
  String orderId=(String)context.get("orderId");
  Map<String,Object> response=FastMap.newInstance();
  try {
    String getActualShippingQuoteFromUps=UtilProperties.getPropertyValue("shipment.properties","shipment.ups.shipping","N");
    if ("Y".equals(getActualShippingQuoteFromUps) && weightPackageSession.completeShipment(orderId,"Y")) {
      response.put("shipmentId",shipmentId);
    }
 else     if (weightPackageSession.completeShipment(orderId)) {
      response.put("shipmentId",shipmentId);
    }
 else {
      response=ServiceUtil.returnError(UtilProperties.getMessage("ProductErrorUiLabels","ProductErrorNoItemsCurrentlySetToBeShippedCannotComplete",locale));
    }
  }
 catch (  GeneralException e) {
    return ServiceUtil.returnError(e.getMessage(),e.getMessageList());
  }
  return response;
}
