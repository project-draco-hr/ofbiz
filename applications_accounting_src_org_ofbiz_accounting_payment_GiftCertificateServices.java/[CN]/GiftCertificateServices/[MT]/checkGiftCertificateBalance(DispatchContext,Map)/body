{
  GenericDelegator delegator=dctx.getDelegator();
  String cardNumber=(String)context.get("cardNumber");
  String pinNumber=(String)context.get("pinNumber");
  if (!validatePin(delegator,cardNumber,pinNumber)) {
    return ServiceUtil.returnError("PIN number is not valid!");
  }
  GenericValue finAccount=null;
  try {
    finAccount=delegator.findByPrimaryKey("FinAccount",UtilMisc.toMap("finAccountId",cardNumber));
  }
 catch (  GenericEntityException e) {
    return ServiceUtil.returnError("Cannot get financial account settings " + e.getMessage());
  }
  double balance=finAccount.get("availableBalance") == null ? 0.0 : finAccount.getDouble("availableBalance").doubleValue();
  Map result=ServiceUtil.returnSuccess();
  result.put("balance",new Double(balance));
  Debug.log("GC Balance Result - " + result,module);
  return result;
}
