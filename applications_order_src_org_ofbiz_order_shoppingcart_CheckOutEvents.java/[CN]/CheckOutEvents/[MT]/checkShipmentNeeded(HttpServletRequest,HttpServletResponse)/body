{
  GenericDelegator delegator=(GenericDelegator)request.getAttribute("delegator");
  ShoppingCart cart=ShoppingCartEvents.getCartObject(request);
  GenericValue productStore=null;
  try {
    productStore=delegator.findByPrimaryKeyCache("ProductStore",UtilMisc.toMap("productStoreId",cart.getProductStoreId()));
  }
 catch (  GenericEntityException e) {
    Debug.logError(e,"Error getting ProductStore: " + e.toString(),module);
  }
  Debug.logInfo("checkShipmentNeeded: reqShipAddrForDigItems=" + productStore.getString("reqShipAddrForDigItems"),module);
  if (productStore != null && "N".equals(productStore.getString("reqShipAddrForDigItems"))) {
    Debug.logInfo("checkShipmentNeeded: cart.containOnlyDigitalGoods()=" + cart.containOnlyDigitalGoods(),module);
    if (cart.containOnlyDigitalGoods()) {
      return "shipmentNotNeeded";
    }
  }
  return "shipmentNeeded";
}
