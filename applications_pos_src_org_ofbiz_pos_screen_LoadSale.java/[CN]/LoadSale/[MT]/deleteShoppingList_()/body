{
  String sale=(String)m_salesList.getSelectedValue();
  if (null != sale) {
    String shoppingListId=selectedSale();
    final ClassLoader cl=this.getClassLoader(m_pos);
    Thread.currentThread().setContextClassLoader(cl);
    if (m_trans.clearList(shoppingListId,m_pos)) {
      int index=m_salesList.getSelectedIndex();
      m_saleMap.remove(shoppingListId);
      m_listModel=new DefaultListModel();
      for (Iterator i=m_saleMap.entrySet().iterator(); i.hasNext(); ) {
        Object o=i.next();
        Map.Entry entry=(Map.Entry)o;
        String val=entry.getValue().toString();
        m_listModel.addElement(val);
      }
      m_salesList.setModel(m_listModel);
      int size=m_listModel.getSize();
      if (size == 0) {
        closeDlg();
      }
 else {
        if (index == size) {
          index--;
        }
      }
      m_salesList.setSelectedIndex(index);
      m_salesList.ensureIndexIsVisible(index);
      m_salesList.repaint();
      repaint();
    }
  }
}
