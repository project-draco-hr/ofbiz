{
  Delegator delegator=(Delegator)pageContext.getRequest().getAttribute("delegator");
  GenericValue userLogin=(GenericValue)pageContext.getSession().getAttribute("userLogin");
  Collection validWorkEfforts=null;
  if (userLogin != null && userLogin.get("partyId") != null) {
    try {
      EntityConditionList<EntityExpr> ecl=EntityCondition.makeCondition(UtilMisc.toList(EntityCondition.makeCondition("partyId",EntityOperator.EQUALS,userLogin.get("partyId")),EntityCondition.makeCondition("workEffortTypeId",EntityOperator.EQUALS,"TASK"),EntityCondition.makeCondition("workEffortPurposeTypeId",EntityOperator.EQUALS,"WEPT_PROJECT")),EntityOperator.AND);
      validWorkEfforts=delegator.findList("WorkEffortAndPartyAssign",ecl,null,UtilMisc.toList("priority"),null,false);
    }
 catch (    GenericEntityException e) {
      Debug.logWarning(e,module);
    }
  }
  if (validWorkEfforts == null || validWorkEfforts.size() <= 0)   return;
  pageContext.setAttribute(projectsAttrName,validWorkEfforts);
}
