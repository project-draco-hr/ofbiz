{
  Iterator entryIter=this.quantityUsedPerPromoCandidate.entrySet().iterator();
  while (entryIter.hasNext()) {
    Map.Entry entry=(Map.Entry)entryIter.next();
    GenericPK productPromoCondActionPK=(GenericPK)entry.getKey();
    Double quantityUsed=(Double)entry.getValue();
    if (productPromoId.equals(productPromoCondActionPK.getString("productPromoId")) && productPromoRuleId.equals(productPromoCondActionPK.getString("productPromoRuleId"))) {
      entryIter.remove();
      Double existingValue=(Double)this.quantityUsedPerPromoFailed.get(productPromoCondActionPK);
      if (existingValue == null) {
        this.quantityUsedPerPromoFailed.put(productPromoCondActionPK,quantityUsed);
      }
 else {
        this.quantityUsedPerPromoFailed.put(productPromoCondActionPK,new Double(quantityUsed.doubleValue() + existingValue.doubleValue()));
      }
      this.promoQuantityUsed-=quantityUsed.doubleValue();
    }
  }
}
