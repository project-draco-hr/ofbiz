{
  Iterator entryIter=this.quantityUsedPerPromoCandidate.entrySet().iterator();
  while (entryIter.hasNext()) {
    Map.Entry entry=(Map.Entry)entryIter.next();
    GenericPK productPromoCondActionPK=(GenericPK)entry.getKey();
    BigDecimal quantityUsed=(BigDecimal)entry.getValue();
    if (productPromoId.equals(productPromoCondActionPK.getString("productPromoId")) && productPromoRuleId.equals(productPromoCondActionPK.getString("productPromoRuleId"))) {
      entryIter.remove();
      BigDecimal existingValue=(BigDecimal)this.quantityUsedPerPromoFailed.get(productPromoCondActionPK);
      if (existingValue == null) {
        this.quantityUsedPerPromoFailed.put(productPromoCondActionPK,quantityUsed);
      }
 else {
        this.quantityUsedPerPromoFailed.put(productPromoCondActionPK,quantityUsed.add(existingValue));
      }
      this.promoQuantityUsed=this.promoQuantityUsed.subtract(quantityUsed);
    }
  }
}
