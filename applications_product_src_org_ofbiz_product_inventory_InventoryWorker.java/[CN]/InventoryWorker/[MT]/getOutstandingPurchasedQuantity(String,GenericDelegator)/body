{
  double qty=0.0;
  List<GenericValue> purchaseOrders=getOutstandingPurchaseOrders(productId,delegator);
  if (UtilValidate.isEmpty(purchaseOrders)) {
    return qty;
  }
 else {
    for (Iterator<GenericValue> pOi=purchaseOrders.iterator(); pOi.hasNext(); ) {
      GenericValue nextOrder=pOi.next();
      if (nextOrder.get("quantity") != null) {
        double itemQuantity=nextOrder.getDouble("quantity").doubleValue();
        double cancelQuantity=0.0;
        if (nextOrder.get("cancelQuantity") != null) {
          cancelQuantity=nextOrder.getDouble("cancelQuantity").doubleValue();
        }
        itemQuantity-=cancelQuantity;
        if (itemQuantity >= 0.0) {
          qty+=itemQuantity;
        }
      }
    }
  }
  return qty;
}
