{
  XPropertySet xpropertysetMultiComponentFactory=(XPropertySet)UnoRuntime.queryInterface(XPropertySet.class,xmulticomponentfactory);
  Object objectDefaultContext=xpropertysetMultiComponentFactory.getPropertyValue("DefaultContext");
  XComponentContext xcomponentcontext=(XComponentContext)UnoRuntime.queryInterface(XComponentContext.class,objectDefaultContext);
  Object desktopObj=xmulticomponentfactory.createInstanceWithContext("com.sun.star.frame.Desktop",xcomponentcontext);
  XComponentLoader xcomponentloader=(XComponentLoader)UnoRuntime.queryInterface(XComponentLoader.class,desktopObj);
  PropertyValue propertyvalue[]=new PropertyValue[2];
  propertyvalue[0]=new PropertyValue();
  propertyvalue[0].Name="Hidden";
  propertyvalue[0].Value=Boolean.TRUE;
  propertyvalue[1]=new PropertyValue();
  propertyvalue[1].Name="InputStream";
  propertyvalue[1].Value=is;
  Object objectDocumentToStore=xcomponentloader.loadComponentFromURL("private:stream","_blank",0,propertyvalue);
  if (objectDocumentToStore == null) {
    Debug.logError("Could not get objectDocumentToStore object from xcomponentloader.loadComponentFromURL",module);
  }
  XStorable xstorable=(XStorable)UnoRuntime.queryInterface(XStorable.class,objectDocumentToStore);
  if (xstorable == null) {
    Debug.logError("Could not get XStorable object from UnoRuntime.queryInterface",module);
  }
  String filterName=getFilterNameFromMimeType(outputMimeType);
  propertyvalue=new PropertyValue[4];
  propertyvalue[0]=new PropertyValue();
  propertyvalue[0].Name="OutputStream";
  OpenOfficeByteArrayOutputStream os=new OpenOfficeByteArrayOutputStream();
  propertyvalue[0].Value=os;
  propertyvalue[1]=new PropertyValue();
  propertyvalue[1].Name="FilterName";
  propertyvalue[1].Value=filterName;
  propertyvalue[3]=new PropertyValue();
  propertyvalue[3].Name="Overwrite";
  propertyvalue[3].Value=Boolean.TRUE;
  propertyvalue[2]=new PropertyValue();
  propertyvalue[2].Name="CompressionMode";
  propertyvalue[2].Value="1";
  xstorable.storeToURL("private:stream",propertyvalue);
  XComponent xcomponent=(XComponent)UnoRuntime.queryInterface(XComponent.class,xstorable);
  xcomponent.dispose();
  return os;
}
