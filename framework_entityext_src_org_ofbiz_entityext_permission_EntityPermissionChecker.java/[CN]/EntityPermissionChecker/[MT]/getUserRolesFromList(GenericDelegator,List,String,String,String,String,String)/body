{
  EntityExpr expr=new EntityExpr(entityIdFieldName,EntityOperator.IN,idList);
  EntityExpr expr2=new EntityExpr(partyIdFieldName,EntityOperator.EQUALS,partyId);
  EntityConditionList condList=new EntityConditionList(UtilMisc.toList(expr,expr2),EntityOperator.AND);
  List roleList=delegator.findByConditionCache(entityName,condList,null,null);
  List roleListFiltered=EntityUtil.filterByDate(roleList);
  HashSet distinctSet=new HashSet();
  Iterator iter=roleListFiltered.iterator();
  while (iter.hasNext()) {
    GenericValue contentRole=(GenericValue)iter.next();
    String roleTypeId=contentRole.getString(roleTypeIdFieldName);
    distinctSet.add(roleTypeId);
  }
  List distinctList=Arrays.asList(distinctSet.toArray());
  return distinctList;
}
