{
  Map<FlexibleMapAccessor<Object>,Object> fieldMap=null;
  List<? extends Element> fieldMapElementList=UtilXml.childElementList(element,"field-map");
  if (fieldMapElementList.size() > 0) {
    fieldMap=FastMap.newInstance();
    for (    Element fieldMapElement : fieldMapElementList) {
      String fieldName=fieldMapElement.getAttribute("field-name");
      String envName=fieldMapElement.getAttribute("env-name");
      String value=fieldMapElement.getAttribute("value");
      if (UtilValidate.isEmpty(fieldName)) {
        fieldMap.put(new FlexibleMapAccessor<Object>(envName),new FlexibleMapAccessor<Object>(envName));
      }
 else {
        if (UtilValidate.isNotEmpty(value)) {
          fieldMap.put(new FlexibleMapAccessor<Object>(fieldName),new FlexibleStringExpander(value));
        }
 else {
          if (UtilValidate.isNotEmpty(envName)) {
            fieldMap.put(new FlexibleMapAccessor<Object>(fieldName),new FlexibleMapAccessor<Object>(envName));
          }
 else {
            fieldMap.put(new FlexibleMapAccessor<Object>(fieldName),new FlexibleMapAccessor<Object>(fieldName));
          }
        }
      }
    }
  }
  return fieldMap;
}
