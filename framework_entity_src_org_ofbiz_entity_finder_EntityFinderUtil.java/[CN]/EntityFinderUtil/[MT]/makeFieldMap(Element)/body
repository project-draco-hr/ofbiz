{
  Map<FlexibleMapAccessor<Object>,Object> fieldMap=null;
  List<? extends Element> fieldMapElementList=UtilXml.childElementList(element,"field-map");
  if (fieldMapElementList.size() > 0) {
    fieldMap=FastMap.newInstance();
    for (    Element fieldMapElement : fieldMapElementList) {
      String fieldName=fieldMapElement.getAttribute("field-name");
      String envName=fieldMapElement.getAttribute("env-name");
      String value=fieldMapElement.getAttribute("value");
      if (UtilValidate.isEmpty(fieldName)) {
        fieldMap.put(FlexibleMapAccessor.getInstance(envName),FlexibleMapAccessor.getInstance(envName));
      }
 else {
        if (UtilValidate.isNotEmpty(value)) {
          fieldMap.put(FlexibleMapAccessor.getInstance(fieldName),FlexibleStringExpander.getInstance(value));
        }
 else {
          if (UtilValidate.isNotEmpty(envName)) {
            fieldMap.put(FlexibleMapAccessor.getInstance(fieldName),FlexibleMapAccessor.getInstance(envName));
          }
 else {
            fieldMap.put(FlexibleMapAccessor.getInstance(fieldName),FlexibleMapAccessor.getInstance(fieldName));
          }
        }
      }
    }
  }
  return fieldMap;
}
