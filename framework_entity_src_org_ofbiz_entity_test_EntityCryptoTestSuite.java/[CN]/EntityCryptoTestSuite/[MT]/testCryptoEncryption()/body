{
  delegator.removeByAnd("TestingCrypto",UtilMisc.toMap("testingCryptoTypeId","BASIC"));
  String nanoTime="" + System.nanoTime();
  delegator.create("TestingCrypto",UtilMisc.toMap("testingCryptoId","1","testingCryptoTypeId","BASIC"));
  GenericValue entity=delegator.findOne("TestingCrypto",UtilMisc.toMap("testingCryptoId","1"),false);
  assertNull(entity.getString("unencryptedValue"));
  assertNull(entity.getString("encryptedValue"));
  GenericValue view=delegator.findOne("TestingCryptoRawView",UtilMisc.toMap("testingCryptoId","1"),false);
  assertNull(view.getString("unencryptedValue"));
  assertNull(view.getString("encryptedValue"));
  assertNull(view.getString("rawEncryptedValue"));
  entity.setString("unencryptedValue",nanoTime);
  entity.setString("encryptedValue",nanoTime);
  entity.store();
  view.refresh();
  assertEquals(nanoTime,view.getString("unencryptedValue"));
  assertEquals(nanoTime,view.getString("encryptedValue"));
  String initialValue=view.getString("rawEncryptedValue");
  assertFalse(nanoTime.equals(initialValue));
  entity.setString("encryptedValue",nanoTime);
  entity.store();
  entity.refresh();
  assertEquals(nanoTime,entity.getString("unencryptedValue"));
  assertEquals(nanoTime,entity.getString("encryptedValue"));
  view.refresh();
  assertEquals(nanoTime,view.getString("unencryptedValue"));
  assertEquals(nanoTime,view.getString("encryptedValue"));
  String updatedValue=view.getString("rawEncryptedValue");
  assertFalse(nanoTime.equals(updatedValue));
  assertFalse(initialValue.equals(updatedValue));
}
