{
  Assert.notNull("filePath",filePath,"context",context);
  try {
    String fileExtension=getFileExtension(filePath);
    if ("bsh".equals(fileExtension)) {
      return BshUtil.runBshAtLocation(filePath,context);
    }
    return executeScript(filePath,functionName,createScriptContext(context),args);
  }
 catch (  Exception e) {
    String errMsg="Error running script at location [" + filePath + "]: "+ e.toString();
    Debug.logWarning(e,errMsg,module);
    throw new IllegalArgumentException(errMsg);
  }
}
