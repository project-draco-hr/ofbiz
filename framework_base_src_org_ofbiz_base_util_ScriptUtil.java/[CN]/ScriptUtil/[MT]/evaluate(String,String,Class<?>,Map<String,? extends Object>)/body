{
  Assert.notNull("inputMap",inputMap);
  if (scriptClass != null) {
    return InvokerHelper.createScript(scriptClass,GroovyUtil.getBinding(inputMap)).run();
  }
  if ("bsh".equals(language)) {
    return BshUtil.eval(script,UtilMisc.makeMapWritable(inputMap));
  }
  try {
    CompiledScript compiledScript=compileScriptString(language,script);
    if (compiledScript != null) {
      return executeScript(compiledScript,null,createScriptContext(inputMap),null);
    }
    ScriptEngineManager manager=new ScriptEngineManager();
    ScriptEngine engine=manager.getEngineByName(language);
    if (engine == null) {
      throw new IllegalArgumentException("The script type is not supported for language: " + language);
    }
    if (Debug.verboseOn()) {
      Debug.logVerbose("Begin processing script [" + script + "] using engine "+ engine.getClass().getName(),module);
    }
    ScriptContext scriptContext=createScriptContext(inputMap);
    return engine.eval(script,scriptContext);
  }
 catch (  Exception e) {
    String errMsg="Error running " + language + " script ["+ script+ "]: "+ e.toString();
    Debug.logWarning(e,errMsg,module);
    throw new IllegalArgumentException(errMsg);
  }
}
