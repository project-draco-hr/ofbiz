{
  boolean useDefaultLanguage=Boolean.FALSE;
  if (UtilValidate.isEmpty(language)) {
    language=UtilProperties.getPropertyValue("general","locale.properties.fallback");
    useDefaultLanguage=Boolean.TRUE;
  }
  Node langNode=null;
  if (this.node.hasProperty(PROPERTY_FIELDS.LANGUAGE.getType())) {
    langNode=this.node;
  }
 else   if (this.node.hasNode(language)) {
    if (this.node.hasNode(language)) {
      langNode=this.node.getNode(language);
    }
  }
 else   if (!this.node.hasNode(language) && useDefaultLanguage) {
    if (useDefaultLanguage) {
      NodeIterator ni=this.node.getNodes();
      while (ni.hasNext()) {
        Node n=ni.nextNode();
        if (n.hasProperty(PROPERTY_FIELDS.LANGUAGE.getType())) {
          langNode=n;
          break;
        }
      }
    }
  }
  if (langNode == null) {
    Debug.logWarning("No text content exist for this node. You should create a text content.",module);
    throw new PathNotFoundException("No text content exist for this node. You should create a text content.");
  }
  if (UtilValidate.isNotEmpty(version)) {
    VersionHistory vh=versionManager.getVersionHistory(langNode.getPath());
    Version v=vh.getVersion(version);
    versionManager.restore(v,true);
  }
  selectedLanguage=langNode.getProperty(PROPERTY_FIELDS.LANGUAGE.getType()).getString();
  Property property=null;
  if (langNode.hasProperty(PROPERTY_FIELDS.MESSAGE.getType())) {
    property=langNode.getProperty(PROPERTY_FIELDS.MESSAGE.getType());
  }
  if (property == null || property.getType() != 1) {
    Debug.logWarning("The content from the node:" + node.getPath() + " is not a String content.",module);
    return new String();
  }
  return property.getString();
}
