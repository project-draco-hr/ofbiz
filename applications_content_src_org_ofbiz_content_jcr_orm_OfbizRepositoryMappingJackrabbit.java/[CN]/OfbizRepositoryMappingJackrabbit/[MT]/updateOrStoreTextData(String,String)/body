{
  if (UtilValidate.isEmpty(language)) {
    language=UtilProperties.getPropertyValue("general","locale.properties.fallback");
  }
  Node languageNode=node;
  if (!this.node.hasProperty(PROPERTY_FIELDS.LANGUAGE.getType())) {
    if (session.nodeExists(this.node.getPath()) && session.nodeExists(this.node.getPath() + "/" + language)) {
      languageNode=this.node.getNode(language);
      checkOutNode(languageNode);
    }
 else {
      languageNode=(Node)this.createNewRepositoryNode(this.node.getPath() + "/" + language).get("node");
      languageNode.setProperty(PROPERTY_FIELDS.LANGUAGE.getType(),language);
    }
  }
 else {
    checkOutNode(languageNode);
  }
  languageNode.setProperty(PROPERTY_FIELDS.MESSAGE.getType(),message);
  languageNode.addMixin(PROPERTY_FIELDS.VERSIONING.getType());
  saveSessionAndCheckinNode();
  return versionManager.getBaseVersion(languageNode.getPath());
}
