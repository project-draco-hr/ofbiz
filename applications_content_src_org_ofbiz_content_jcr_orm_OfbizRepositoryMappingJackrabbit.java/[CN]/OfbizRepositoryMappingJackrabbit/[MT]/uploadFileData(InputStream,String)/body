{
  Node folder=(Node)createNewRepositoryNode(this.node.getPath() + "/" + fileName,PROPERTY_FIELDS.FILE.getType()).get("node");
  Node resource=(Node)createNewRepositoryNode(folder.getPath() + "/jcr:content",PROPERTY_FIELDS.RESOURCE.getType()).get("node");
  Binary binary=this.session.getValueFactory().createBinary(file);
  String mimeType=getMimeTypeFromInputStream(file);
  resource.setProperty("jcr:mimeType",mimeType);
  resource.setProperty(PROPERTY_FIELDS.DATA.getType(),binary);
  resource.addMixin(PROPERTY_FIELDS.VERSIONING.getType());
  saveSessionAndCheckinNode();
  return;
}
