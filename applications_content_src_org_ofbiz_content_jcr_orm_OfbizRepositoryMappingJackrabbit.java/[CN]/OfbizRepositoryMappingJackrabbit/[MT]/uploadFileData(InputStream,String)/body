{
  try {
    this.node.setPrimaryType(PROPERTY_FIELDS.FOLDER.getType());
  }
 catch (  RepositoryException e) {
    Debug.logError("Appanding a file to a text content is not allowed. Please create a folder which haven't a text node as parent.",module);
    throw new RepositoryException("Appanding a file to a text content is not allowed. Please create a folder which haven't a text node as parent.",e);
  }
  Node folder=(Node)createNewRepositoryNode(this.node.getPath() + "/" + fileName,PROPERTY_FIELDS.FILE.getType()).get("node");
  Node resource=(Node)createNewRepositoryNode(folder.getPath() + "/jcr:content",PROPERTY_FIELDS.RESOURCE.getType()).get("node");
  Binary binary=this.session.getValueFactory().createBinary(file);
  String mimeType=getMimeTypeFromInputStream(file);
  resource.setProperty("jcr:mimeType",mimeType);
  resource.setProperty(PROPERTY_FIELDS.DATA.getType(),binary);
  this.session.save();
  return;
}
