{
  Template template=null;
  if (useCache) {
    template=cachedTemplates.get(templateLocation);
    if (template == null) {
      Reader templateReader=new StringReader(templateString);
      template=new Template(templateLocation,templateReader,defaultOfbizConfig);
      templateReader.close();
      template=cachedTemplates.putIfAbsentAndGet(templateLocation,template);
    }
  }
 else {
    Reader templateReader=new StringReader(templateString);
    template=new Template(templateLocation,templateReader,defaultOfbizConfig);
    templateReader.close();
  }
  return renderTemplate(template,context,outWriter);
}
