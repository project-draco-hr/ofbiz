{
  formStringRenderer.renderFormatHeaderRowOpen(buffer,context,this);
  Iterator displayHyperlinkFieldIter=this.fieldList.iterator();
  ModelFormField previousModelFormField=null;
  while (displayHyperlinkFieldIter.hasNext()) {
    ModelFormField modelFormField=(ModelFormField)displayHyperlinkFieldIter.next();
    ModelFormField.FieldInfo fieldInfo=modelFormField.getFieldInfo();
    if (fieldInfo.getFieldType() == ModelFormField.FieldInfo.HIDDEN || fieldInfo.getFieldType() == ModelFormField.FieldInfo.IGNORED) {
      continue;
    }
    if (previousModelFormField != null && previousModelFormField.getTitle(context).equals(modelFormField.getTitle(context)) && !(previousModelFormField.isUseWhenEmpty() && modelFormField.isUseWhenEmpty())) {
      continue;
    }
    if (fieldInfo.getFieldType() != ModelFormField.FieldInfo.DISPLAY && fieldInfo.getFieldType() != ModelFormField.FieldInfo.DISPLAY_ENTITY && fieldInfo.getFieldType() != ModelFormField.FieldInfo.HYPERLINK) {
      break;
    }
    formStringRenderer.renderFormatHeaderRowCellOpen(buffer,context,this,modelFormField);
    formStringRenderer.renderFieldTitle(buffer,context,modelFormField);
    formStringRenderer.renderFormatHeaderRowCellClose(buffer,context,this,modelFormField);
    previousModelFormField=modelFormField;
  }
  if (!displayHyperlinkFieldIter.hasNext()) {
    listEnd=true;
  }
  List headerFormFields=new LinkedList();
  Iterator formFieldIter=this.fieldList.iterator();
  while (formFieldIter.hasNext()) {
    ModelFormField modelFormField=(ModelFormField)formFieldIter.next();
    ModelFormField.FieldInfo fieldInfo=modelFormField.getFieldInfo();
    if (fieldInfo.getFieldType() == ModelFormField.FieldInfo.HIDDEN || fieldInfo.getFieldType() == ModelFormField.FieldInfo.IGNORED) {
      continue;
    }
    if (fieldInfo.getFieldType() == ModelFormField.FieldInfo.DISPLAY || fieldInfo.getFieldType() == ModelFormField.FieldInfo.DISPLAY_ENTITY || fieldInfo.getFieldType() == ModelFormField.FieldInfo.HYPERLINK) {
      continue;
    }
    if (!modelFormField.shouldUse(context)) {
      continue;
    }
    headerFormFields.add(modelFormField);
  }
  if (!listEnd) {
    formStringRenderer.renderFormatHeaderRowFormCellOpen(buffer,context,this);
  }
  Iterator headerFormFieldIter=headerFormFields.iterator();
  while (headerFormFieldIter.hasNext()) {
    ModelFormField modelFormField=(ModelFormField)headerFormFieldIter.next();
    if (separateColumns || modelFormField.getSeparateColumn())     formStringRenderer.renderFormatItemRowCellOpen(buffer,context,this,modelFormField);
    formStringRenderer.renderFieldTitle(buffer,context,modelFormField);
    if (separateColumns || modelFormField.getSeparateColumn())     formStringRenderer.renderFormatItemRowCellClose(buffer,context,this,modelFormField);
    if (headerFormFieldIter.hasNext()) {
      if (!separateColumns && !modelFormField.getSeparateColumn())       formStringRenderer.renderFormatHeaderRowFormCellTitleSeparator(buffer,context,this,modelFormField,false);
    }
  }
  if (!listEnd) {
    formStringRenderer.renderFormatHeaderRowFormCellClose(buffer,context,this);
  }
  while (displayHyperlinkFieldIter.hasNext()) {
    ModelFormField modelFormField=(ModelFormField)displayHyperlinkFieldIter.next();
    ModelFormField.FieldInfo fieldInfo=modelFormField.getFieldInfo();
    if (fieldInfo.getFieldType() == ModelFormField.FieldInfo.HIDDEN || fieldInfo.getFieldType() == ModelFormField.FieldInfo.IGNORED) {
      continue;
    }
    if (fieldInfo.getFieldType() != ModelFormField.FieldInfo.DISPLAY && fieldInfo.getFieldType() != ModelFormField.FieldInfo.DISPLAY_ENTITY && fieldInfo.getFieldType() != ModelFormField.FieldInfo.HYPERLINK) {
      continue;
    }
    if (!modelFormField.shouldUse(context)) {
      continue;
    }
    formStringRenderer.renderFormatHeaderRowCellOpen(buffer,context,this,modelFormField);
    formStringRenderer.renderFieldTitle(buffer,context,modelFormField);
    formStringRenderer.renderFormatHeaderRowCellClose(buffer,context,this,modelFormField);
  }
  formStringRenderer.renderFormatHeaderRowClose(buffer,context,this);
}
