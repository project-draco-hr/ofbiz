{
  if (availableLocaleList == null) {
synchronized (UtilMisc.class) {
      if (availableLocaleList == null) {
        TreeMap<String,Locale> localeMap=new TreeMap<String,Locale>();
        String localesString=UtilProperties.getPropertyValue("general","locales.available");
        if (localesString != null && localesString.length() > 0) {
          int end=-1;
          int start=0;
          for (int i=0; start < localesString.length(); i++) {
            end=localesString.indexOf(",",start);
            if (end == -1) {
              end=localesString.length();
            }
            Locale curLocale=UtilMisc.ensureLocale(localesString.substring(start,end));
            localeMap.put(curLocale.getDisplayName(),curLocale);
            start=end + 1;
          }
        }
 else {
          Locale[] locales=Locale.getAvailableLocales();
          for (int i=0; i < locales.length && locales[i] != null; i++) {
            localeMap.put(locales[i].getDisplayName(),locales[i]);
          }
        }
        availableLocaleList=new LinkedList<Locale>(localeMap.values());
      }
    }
  }
  return availableLocaleList;
}
