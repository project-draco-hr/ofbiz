{
  try {
    Map context=methodContext.getEnvMap();
    GenericDelegator delegator=methodContext.getDelegator();
    String entityName=this.entityNameExdr.expandString(context);
    String delegatorName=this.delegatorNameExdr.expandString(context);
    if (delegatorName != null && delegatorName.length() > 0) {
      delegator=GenericDelegator.getGenericDelegator(delegatorName);
    }
    EntityCondition whereEntityCondition=null;
    if (this.whereCondition != null) {
      whereEntityCondition=this.whereCondition.createCondition(context,entityName,delegator);
    }
    EntityCondition havingEntityCondition=null;
    if (this.havingCondition != null) {
      havingEntityCondition=this.havingCondition.createCondition(context,entityName,delegator);
    }
    long count=delegator.findCountByCondition(entityName,whereEntityCondition,havingEntityCondition);
    this.countAcsr.put(context,new Long(count));
  }
 catch (  GeneralException e) {
    Debug.logError(e,module);
    String errMsg="ERROR: Could not complete the " + simpleMethod.getShortDescription() + " process: "+ e.getMessage();
    if (methodContext.getMethodType() == MethodContext.EVENT) {
      methodContext.putEnv(simpleMethod.getEventErrorMessageName(),errMsg);
      methodContext.putEnv(simpleMethod.getEventResponseCodeName(),simpleMethod.getDefaultErrorCode());
    }
 else     if (methodContext.getMethodType() == MethodContext.SERVICE) {
      methodContext.putEnv(simpleMethod.getServiceErrorMessageName(),errMsg);
      methodContext.putEnv(simpleMethod.getServiceResponseMessageName(),simpleMethod.getDefaultErrorCode());
    }
    return false;
  }
  return true;
}
