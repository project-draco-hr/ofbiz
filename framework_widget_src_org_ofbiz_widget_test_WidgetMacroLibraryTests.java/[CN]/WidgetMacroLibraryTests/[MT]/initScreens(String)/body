{
  GenericValue userLogin=EntityQuery.use(delegator).from("UserLogin").where("userLoginId","system").queryOne();
  TimeZone timeZone=TimeZone.getDefault();
  Locale locale=Locale.getDefault();
  context=MapStack.create();
  context.put("userLogin",userLogin);
  context.put("timeZone",timeZone);
  context.put("locale",locale);
  context.put("dispatcher",dispatcher);
  context.put("delegator",delegator);
  context.put("security",SecurityFactory.getInstance(delegator));
  context.put("servletContext",new MockServletContext());
  context.put("parameters",UtilMisc.toMap("mainDecoratorLocation","component://webtools/widget/CommonScreens.xml"));
  ByteArrayOutputStream output=new ByteArrayOutputStream();
  Appendable writer=new OutputStreamWriter(output,"UTF-8");
  ScreenStringRenderer screenStringRenderer=new MacroScreenRenderer(EntityUtilProperties.getPropertyValue("widget",screenType.concat(".name"),delegator),EntityUtilProperties.getPropertyValue("widget",screenType.concat(".screenrenderer"),delegator));
  context.put("screens",new ScreenRenderer(writer,context,screenStringRenderer));
}
