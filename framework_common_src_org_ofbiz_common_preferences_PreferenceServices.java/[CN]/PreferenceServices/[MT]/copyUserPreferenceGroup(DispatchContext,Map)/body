{
  GenericDelegator delegator=ctx.getDelegator();
  Locale locale=(Locale)context.get("locale");
  String userLoginId=PreferenceWorker.getUserLoginId(context,false);
  String fromUserLoginId=(String)context.get("fromUserLoginId");
  String userPrefGroupId=(String)context.get("userPrefGroupId");
  if (UtilValidate.isEmpty(userLoginId) || UtilValidate.isEmpty(userPrefGroupId) || UtilValidate.isEmpty(fromUserLoginId)) {
    return ServiceUtil.returnError(UtilProperties.getMessage(resource,"copyPreference.invalidArgument",locale));
  }
  try {
    Map fieldMap=UtilMisc.toMap("userLoginId",fromUserLoginId,"userPrefGroupId",userPrefGroupId);
    List<GenericValue> resultList=delegator.findByAnd("UserPreference",fieldMap);
    if (resultList != null) {
      for (Iterator i=resultList.iterator(); i.hasNext(); ) {
        GenericValue preference=(GenericValue)i.next();
        preference.set("userLoginId",userLoginId);
      }
      delegator.storeAll(resultList);
    }
  }
 catch (  GenericEntityException e) {
    Debug.logWarning(e.getMessage(),module);
    return ServiceUtil.returnError(UtilProperties.getMessage(resource,"copyPreference.writeFailure",new Object[]{e.getMessage()},locale));
  }
  return ServiceUtil.returnSuccess();
}
