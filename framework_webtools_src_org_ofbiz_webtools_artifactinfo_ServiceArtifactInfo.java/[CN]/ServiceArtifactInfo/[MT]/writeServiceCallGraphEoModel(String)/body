{
  boolean useMoreDetailedNames=true;
  Debug.logInfo("Writing Service Call Graph EO Model for service [" + this.modelService.name + "] to ["+ eomodeldFullPath+ "]",module);
  Set<String> allDiagramEntitiesWithPrefixes=FastSet.newInstance();
  List<ServiceArtifactInfo> allServiceList=FastList.newInstance();
  List<ServiceEcaArtifactInfo> allServiceEcaList=FastList.newInstance();
  allDiagramEntitiesWithPrefixes.add(this.modelService.name);
  Set<ServiceArtifactInfo> callingServiceList=this.getServicesCallingService();
  if (callingServiceList != null) {
    for (    ServiceArtifactInfo callingService : callingServiceList) {
      callingService.setDisplayPrefix("Calling_");
      allDiagramEntitiesWithPrefixes.add(callingService.getDisplayPrefixedName());
      allServiceList.add(callingService);
    }
  }
  Set<ServiceArtifactInfo> calledServiceList=this.getServicesCalledByService();
  for (  ServiceArtifactInfo calledService : calledServiceList) {
    calledService.setDisplayPrefix("Called_");
    allDiagramEntitiesWithPrefixes.add(calledService.getDisplayPrefixedName());
    allServiceList.add(calledService);
  }
  Set<ServiceEcaArtifactInfo> callingServiceEcaSet=this.getServiceEcaRulesCallingService();
  if (callingServiceEcaSet != null) {
    for (    ServiceEcaArtifactInfo callingServiceEca : callingServiceEcaSet) {
      callingServiceEca.setDisplayPrefix("Triggering_");
      allDiagramEntitiesWithPrefixes.add(callingServiceEca.getDisplayPrefixedName());
      allServiceEcaList.add(callingServiceEca);
    }
  }
  Set<ServiceEcaArtifactInfo> calledServiceEcaSet=this.getServiceEcaRulesTriggeredByService();
  for (  ServiceEcaArtifactInfo calledServiceEca : calledServiceEcaSet) {
    calledServiceEca.setDisplayPrefix("Called_");
    allDiagramEntitiesWithPrefixes.add(calledServiceEca.getDisplayPrefixedName());
    allServiceEcaList.add(calledServiceEca);
  }
  Map<String,Object> indexEoModelMap=FastMap.newInstance();
  indexEoModelMap.put("EOModelVersion","\"2.1\"");
  List<Map<String,Object>> entitiesMapList=FastList.newInstance();
  indexEoModelMap.put("entities",entitiesMapList);
  for (  String entityName : allDiagramEntitiesWithPrefixes) {
    Map<String,Object> entitiesMap=FastMap.newInstance();
    entitiesMapList.add(entitiesMap);
    entitiesMap.put("className","EOGenericRecord");
    entitiesMap.put("name",entityName);
  }
  UtilFormatOut.writePlistFile(indexEoModelMap,eomodeldFullPath,"index.eomodeld");
  Map<String,Object> thisServiceEoModelMap=createEoModelMap(allServiceList,allServiceEcaList,useMoreDetailedNames);
  UtilFormatOut.writePlistFile(thisServiceEoModelMap,eomodeldFullPath,this.getDisplayPrefixedName() + ".plist");
  for (  ServiceArtifactInfo callingService : callingServiceList) {
    Map<String,Object> serviceEoModelMap=callingService.createEoModelMap(UtilMisc.toList(this),null,useMoreDetailedNames);
    UtilFormatOut.writePlistFile(serviceEoModelMap,eomodeldFullPath,callingService.getDisplayPrefixedName() + ".plist");
  }
  for (  ServiceArtifactInfo calledService : calledServiceList) {
    Map<String,Object> serviceEoModelMap=calledService.createEoModelMap(UtilMisc.toList(this),null,useMoreDetailedNames);
    UtilFormatOut.writePlistFile(serviceEoModelMap,eomodeldFullPath,calledService.getDisplayPrefixedName() + ".plist");
  }
  if (callingServiceEcaSet != null) {
    for (    ServiceEcaArtifactInfo callingServiceEca : callingServiceEcaSet) {
      Set<ServiceArtifactInfo> ecaCallingServiceSet=callingServiceEca.getServicesTriggeringServiceEca();
      for (      ServiceArtifactInfo ecaCallingService : ecaCallingServiceSet) {
        ecaCallingService.setDisplayPrefix("Triggering:");
      }
      ecaCallingServiceSet.add(this);
      Map<String,Object> serviceEcaEoModelMap=callingServiceEca.createEoModelMap(ecaCallingServiceSet,useMoreDetailedNames);
      UtilFormatOut.writePlistFile(serviceEcaEoModelMap,eomodeldFullPath,callingServiceEca.getDisplayPrefixedName() + ".plist");
    }
  }
  for (  ServiceEcaArtifactInfo calledServiceEca : calledServiceEcaSet) {
    Set<ServiceArtifactInfo> ecaCalledServiceSet=calledServiceEca.getServicesCalledByServiceEcaActions();
    for (    ServiceArtifactInfo ecaCalledService : ecaCalledServiceSet) {
      ecaCalledService.setDisplayPrefix("Called:");
    }
    ecaCalledServiceSet.add(this);
    Map<String,Object> serviceEcaEoModelMap=calledServiceEca.createEoModelMap(ecaCalledServiceSet,useMoreDetailedNames);
    UtilFormatOut.writePlistFile(serviceEcaEoModelMap,eomodeldFullPath,calledServiceEca.getDisplayPrefixedName() + ".plist");
  }
}
