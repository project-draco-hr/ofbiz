{
  try {
    GenericValue dataResource=delegator.findOne("DataResource",UtilMisc.toMap("dataResourceId",dataResourceId),true);
    if (dataResource == null) {
      throw new GeneralException("Error in streamDataResource: DataResource with ID [" + dataResourceId + "] was not found.");
    }
    String dataResourceTypeId=dataResource.getString("dataResourceTypeId");
    if (UtilValidate.isEmpty(dataResourceTypeId)) {
      dataResourceTypeId="SHORT_TEXT";
    }
    String mimeTypeId=dataResource.getString("mimeTypeId");
    if (UtilValidate.isEmpty(mimeTypeId)) {
      mimeTypeId="text/html";
    }
    if (dataResourceTypeId.equals("SHORT_TEXT")) {
      String text=dataResource.getString("objectInfo");
      os.write(text.getBytes());
    }
 else     if (dataResourceTypeId.equals("ELECTRONIC_TEXT")) {
      GenericValue electronicText=delegator.findOne("ElectronicText",UtilMisc.toMap("dataResourceId",dataResourceId),true);
      if (electronicText != null) {
        String text=electronicText.getString("textData");
        if (text != null)         os.write(text.getBytes());
      }
    }
 else     if (dataResourceTypeId.equals("IMAGE_OBJECT")) {
      byte[] imageBytes=acquireImage(delegator,dataResource);
      if (imageBytes != null)       os.write(imageBytes);
    }
 else     if (dataResourceTypeId.equals("LINK")) {
      String text=dataResource.getString("objectInfo");
      os.write(text.getBytes());
    }
 else     if (dataResourceTypeId.equals("URL_RESOURCE")) {
      URL url=new URL(dataResource.getString("objectInfo"));
      if (url.getHost() == null) {
        String prefix=buildRequestPrefix(delegator,locale,webSiteId,https);
        String sep="";
        if (url.toString().indexOf("/") != 0 && prefix.lastIndexOf("/") != (prefix.length() - 1)) {
          sep="/";
        }
        String s2=prefix + sep + url.toString();
        url=new URL(s2);
      }
      InputStream in=url.openStream();
      UtilIO.copy(in,true,os,false);
    }
 else     if (dataResourceTypeId.indexOf("_FILE") >= 0) {
      String objectInfo=dataResource.getString("objectInfo");
      File inputFile=getContentFile(dataResourceTypeId,objectInfo,rootDir);
      FileInputStream fis=new FileInputStream(inputFile);
      UtilIO.copy(fis,true,os,false);
    }
 else {
      throw new GeneralException("The dataResourceTypeId [" + dataResourceTypeId + "] is not supported in streamDataResource");
    }
  }
 catch (  GenericEntityException e) {
    throw new GeneralException("Error in streamDataResource",e);
  }
}
