{
  this.shippingEstimates=new HashMap();
  if (shippingMethods != null) {
    Iterator i=shippingMethods.iterator();
    while (i.hasNext()) {
      GenericValue shipMethod=(GenericValue)i.next();
      String shippingMethodTypeId=shipMethod.getString("shipmentMethodTypeId");
      String carrierRoleTypeId=shipMethod.getString("roleTypeId");
      String carrierPartyId=shipMethod.getString("partyId");
      String productStoreShipMethId=shipMethod.getString("productStoreShipMethId");
      String shippingCmId=shippingAddress != null ? shippingAddress.getString("contactMechId") : null;
      Map estimateMap=ShippingEvents.getShipGroupEstimate(dispatcher,delegator,"SALES_ORDER",shippingMethodTypeId,carrierPartyId,carrierRoleTypeId,shippingCmId,productStoreId,supplierPartyId,shippableItemInfo,shippableWeight,shippableQuantity,shippableTotal,partyId,productStoreShipMethId);
      if (!ServiceUtil.isError(estimateMap)) {
        BigDecimal shippingTotal=(BigDecimal)estimateMap.get("shippingTotal");
        shippingEstimates.put(shipMethod,shippingTotal);
      }
    }
  }
}
