{
  try {
    Script script=parsedScripts.get(location);
    if (script == null) {
      URL scriptUrl=FlexibleLocation.resolveLocation(location);
      if (scriptUrl == null) {
        throw new GeneralException("Script not found at location [" + location + "]");
      }
      GroovyShell shell=getShell(context);
      script=shell.parse(scriptUrl.openStream(),scriptUrl.getFile());
      if (Debug.verboseOn()) {
        Debug.logVerbose("Caching Groovy script at: " + location,module);
      }
      parsedScripts.put(location,script);
    }
    return script.run();
  }
 catch (  MalformedURLException e) {
    String errMsg="Error loading Groovy script at [" + location + "]: "+ e.toString();
    throw new GeneralException(errMsg,e);
  }
catch (  IOException e) {
    String errMsg="Error loading Groovy script at [" + location + "]: "+ e.toString();
    throw new GeneralException(errMsg,e);
  }
catch (  CompilationFailedException e) {
    String errMsg="Error loading Groovy script at [" + location + "]: "+ e.toString();
    throw new GeneralException(errMsg,e);
  }
}
