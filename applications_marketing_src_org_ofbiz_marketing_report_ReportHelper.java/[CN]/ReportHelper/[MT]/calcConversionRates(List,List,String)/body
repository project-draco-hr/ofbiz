{
  List conversionRates=new ArrayList();
  for (Iterator vit=visits.iterator(); vit.hasNext(); ) {
    GenericValue visit=(GenericValue)vit.next();
    Map reportValue=new HashMap();
    reportValue.put(keyFieldName,visit.getString(keyFieldName));
    reportValue.put("visits",visit.getLong("visitId"));
    List ordersForThisKey=EntityUtil.filterByAnd(orders,UtilMisc.toMap(keyFieldName,visit.getString(keyFieldName)));
    if ((ordersForThisKey != null) && (ordersForThisKey.size() > 0)) {
      GenericValue orderValue=(GenericValue)ordersForThisKey.get(0);
      reportValue.put("orders",orderValue.getLong("orderId"));
      if (orderValue.getDouble("grandTotal") == null) {
        reportValue.put("orderAmount",new Double(0));
      }
 else {
        reportValue.put("orderAmount",orderValue.getDouble("grandTotal"));
      }
      if ((orderValue.getLong("orderId") == null) || (visit.getLong("visitId") == null) || (visit.getLong("visitId").intValue() == 0)) {
        reportValue.put("conversionRate",new Double(0));
      }
 else {
        reportValue.put("conversionRate",new Double(orderValue.getLong("orderId").doubleValue() / visit.getLong("visitId").doubleValue()));
      }
    }
 else {
      reportValue.put("orders",new Long(0));
      reportValue.put("orderAmount",new Double(0));
      reportValue.put("conversionRate",new Double(0));
    }
    conversionRates.add(reportValue);
  }
  return conversionRates;
}
