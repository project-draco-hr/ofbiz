{
  Object o=null;
  if (expression == null || expression.equals("")) {
    Debug.logError("BSH Evaluation error. Empty expression",module);
    return null;
  }
  if (Debug.verboseOn())   Debug.logVerbose("Evaluating -- " + expression,module);
  if (Debug.verboseOn())   Debug.logVerbose("Using Context -- " + context,module);
  try {
    Interpreter bsh=makeInterpreter(context);
    o=bsh.eval(expression);
    if (Debug.verboseOn())     Debug.logVerbose("Evaluated to -- " + o,module);
    NameSpace ns=bsh.getNameSpace();
    String[] varNames=ns.getVariableNames();
    for (    String varName : varNames) {
      context.put(varName,bsh.get(varName));
    }
  }
 catch (  EvalError e) {
    Debug.logError(e,"BSH Evaluation error.",module);
    throw e;
  }
  return o;
}
