{
  if (UtilValidate.isEmpty(name)) {
    throw new IllegalArgumentException("The name of a LocalDispatcher cannot be a null or empty String");
  }
  LocalDispatcher dispatcher=ServiceDispatcher.getLocalDispatcher(name,delegator);
  if (dispatcher == null) {
    ServiceDispatcher globalDispatcher=ServiceDispatcher.getInstance(delegator);
    String modelName=name;
    if (delegator != null) {
      DelegatorElement delegatorInfo=null;
      try {
        delegatorInfo=EntityConfig.getInstance().getDelegator(delegator.getDelegatorBaseName());
      }
 catch (      GenericEntityConfException e) {
        Debug.logWarning(e,"Exception thrown while getting delegator config: ",module);
      }
      if (delegatorInfo != null) {
        modelName=delegatorInfo.getEntityModelReader();
      }
    }
    Map<String,ModelService> serviceMap=globalDispatcher.getGlobalServiceMap(modelName);
    dispatcher=globalDispatcher.register(new GenericDispatcher(name,globalDispatcher,serviceMap));
  }
  return dispatcher;
}
