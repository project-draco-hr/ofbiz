{
  PackingSession session=(PackingSession)context.get("packingSession");
  String shipGroupSeqId=(String)context.get("shipGroupSeqId");
  String orderId=(String)context.get("orderId");
  String productId=(String)context.get("productId");
  Double quantity=(Double)context.get("quantity");
  Integer packageSeq=(Integer)context.get("packageSeq");
  String instructions=(String)context.get("handlingInstructions");
  session.setHandlingInstructions(instructions);
  if (quantity == null) {
    quantity=new Double(1);
  }
  Debug.log("Pack input [" + productId + "] @ ["+ quantity+ "]",module);
  try {
    session.addOrIncreaseLine(orderId,null,shipGroupSeqId,productId,quantity.doubleValue(),packageSeq.intValue());
  }
 catch (  GeneralException e) {
    Debug.logError(e,module);
    return ServiceUtil.returnError(e.getMessage());
  }
  return ServiceUtil.returnSuccess();
}
