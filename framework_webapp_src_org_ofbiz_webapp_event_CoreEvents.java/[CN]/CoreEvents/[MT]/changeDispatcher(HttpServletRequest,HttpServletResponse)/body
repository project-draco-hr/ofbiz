{
  String dispatcherName=request.getParameter("dispatcher");
  Authorization authz=(Authorization)request.getAttribute("authz");
  Locale locale=UtilHttp.getLocale(request);
  if (!authz.hasPermission(request.getSession(),"ENTITY_MAINT",null)) {
    String errMsg=UtilProperties.getMessage(CoreEvents.err_resource,"coreEvents.not_authorized_use_fct",locale);
    request.setAttribute("_ERROR_MESSAGE_","<li>" + errMsg);
    return "error";
  }
  if (dispatcherName == null) {
    String errMsg=UtilProperties.getMessage(CoreEvents.err_resource,"coreEvents.dispatcher_not_passed",locale);
    request.setAttribute("_ERROR_MESSAGE_","<li>" + errMsg);
    return "error";
  }
  GenericDelegator delegator=(GenericDelegator)request.getAttribute("delegator");
  ServiceDispatcher sd=ServiceDispatcher.getInstance(dispatcherName,delegator);
  if (sd == null) {
    String errMsg=UtilProperties.getMessage(CoreEvents.err_resource,"coreEvents.no_dispachter_name_registered",locale);
    request.setAttribute("_ERROR_MESSAGE_","<li>" + errMsg);
    return "error";
  }
  LocalDispatcher dispatcher=sd.getLocalContext(dispatcherName).getDispatcher();
  request.getSession().setAttribute("dispatcher",dispatcher);
  return "success";
}
