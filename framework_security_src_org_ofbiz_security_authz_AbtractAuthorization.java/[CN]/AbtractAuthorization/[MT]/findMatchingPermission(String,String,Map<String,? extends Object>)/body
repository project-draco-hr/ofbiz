{
  Map<String,Boolean> resultMap=FastMap.newInstance();
  String regexp=permissionRegexp.substring(0,permissionRegexp.indexOf(":"));
  String permStr=permissionRegexp.substring(permissionRegexp.indexOf(":"));
  Pattern p=Pattern.compile("^" + regexp + ":.*$");
  for (  String base : basePermissions) {
    Matcher m=p.matcher(base + permStr);
    if (m.find()) {
      String permission=m.group();
      resultMap.put(permission,hasPermission(userId,permission,context));
    }
  }
  return resultMap;
}
